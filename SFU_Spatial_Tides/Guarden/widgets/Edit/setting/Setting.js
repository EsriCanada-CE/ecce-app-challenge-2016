// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Edit/setting/EditFields":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/query dojo/text!./EditFields.html dijit/_TemplatedMixin dijit/registry jimu/BaseWidgetSetting jimu/dijit/SimpleTable jimu/dijit/Popup".split(" "),function(h,d,k,m,g,p,n,q,l,r){return h([q,p],{baseClass:"jimu-widget-edit-setting-fields",templateString:g,_layerInfo:null,postCreate:function(){this.inherited(arguments);this.nls=d.mixin(this.nls,window.jimuNls.common);this._initFieldsTable();
this._setFiedsTabele(this._layerInfo.fieldInfos)},popupEditPage:function(){var e=new r({titleLabel:this.nls.configureFields,width:640,maxHeight:600,autoHeight:!0,content:this,buttons:[{label:this.nls.ok,onClick:d.hitch(this,function(){this._resetFieldInfos();e.close()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:d.hitch(this,function(){e.close()})}],onClose:d.hitch(this,function(){})})},_initFieldsTable:function(){this._fieldsTable=new l({fields:[{name:"visible",title:this.nls.display,
type:"checkbox","class":"display"},{name:"isEditable",title:this.nls.edit,type:"checkbox","class":"editable"},{name:"fieldName",title:this.nls.editpageName,type:"text"},{name:"label",title:this.nls.editpageAlias,type:"text",editable:!0},{name:"actions",title:this.nls.actions,type:"actions",actions:["up","down"],"class":"actions"}],selectable:!1,style:{height:"300px",maxHeight:"300px"}});this._fieldsTable.placeAt(this.fieldsTable);this._fieldsTable.startup()},_setFiedsTabele:function(e){k.forEach(e,
function(a){this._fieldsTable.addRow({fieldName:a.fieldName,isEditable:a.isEditable,label:a.label,visible:a.visible})},this);setTimeout(d.hitch(this,function(){k.forEach(this._fieldsTable.fields,function(a){"visible"===a.name?a.onChange=d.hitch(this,this._onDisplayFieldChanged):"isEditable"===a.name&&(a.onChange=d.hitch(this,this._onIsEditableFieldChanged))},this)}),300)},_onDisplayFieldChanged:function(e){var a=this._fieldsTable.getRowData(e);!a.visible&&a.isEditable&&(a.isEditable=!1,this._fieldsTable.editRow(e,
a))},_onIsEditableFieldChanged:function(e){var a=this._fieldsTable.getRowData(e);a.isEditable&&!a.visible&&(a.visible=!0,this._fieldsTable.editRow(e,a))},_resetFieldInfos:function(){var e=[],a=this._fieldsTable.getData();k.forEach(a,function(a){e.push({fieldName:a.fieldName,label:a.label,isEditable:a.isEditable,visible:a.visible})});this._layerInfo.fieldInfos=e}})})},"widgets/Edit/utils":function(){define(["dojo/_base/lang"],function(h){return{getFieldInfosFromWebmap:function(d,k){var m=null,g=k.getLayerInfoByTopLayerId(d);
g&&(g=g.getPopupInfo())&&g.fieldInfos&&(m=h.clone(g.fieldInfos));return m}}})},"widgets/Edit/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Edit/setting/EditFields.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"fieldsTable"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Edit/setting/Setting.html":'\x3cdiv style\x3d"width:100%;"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"firstPageDiv"\x3e\r\n    \x3ctable class\x3d"setting-table input-table" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr style\x3d"display:none"\x3e\r\n            \x3ctd class\x3d"first jimu-trailing-padding1"\x3e${nls.useFilterEdit}\x3c/td\x3e\r\n            \x3ctd class\x3d"second jimu-leading-padding1"\x3e\r\n                \x3cdiv class\x3d"" style\x3d""\x3e\r\n                    \x3cinput data-dojo-attach-point\x3d"useFilterEdit"\r\n                           data-dojo-type\x3d"dijit/form/CheckBox" /\x3e\r\n                \x3c/div\x3e\r\n            \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first jimu-trailing-padding1"\x3e${nls.toolbarVisible}\x3c/td\x3e\r\n          \x3ctd class\x3d"second jimu-leading-padding1"\x3e\r\n            \x3cdiv class\x3d"" style\x3d""\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"toolbarVisible" \r\n              data-dojo-attach-event\x3d"click:_onToolbarSelected"\r\n              data-dojo-type\x3d"dijit/form/CheckBox"/\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"toolbar-options-tr" data-dojo-attach-point\x3d"toolbarOptionsTr"\x3e\r\n          \x3ctd class\x3d"first jimu-trailing-padding1  toolbar-options-td" data-dojo-attach-point\x3d"toolbarOptionsLabel"\x3e${nls.toolbarOptions}\x3c/td\x3e\r\n          \x3ctd class\x3d"second jimu-leading-padding1  toolbar-options-td" data-dojo-attach-point\x3d"toolbarOptionsTd"\x3e\r\n            \x3cspan class\x3d"jimu-trailing-margin05 jimu-float-leading"\x3e${nls.mergeVisible}\x3c/span\x3e\r\n            \x3cdiv class\x3d"jimu-trailing-margin2 jimu-float-leading"\x3e\r\n              \x3cinput   data-dojo-attach-point\x3d"mergeVisible" \r\n              data-dojo-type\x3d"dijit/form/CheckBox"/\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cspan class\x3d"jimu-trailing-margin05 jimu-float-leading" \x3e${nls.cutVisible}\x3c/span\x3e\r\n            \x3cdiv class\x3d"jimu-trailing-margin2 jimu-float-leading"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"cutVisible" \r\n              data-dojo-type\x3d"dijit/form/CheckBox"/\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cspan class\x3d"jimu-trailing-margin05 jimu-float-leading" \x3e${nls.reshapeVisible}\x3c/span\x3e\r\n            \x3cdiv class\x3d"jimu-trailing-margin2 jimu-float-leading"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"reshapeVisible" \r\n              data-dojo-type\x3d"dijit/form/CheckBox"/\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cspan class\x3d"jimu-trailing-margin05 jimu-float-leading" \x3e${nls.enableUndoRedo}\x3c/span\x3e\r\n             \x3cdiv class\x3d"jimu-trailing-margin2 jimu-float-leading"\x3e\r\n              \x3cinput  data-dojo-attach-point\x3d"enableUndoRedo" \r\n              data-dojo-type\x3d"dijit/form/CheckBox"/\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\x3cdiv style\x3d"height: 40px;"\x3e\x3c/div\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"tableLayerInfos"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"tableLayerInfosError" style\x3d"display:none; padding: 5px;"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Edit/setting/css/style.css":".jimu-widget-edit-setting{margin:0; padding:0; font-size:15px;}.jimu-widget-edit-setting .editable{width: 100px;}.jimu-widget-edit-setting .edit-fields{width: 100px;}.jimu-widget-edit-setting .update{width: 200px;}.jimu-widget-edit-setting .setting-table \x3e thead \x3e tr \x3e th,.jimu-widget-edit-setting .setting-table \x3e tbody \x3e tr \x3e td{height:40px; line-height:40px; vertical-align:middle;}.jimu-widget-edit-setting .input-table \x3e tbody \x3e tr \x3e .first{width:auto; min-width: 160px; text-align: left;}.jimu-rtl .jimu-widget-edit-setting .input-table \x3e tbody \x3e tr \x3e .first{text-align: right;}.jimu-widget-edit-setting .input-table \x3e tbody \x3e tr \x3e .second{width: auto;}.jimu-widget-edit-setting .input-table \x3e tbody \x3e tr \x3e .second \x3e span{display: inline-block; height: 40px; line-height: 40px;}.jimu-widget-edit-setting .dijitArrowButtonContainer{width: 17px;}.jimu-widget-edit-setting .dijitSelect{height: 30px; width: 100%;}",
"*now":function(h){h(['dojo/i18n!*preload*widgets/Edit/setting/nls/Setting*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/dijit/SimpleTable jimu/LayerInfos/LayerInfos dojo/_base/lang dojo/_base/html dojo/on dojo/_base/array ./EditFields ../utils".split(" "),function(h,d,k,m,g,p,n,q,l,r,e){return h([k,d],{baseClass:"jimu-widget-edit-setting",_jimuLayerInfos:null,_layersTable:null,_editableLayerInfos:null,startup:function(){this.inherited(arguments);g.getInstance(this.map,this.map.itemInfo).then(p.hitch(this,function(a){this._jimuLayerInfos=
a;this._init();this.setConfig()}))},_init:function(){this._initToolbar();this._initLayersTable()},_initToolbar:function(){this.useFilterEdit.set("checked",this.config.editor.useFilterEdit);this.toolbarVisible.set("checked",this.config.editor.toolbarVisible);this.enableUndoRedo.set("checked",this.config.editor.enableUndoRedo);this.mergeVisible.set("checked",this.config.editor.toolbarOptions.mergeVisible);this.cutVisible.set("checked",this.config.editor.toolbarOptions.cutVisible);this.reshapeVisible.set("checked",
this.config.editor.toolbarOptions.reshapeVisible);this._onToolbarSelected()},_initLayersTable:function(){this._layersTable=new m({fields:[{name:"edit",title:this.nls.edit,type:"checkbox","class":"editable"},{name:"label",title:this.nls.label,type:"text"},{name:"disableGeometryUpdate",title:this.nls.update,type:"checkbox","class":"update",width:"300px"},{name:"actions",title:this.nls.fields,type:"actions","class":"edit-fields",actions:["edit"]}],selectable:!1});this._layersTable.placeAt(this.tableLayerInfos);
this._layersTable.startup();this.own(q(this._layersTable,"actions-edit",p.hitch(this,this._onEditFieldInfoClick)))},setConfig:function(){this._editableLayerInfos=this._getEditableLayerInfos();this._setLayersTable(this._editableLayerInfos)},_getEditableLayerInfos:function(){for(var a=[],c=this.map.graphicsLayerIds.length-1;0<=c;c--){var b=this.map.getLayer(this.map.graphicsLayerIds[c]);if("Feature Layer"===b.type&&b.url&&b.isEditable&&b.isEditable()){var f=this._getLayerInfoFromConfiguration(b);f||
(f=this._getDefaultLayerInfo(b));a.push(f)}}return a},_getLayerInfoFromConfiguration:function(a){var c=null,b=this.config.editor.layerInfos;if(b&&0<b.length){for(var f=0;f<b.length;f++)if(b[f].featureLayer&&b[f].featureLayer.id===a.id){c=b[f];break}c&&(c.fieldInfos=this._getSimpleFieldInfos(a,c),c._editFlag=!0)}return c},_getDefaultLayerInfo:function(a){return{featureLayer:{id:a.id},disableGeometryUpdate:!1,fieldInfos:this._getSimpleFieldInfos(a),_editFlag:this.config.editor.layerInfos&&0===this.config.editor.layerInfos.length?
!0:!1}},_setLayersTable:function(a){l.forEach(a,function(a){var b=this._jimuLayerInfos.getLayerInfoById(a.featureLayer.id);this._layersTable.addRow({label:b.title,edit:a._editFlag,disableGeometryUpdate:a.disableGeometryUpdate}).tr._layerInfo=a},this)},_getDefaultSimpleFieldInfos:function(a){for(var c=[],b=0;b<a.fields.length;b++)if(a.fields[b].editable||"globalid"===a.fields[b].name.toLowerCase()||"objectid"===a.fields[b].name.toLowerCase()||"fid"===a.fields[b].name.toLowerCase())c.push({fieldName:a.fields[b].name,
label:a.fields[b].alias||a.fields[b].name,isEditable:("globalid"===a.fields[b].name.toLowerCase()||"objectid"===a.fields[b].name.toLowerCase()||"fid"===a.fields[b].name.toLowerCase())&&!a.fields[b].editable?null:!0,visible:!0});return c},_getWebmapSimpleFieldInfos:function(a){var c=[];(a=e.getFieldInfosFromWebmap(a.id,this._jimuLayerInfos))?(l.forEach(a,function(a){if(void 0!==a.isEditableOnLayer&&(a.isEditableOnLayer||"globalid"===a.fieldName.toLowerCase()||"objectid"===a.fieldName.toLowerCase()||
"fid"===a.fieldName.toLowerCase()))c.push({fieldName:a.fieldName,label:a.label,isEditable:("globalid"===a.fieldName.toLowerCase()||"objectid"===a.fieldName.toLowerCase()||"fid"===a.fieldName.toLowerCase())&&!a.isEditable?null:a.isEditable,visible:a.visible})}),0===c.length&&(c=null)):c=null;return c},_getSimpleFieldInfos:function(a,c){var b,f=[],e=this._getDefaultSimpleFieldInfos(a),d=this._getWebmapSimpleFieldInfos(a);b=d?d:e;c&&c.fieldInfos?(l.forEach(c.fieldInfos,function(a){if(void 0===a.visible)if(d)for(var c=
0;c<d.length;c++)a.fieldName===d[c].fieldName&&(a.visible=d[c].visible||d[c].isEditable);else a.visible=!0;for(c=0;c<b.length;c++)if(a.fieldName===b[c].fieldName){f.push(a);b[c]._exit=!0;break}}),l.forEach(b,function(a){a._exit||f.push(a)})):f=b;return f},_onEditFieldInfoClick:function(a){var c=this._layersTable.getRowData(a);c&&c.edit&&(new r({nls:this.nls,_layerInfo:a._layerInfo})).popupEditPage()},_onToolbarSelected:function(){this.toolbarVisible.checked?(n.setStyle(this.toolbarOptionsLabel,"display",
"table-cell"),n.setStyle(this.toolbarOptionsTd,"display","table-cell")):(n.setStyle(this.toolbarOptionsLabel,"display","none"),n.setStyle(this.toolbarOptionsTd,"display","none"))},_resetToolbarConfig:function(){this.config.editor.useFilterEdit=this.useFilterEdit.checked;this.config.editor.toolbarVisible=this.toolbarVisible.checked;this.config.editor.enableUndoRedo=this.enableUndoRedo.checked;this.config.editor.toolbarOptions.mergeVisible=this.mergeVisible.checked;this.config.editor.toolbarOptions.cutVisible=
this.cutVisible.checked;this.config.editor.toolbarOptions.reshapeVisible=this.reshapeVisible.checked},getConfig:function(){this._resetToolbarConfig();var a=[],c=this._layersTable.getData();l.forEach(this._editableLayerInfos,function(b,d){b._editFlag=c[d].edit;b.disableGeometryUpdate=c[d].disableGeometryUpdate;b._editFlag&&(delete b._editFlag,a.push(b))});0===a.length?delete this.config.editor.layerInfos:this.config.editor.layerInfos=a;return this.config}})});