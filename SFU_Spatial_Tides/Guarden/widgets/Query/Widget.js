// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dijit/TitlePane":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/fx dojo/has dojo/_base/kernel dojo/keys ./_CssStateMixin ./_TemplatedMixin ./layout/ContentPane dojo/text!./templates/TitlePane.html ./_base/manager ./a11yclick".split(" "),function(s,b,n,d,f,m,r,q,e,t,c,a,k,l,w){b=b("dijit.TitlePane",[k,a,c],{title:"",_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!0,toggleable:!0,tabIndex:"0",duration:w.defaultDuration,
baseClass:"dijitTitlePane",templateString:l,doLayout:!1,_setTooltipAttr:{node:"focusNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);n.setSelectable(this.titleNode,!1)},postCreate:function(){this.inherited(arguments);this.toggleable&&this._trackMouseState(this.titleBarNode,this.baseClass+"Title");var a=this.hideNode,h=this.wipeNode;this._wipeIn=r.wipeIn({node:h,duration:this.duration,beforeBegin:function(){a.style.display=""}});this._wipeOut=r.wipeOut({node:h,
duration:this.duration,onEnd:function(){a.style.display="none"}})},_setOpenAttr:function(a,h){s.forEach([this._wipeIn,this._wipeOut],function(a){a&&"playing"==a.status()&&a.stop()});h?this[a?"_wipeIn":"_wipeOut"].play():this.hideNode.style.display=this.wipeNode.style.display=a?"":"none";if(this._started)if(a)this._onShow();else this.onHide();this.containerNode.setAttribute("aria-hidden",a?"false":"true");this.focusNode.setAttribute("aria-pressed",a?"true":"false");this._set("open",a);this._setCss()},
_setToggleableAttr:function(a){this.focusNode.setAttribute("role",a?"button":"heading");a?(this.focusNode.setAttribute("aria-controls",this.id+"_pane"),this.focusNode.setAttribute("tabIndex",this.tabIndex),this.focusNode.setAttribute("aria-pressed",this.open)):(d.remove(this.focusNode,"aria-controls"),d.remove(this.focusNode,"tabIndex"),d.remove(this.focusNode,"aria-pressed"));this._set("toggleable",a);this._setCss()},_setContentAttr:function(a){!this.open||!this._wipeOut||"playing"==this._wipeOut.status()?
this.inherited(arguments):(this._wipeIn&&"playing"==this._wipeIn.status()&&this._wipeIn.stop(),m.setMarginBox(this.wipeNode,{h:m.getMarginBox(this.wipeNode).h}),this.inherited(arguments),this._wipeIn?this._wipeIn.play():this.hideNode.style.display="")},toggle:function(){this._setOpenAttr(!this.open,!0)},_setCss:function(){var a=this.titleBarNode||this.focusNode,h=this._titleBarClass;this._titleBarClass=this.baseClass+"Title"+(this.toggleable?"":"Fixed")+(this.open?"Open":"Closed");f.replace(a,this._titleBarClass,
h||"");f.replace(a,this._titleBarClass.replace("TitlePaneTitle",""),(h||"").replace("TitlePaneTitle",""));this.arrowNodeInner.innerHTML=this.open?"-":"+"},_onTitleKey:function(a){a.keyCode==t.DOWN_ARROW&&this.open&&(this.containerNode.focus(),a.preventDefault())},_onTitleClick:function(){this.toggleable&&this.toggle()},setTitle:function(a){e.deprecated("dijit.TitlePane.setTitle() is deprecated.  Use set('title', ...) instead.","","2.0");this.set("title",a)}});q("dojo-bidi")&&b.extend({_setTitleAttr:function(a){this._set("title",
a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},_setTooltipAttr:function(a){this._set("tooltip",a);this.textDir&&(a=this.enforceTextDirWithUcc(null,a));d.set(this.focusNode,"title",a)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",this.title),this.set("tooltip",this.tooltip))}});return b})},"jimu/dijit/FilterParameters":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/_base/array dojo/query dijit/registry jimu/filterUtils jimu/utils ./_SingleFilterParameter".split(" "),
function(s,b,n,d,f,m,r,q,e,t,c,a){return s([b,n,d],{baseClass:"jimu-filter-parameters",templateString:'\x3cdiv\x3e\x3ctable style\x3d"width:100%;border-collapse:collapse;"\x3e\x3ctbody data-dojo-attach-point\x3d"tbody"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e',nls:null,partsObj:null,layerInfo:null,OPERATORS:null,url:null,_filterUtils:null,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;this._filterUtils=new t;this.OPERATORS=f.clone(this._filterUtils.OPERATORS)},destroy:function(){this.clear();
this._filterUtils=null;this.inherited(arguments)},getFilterExpr:function(){for(var a=this.partsObj,l=this._getAllInteractiveSinglePartArray(a),b=0;b<l.length;b++){var g=l[b],h=g.spId;if(h&&(h=q("#"+h,this.tbody)[0])){h=e.byNode(h).getValueObj();if(!h)return null;g.valueObj=h}}this._filterUtils.isHosted=c.isHostedService(this.url);return this._filterUtils.getExprByFilterObj(a)},clear:function(){this.url=null;var a=q(".jimu-widget-query-single-parameter",this.tbody);r.forEach(a,f.hitch(this,function(a){e.byNode(a).destroy()}));
m.empty(this.tbody);this.layerInfo=this.partsObj=null},build:function(k,l,c){this.clear();this.url=k;this.layerInfo=l;this.partsObj=f.clone(c);k=this._getAllInteractiveSinglePartArray(this.partsObj);r.forEach(k,f.hitch(this,function(k){var h=m.create("tr",{innerHTML:"\x3ctd\x3e\x3c/td\x3e"},this.tbody),h=q("td",h)[0],c=this._getFieldInfo(k.fieldObj.name,this.layerInfo),c=new a({nls:this.nls,part:k,fieldInfo:c,OPERATORS:this.OPERATORS,url:this.url});c.placeAt(h);c.startup();k.spId=c.id}))},_getFieldInfo:function(a,
c){for(var b=c.fields,e=0;e<b.length;e++){var h=b[e];if(a===h.name)return h}return null},_getAllInteractiveSinglePartArray:function(a){for(var c=[],b=0;b<a.parts.length;b++){var e=a.parts[b];if(e.parts)for(var h=0;h<e.parts.length;h++){var u=e.parts[h];u.interactiveObj&&c.push(u)}else e.interactiveObj&&c.push(e)}return c}})})},"jimu/dijit/_SingleFilterParameter":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilterParameter.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/store/Memory jimu/utils dijit/form/FilteringSelect dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/NumberTextBox".split(" "),
function(s,b,n,d,f,m,r,q,e,t){return s([b,n,d],{baseClass:"jimu-single-filter-parameter",templateString:f,fieldInfo:null,part:null,nls:null,OPERATORS:null,url:null,_type:-1,postCreate:function(){this.inherited(arguments);var c=new e({idProperty:"id",data:[]});this.stringUniqueValuesSelect.set("store",c);c=new e({idProperty:"id",data:[]});this.numberUniqueValuesSelect.set("store",c);this.fieldInfo&&this.part&&this.build(this.fieldInfo,this.part)},getValueObj:function(){var c=null,a=this.part.fieldObj.shortType;
"string"===a?c=this._getStirngValueObj():"number"===a?c=this._getNumberValueObj():"date"===a&&(c=this._getDateValueObj());c&&(c.type=this.part.valueObj.type,c.isValid=!0);return c},_getStirngValueObj:function(){var c=null;if(1===this._type){if(!this.stringTextBox.validate())return this._showValidationErrorTip(this.stringTextBox),null;c={};c.value=this.stringTextBox.get("value")}else if(2===this._type){if(!this.stringCodedValuesFS.validate())return this._showValidationErrorTip(this.stringCodedValuesFS),
null;var c={},a=this._getSelectedFilteringItem(this.stringCodedValuesFS);c.value=a.code}else if(3===this._type){if(!this.stringUniqueValuesSelect.validate())return this._showValidationErrorTip(this.stringUniqueValuesSelect),null;c={};a=this._getSelectedFilteringItem(this.stringUniqueValuesSelect);c.value=a.value}return c},_getNumberValueObj:function(){var c=null;if(1===this._type){if(!this.numberTextBox.validate())return this._showValidationErrorTip(this.numberTextBox),null;c={};c.value=parseFloat(this.numberTextBox.get("value"))}else if(2===
this._type){if(!this.numberCodedValuesFS.validate())return this._showValidationErrorTip(this.numberCodedValuesFS),null;var c={},a=this._getSelectedFilteringItem(this.numberCodedValuesFS);c.value=parseFloat(a.code)}else if(3===this._type){if(!this.numberTextBox1.validate())return this._showValidationErrorTip(this.numberTextBox1),null;if(!this.numberTextBox2.validate())return this._showValidationErrorTip(this.numberTextBox2),null;c={};c.value1=parseFloat(this.numberTextBox1.get("value"));c.value2=parseFloat(this.numberTextBox2.get("value"))}else if(4===
this._type){if(!this.numberUniqueValuesSelect.validate())return this._showValidationErrorTip(this.numberUniqueValuesSelect),null;c={};a=this.numberUniqueValuesSelect.get("item");c.value=parseFloat(a.value)}return c},_getDateValueObj:function(){var c=null;if(1===this._type){if(!this.dateTextBox.validate())return this._showValidationErrorTip(this.dateTextBox),null;c={};c.value=this.dateTextBox.get("value").toDateString()}else if(2===this._type){if(!this.dateTextBox1.validate())return this._showValidationErrorTip(this.dateTextBox1),
null;if(!this.dateTextBox2.validate())return this._showValidationErrorTip(this.dateTextBox2),null;c={};c.value1=this.dateTextBox1.get("value").toDateString();c.value2=this.dateTextBox2.get("value").toDateString()}return c},build:function(c,a){this.fieldInfo=c;this.part=a;var k=a.interactiveObj;k&&(this.promptNode.innerHTML=k.prompt||"",this.hintNode.innerHTML=k.hint||"");k=this.part.fieldObj.shortType;"string"===k?this._buildString(c,this.part):"number"===k?this._buildNumber(c,this.part):"date"===
k&&this._buildDate(c,this.part)},_getCodedValues:function(c){var a=null;if((c=c.domain)&&"codedValue"===c.type&&c.codedValues&&0<c.codedValues.length)a=c.codedValues;return a},_buildString:function(c,a){r.setStyle(this.stringTextBoxContainer,"display","block");r.setStyle(this.numberTextBoxContainer,"display","none");r.setStyle(this.dateTextBoxContainer,"display","none");this._hideDijit(this.stringTextBox);this._hideDijit(this.stringCodedValuesFS);this._hideDijit(this.stringUniqueValuesSelect);var k=
a.fieldObj,l=a.valueObj,b=l.type,g=this._getCodedValues(c);g?(this._type=2,this._showDijit(this.stringCodedValuesFS),b=q.map(g,m.hitch(this,function(a,c){var k=m.mixin({},a);k.id=c;return k})),g=new e({data:b}),this.stringCodedValuesFS.set("store",g),l&&(g=q.filter(b,m.hitch(this,function(a){return a.code===l.value})),0<g.length?this.stringCodedValuesFS.set("value",g[0].id):this.stringCodedValuesFS.set("value",b[0].id))):"unique"===b?(this._type=3,this._showDijit(this.stringUniqueValuesSelect),t.getUniqueValues(this.url,
k.name).then(m.hitch(this,function(a){var c=-1;a=q.map(a,m.hitch(this,function(a,h){var b=a;"number"===k.shortType&&(a=parseFloat(a),b=this._tryLocaleNumber(a));b={id:h,value:a,label:b};l&&l.value===a&&(c=h);return b}));this.stringUniqueValuesSelect.store.setData(a);0<=c&&(a=this.stringUniqueValuesSelect.store.get(c))&&this.stringUniqueValuesSelect.set("item",a)}),m.hitch(this,function(a){console.error(a)}))):(this._type=1,this._showDijit(this.stringTextBox),this.stringTextBox.set("value",l.value||
""))},_tryLocaleNumber:function(c){var a=t.localizeNumber(c);if(null===a||void 0===a)a=c;return a},_buildNumber:function(c,a){r.setStyle(this.stringTextBoxContainer,"display","none");r.setStyle(this.numberTextBoxContainer,"display","block");r.setStyle(this.dateTextBoxContainer,"display","none");this._hideDijit(this.numberTextBox);this._hideDijit(this.numberCodedValuesFS);r.setStyle(this.numberRangeTable,"display","none");this._hideDijit(this.numberUniqueValuesSelect);var k=a.fieldObj,b=a.valueObj,
d=b.type,g=a.operator,h=g===this.OPERATORS.numberOperatorIsNotBetween;if(g===this.OPERATORS.numberOperatorIsBetween||h)this._type=3,r.setStyle(this.numberRangeTable,"display","table"),t.isValidNumber(b.value1)&&this.numberTextBox1.set("value",b.value1),t.isValidNumber(b.value2)&&this.numberTextBox2.set("value",b.value2);else if(r.setStyle(this.numberRangeTable,"display","none"),g=this._getCodedValues(c))if(this._type=2,this._showDijit(this.numberCodedValuesFS),d=q.map(g,m.hitch(this,function(a,h){var c=
m.clone(a);c.id=h;return c})),g=new e({data:d}),this.numberCodedValuesFS.set("store",g),b&&t.isValidNumber(b.value)){var u=parseFloat(b.value),g=q.filter(d,m.hitch(this,function(a){return parseFloat(a.code)===u}));0<g.length?this.numberCodedValuesFS.set("value",g[0].id):this.numberCodedValuesFS.set("value",d[0].id)}else this.numberCodedValuesFS.set("value",d[0].id);else"unique"===d?(this._type=4,this._showDijit(this.numberUniqueValuesSelect),t.getUniqueValues(this.url,k.name).then(m.hitch(this,function(a){var h=
-1;a=q.map(a,m.hitch(this,function(a,c){var e=a;"number"===k.shortType&&(a=parseFloat(a),e=this._tryLocaleNumber(a));e={id:c,value:a,label:e};b&&b.value===a&&(h=c);return e}));this.numberUniqueValuesSelect.store.setData(a);0<=h&&(a=this.numberUniqueValuesSelect.store.get(h))&&this.numberUniqueValuesSelect.set("item",a)}),m.hitch(this,function(a){console.error(a)}))):(this._type=1,this._showDijit(this.numberTextBox),b&&t.isValidNumber(b.value)&&this.numberTextBox.set("value",b.value))},_buildDate:function(c,
a){r.setStyle(this.stringTextBoxContainer,"display","none");r.setStyle(this.numberTextBoxContainer,"display","none");r.setStyle(this.dateTextBoxContainer,"display","block");var b=a.valueObj,e=a.operator,d=e===this.OPERATORS.dateOperatorIsNotBetween;e===this.OPERATORS.dateOperatorIsBetween||d?(this._type=2,r.setStyle(this.dateRangeTable,"display","table"),this._hideDijit(this.dateTextBox),this.dateTextBox1.set("value",new Date(b.value1)),this.dateTextBox2.set("value",new Date(b.value2))):(this._type=
1,r.setStyle(this.dateRangeTable,"display","none"),this._showDijit(this.dateTextBox),this.dateTextBox.set("value",new Date(b.value)))},_getSelectedFilteringItem:function(c){if(c.validate()){var a=c.get("item");if(a)return a}this._showValidationErrorTip(c);return null},_showValidationErrorTip:function(c){!c.validate()&&c.domNode&&c.focusNode&&(c.focusNode.focus(),c.focusNode.blur())},_showDijit:function(c){c&&c.domNode&&r.setStyle(c.domNode,"display","inline-block")},_hideDijit:function(c){c&&c.domNode&&
r.setStyle(c.domNode,"display","none")},_onRangeNumberBlur:function(){if(this.numberTextBox1.validate()&&this.numberTextBox2.validate()){var c=parseFloat(this.numberTextBox1.get("value")),a=parseFloat(this.numberTextBox2.get("value"));c>a&&(this.numberTextBox1.set("value",a),this.numberTextBox2.set("value",c))}},_onRangeDateBlur:function(){if(this.dateTextBox1.validate()&&this.dateTextBox2.validate()){var c=this.dateTextBox1.get("value"),a=c.getTime(),b=this.dateTextBox2.get("value"),e=b.getTime();
a>e&&(this.dateTextBox1.set("value",b),this.dateTextBox2.set("value",c))}}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(s,b,n,d,f){return s("dijit.form.FilteringSelect",[d,f],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},
_callbackSetLabel:function(b,d,f,e){d&&d[this.searchAttr]!==this._lastQuery||!d&&b.length&&this.store.getIdentity(b[0])!=this._lastQuery||(b.length?this.set("item",b[0],e):this.set("value","",e||void 0===e&&!this.focused,this.textbox.value,null))},_openResultList:function(b,d,f){d[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(d,
f,q,e){this._onChangeActive||(f=null);if(void 0===e){if(null===d||""===d)if(d="",!b.isString(q)){this._setDisplayedValueAttr(q||"",f);return}var t=this;this._lastQuery=d;n(this.store.get(d),function(b){t._callbackSetLabel(b?[b]:[],void 0,void 0,f)})}else this.valueNode.value=d,this.inherited(arguments,[d,f,q,e])},_setItemAttr:function(b,d,f){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(b){return b.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(d,
f){null==d&&(d="");if(!this._created){if(!("displayedValue"in this.params))return;f=!1}if(this.store){this.closeDropDown();var q=b.clone(this.query),e=this._getDisplayQueryString(d),t;this.store._oldAPI?t=e:(t=this._patternToRegExp(e),t.toString=function(){return e});this._lastQuery=q[this.searchAttr]=t;this._lastDisplayedValue=this.textbox.value=d;this._set("displayedValue",d);var c=this,a={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};b.mixin(a,this.fetchProperties);this._fetchHandle=this.store.query(q,
a);n(this._fetchHandle,function(b){c._fetchHandle=null;c._callbackSetLabel(b||[],q,a,f)},function(a){c._fetchHandle=null;c._cancelingQuery||console.error("dijit.form.FilteringSelect: "+a.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(s,b,n){return s("dijit.form.DateTextBox",n,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:b,_selector:"date",
maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),function(s,b,n,d,f,m,r,q,e,t,c,a,k,l,w,g,h){var u=d("dijit.Calendar",[k,l,w],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",
incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){q.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new u._MonthDropDownButton({id:this.id+"_mddb",tabIndex:-1,onMonthSelect:t.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);
this.own(c(this.domNode,"keydown",t.hitch(this,"_onKeyDown")),c(this.dateRowsNode,"mouseover",t.hitch(this,"_onDayMouseOver")),c(this.dateRowsNode,"mouseout",t.hitch(this,"_onDayMouseOut")),c(this.dateRowsNode,"mousedown",t.hitch(this,"_onDayMouseDown")),c(this.dateRowsNode,"mouseup",t.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var h=new this.dateClassObj(this.currentFocus);h.setDate(1);h.setMonth(a);a=this.dateModule.getDaysInMonth(h);var b=this.currentFocus.getDate();h.setDate(Math.min(b,
a));this._setCurrentFocusAttr(h)},_onDayMouseOver:function(a){if((a=m.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!m.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode))m.add(a,"dijitCalendarHoveredDate"),this._currentNode=a},_onDayMouseOut:function(a){this._currentNode&&!(a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode)&&(a="dijitCalendarHoveredDate",m.contains(this._currentNode,"dijitCalendarActiveDate")&&
(a+=" dijitCalendarActiveDate"),m.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){if((a=a.target.parentNode)&&a.dijitDateValue&&!m.contains(a,"dijitCalendarDisabledDate"))m.add(a,"dijitCalendarActiveDate"),this._currentNode=a},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&m.remove(a,"dijitCalendarActiveDate")},handleKey:function(a){var h=-1,b,c=this.currentFocus;switch(a.keyCode){case e.RIGHT_ARROW:h=1;case e.LEFT_ARROW:b="day";this.isLeftToRight()||
(h*=-1);break;case e.DOWN_ARROW:h=1;case e.UP_ARROW:b="week";break;case e.PAGE_DOWN:h=1;case e.PAGE_UP:b=a.ctrlKey||a.altKey?"year":"month";break;case e.END:c=this.dateModule.add(c,"month",1),b="day";case e.HOME:c=new this.dateClassObj(c);c.setDate(1);break;default:return!0}b&&(c=this.dateModule.add(c,b,h));this._setCurrentFocusAttr(c);return!1},_onKeyDown:function(a){this.handleKey(a)||(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},
getClassForDate:function(){}});u._MonthDropDownButton=d("dijit.Calendar._MonthDropDownButton",h,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new u._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(h){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,h);this.dropDown.set("months",b);this.containerNode.innerHTML=(6==a("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+
"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[h.getMonth()]+"\x3c/div\x3e"}});u._MonthDropDown=d("dijit.Calendar._MonthDropDown",[l,g,w],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML="";s.forEach(a,function(a,h){r.create("div",{className:"dijitCalendarMonthLabel",month:h,innerHTML:a},this.domNode)._cssState=
"dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(f.get(a.target,"month"))},onChange:function(){}});return u})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),function(s,b,n,d,f,m,r,q,e,t,c,a,k,l,w){var g=b("dijit.CalendarLite",
[k,l],{templateString:w,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',
value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=new this.dateClassObj(a);b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,
b){"string"==typeof a&&(a=m.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){a&&(a=new this.dateClassObj(a),a.setHours(1,0,0,0));return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},
_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),b=a.getDay(),c=this.dateModule.getDaysInMonth(a),k=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),e=new this.dateClassObj,d=n.getFirstDayOfWeek(this.lang);d>b&&(d-=7);if(!this.summary){var l=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",l[a.getMonth()])}this._date2cell={};s.forEach(this.dateCells,function(l,
v){var x=v+d,p=new this.dateClassObj(a),g="dijitCalendar",y=0;x<b?(x=k-b+x+1,y=-1,g+="Previous"):x>=b+c?(x=x-b-c+1,y=1,g+="Next"):(x=x-b+1,g+="Current");y&&(p=this.dateModule.add(p,"month",y));p.setDate(x);this.dateModule.compare(p,e,"date")||(g="dijitCalendarCurrentDate "+g);this.isDisabledDate(p,this.lang)?(g="dijitCalendarDisabledDate "+g,l.setAttribute("aria-disabled","true")):(g="dijitCalendarEnabledDate "+g,l.removeAttribute("aria-disabled"),l.setAttribute("aria-selected","false"));(y=this.getClassForDate(p,
this.lang))&&(g=y+" "+g);l.className=g+"Month dijitCalendarDateTemplate";g=p.valueOf();this._date2cell[g]=l;l.dijitDateValue=g;this._setText(this.dateLabels[v],p.getDateLocalized?p.getDateLocalized(this.lang):p.getDate())},this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);this.monthWidget.set("month",a);var b=a.getFullYear()-1,c=new this.dateClassObj;s.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],
this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?e.getObject(a.datePackage,!1):d;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?e.getObject(a.datePackage+".locale",!1):f},_createMonthWidget:function(){return g._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var b=
this.dowTemplateString,c=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),k=n.getFirstDayOfWeek(this.lang);this.dayCellsHtml=a.substitute([b,b,b,b,b,b,b].join(""),{d:""},function(){return c[k++%7]});b=a.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[b,b,b,b,b,b].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);r.setSelectable(this.domNode,!1);b=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();
this.set("currentFocus",b,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=e.hitch(this,function(a,b,c){this[a].dojoClick=!0;return t(this[a],"click",e.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,b,c))}))});this.own(a("incrementMonth","month",1),a("decrementMonth","month",-1),a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,b){var k=this.currentFocus,
e=this._getNodeByDate(k);a=this._patchDate(a);this._set("currentFocus",a);if(!this._date2cell||0!=this.dateModule.difference(k,a,"month"))this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]);k=this._getNodeByDate(a);k.setAttribute("tabIndex",this.tabIndex);(this.focused||b)&&k.focus();e&&e!=k&&(c("webkit")?e.setAttribute("tabIndex","-1"):e.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();
a.preventDefault();for(a=a.target;a&&!a.dijitDateValue;a=a.parentNode);a&&!q.contains(a,"dijitCalendarDisabledDate")&&this.set("value",a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function b(a,c){q.toggle(c,"dijitCalendarSelectedDate",a);c.setAttribute("aria-selected",a?"true":"false")}s.forEach(this._selectedCells||[],e.partial(b,!1));this._selectedCells=s.filter(s.map(a,this._getNodeByDate,
this),function(a){return a});s.forEach(this._selectedCells,e.partial(b,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});g._MonthWidget=b("dijit.CalendarLite._MonthWidget",k,{_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a),k=6==c("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+s.map(b,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=k+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+
b[a.getMonth()]+"\x3c/div\x3e"}});return g})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(s,b,n,d,f,m,r,q){new Date("X");return d("dijit.form._DateTimeTextBox",[m,r],{templateString:q,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:b.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);
this._set("type","text")},compare:function(b,d){var c=this._isInvalidDate(b),a=this._isInvalidDate(d);if(c||a)return c&&a?0:!c?1:-1;var c=this.format(b,this._unboundedConstraints),a=this.format(d,this._unboundedConstraints),k=this.parse(c,this._unboundedConstraints),l=this.parse(a,this._unboundedConstraints);return c==a?0:s.compare(k,l,this._selector)},autoWidth:!0,format:function(b,d){return!b?"":this.dateLocaleModule.format(b,d)},parse:function(b,d){return this.dateLocaleModule.parse(b,d)||(this._isEmpty(b)?
null:void 0)},serialize:function(b,d){b.toGregorian&&(b=b.toGregorian());return n.toISOString(b,d)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(d){d=d||{};this.dateModule=d.datePackage?f.getObject(d.datePackage,!1):s;this.dateClassObj=this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=d.datePackage?f.getObject(d.datePackage+".locale",!1):b;this._set("pattern",
this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(b){b.selector=this._selector;b.fullYear=!0;var d=n.fromISOString;"string"==typeof b.min&&(b.min=d(b.min),this.dateClassObj instanceof Date||(b.min=new this.dateClassObj(b.min)));
"string"==typeof b.max&&(b.max=d(b.max),this.dateClassObj instanceof Date||(b.max=new this.dateClassObj(b.max)));this.inherited(arguments);this._unboundedConstraints=f.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(b){return!b||isNaN(b)||"object"!=typeof b||b.toString()==this._invalidDate},_setValueAttr:function(b,d,c){void 0!==b&&("string"==typeof b&&(b=n.fromISOString(b)),this._isInvalidDate(b)&&(b=null),b instanceof Date&&!(this.dateClassObj instanceof Date)&&(b=new this.dateClassObj(b)));
this.inherited(arguments,[b,d,c]);this.value instanceof Date&&(this.filterString="");this.dropDown&&this.dropDown.set("value",b,!1)},_set:function(b,d){if("value"==b){d instanceof Date&&!(this.dateClassObj instanceof Date)&&(d=new this.dateClassObj(d));var c=this._get("value");if(c instanceof this.dateClassObj&&0==this.compare(d,c))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(b){this._isInvalidDate(b)&&(b=new this.dateClassObj);this._set("dropDownDefaultValue",b)},openDropDown:function(b){this.dropDown&&
this.dropDown.destroy();var d=f.isString(this.popupClass)?f.getObject(this.popupClass,!1):this.popupClass,c=this,a=this.get("value");this.dropDown=new d({onChange:function(a){c.set("value",a,!0)},id:this.id+"_popup",dir:c.dir,lang:c.lang,value:a,textDir:c.textDir,currentFocus:!this._isInvalidDate(a)?a:this.dropDownDefaultValue,constraints:c.constraints,filterString:c.filterString,datePackage:c.datePackage,isDisabledDate:function(a){return!c.rangeCheck(a,c.constraints)}});this.inherited(arguments)},
_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(b,d){this._setValueAttr(this.parse(b,this.constraints),d,b)}})})},"widgets/Query/SingleTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred jimu/utils esri/request esri/tasks/query esri/tasks/QueryTask esri/tasks/RelationshipQuery".split(" "),function(s,b,n,d,f,m,r,q,e,t){function c(){return{queryTr:null,config:null,layerInfo:null,askForValues:null,queryType:-1,
query:{maxRecordCount:1E3,resultLayer:null,where:"",geometry:null,nextIndex:0,allCount:0,objectIds:[]}}}s=s(null,{tempResultLayer:null,map:null,currentAttrs:null,constructor:function(a,b){this.map=a;this.currentAttrs=b},resetCurrentAttrs:function(){this.currentAttrs=c()},getCurrentAttrs:function(){return this.currentAttrs},executeQueryForFirstTime:function(){var a=null,a=this.currentAttrs.query.where,b=this.currentAttrs.query.geometry;return a=1===this.currentAttrs.queryType?this.doQuery_SupportOrderByAndPagination(a,
b):2===this.currentAttrs.queryType?this.doQuery_SupportObjectIds(a,b):this.doQuery_NotSupportObjectIds(a,b)},executeQueryWhenScrollToBottom:function(){var a=null;1===this.currentAttrs.queryType?a=this.onResultsScroll_SupportOrderByAndPagination():2===this.currentAttrs.queryType&&(a=this.onResultsScroll_SupportObjectIds());return a},_isServiceSupportsOrderBy:function(a){var b=!1;a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsOrderBy&&(b=!0);return b},_isServiceSupportsPagination:function(a){var b=
!1;a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsPagination&&(b=!0);return b},_tryLocaleNumber:function(a){var b=m.localizeNumber(a);if(null===b||void 0===b)b=a;return b},_tryLocaleDate:function(a){var b=m.localizeDate(a);b||(b=a.toLocaleDateString());return b},_removeTempResultLayer:function(){this.tempResultLayer&&this.map.removeLayer(this.tempResultLayer);this.tempResultLayer=null},_addOperationalLayer:function(a){this.map.addLayer(a)},_getLayerInfoWithRelationships:function(a){var c=
new f;r({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(b.hitch(this,function(l){l.relationships||(l.relationships=[]);var e=this._getServiceUrlByLayerUrl(a),g=n.map(l.relationships,b.hitch(this,function(a){return r({url:e+"/"+a.relatedTableId,content:{f:"json"},handleAs:"json",callbackParamName:"callback"})}));d(g).then(b.hitch(this,function(a){n.forEach(a,b.hitch(this,function(a,c){var d=l.relationships[c];d.name=a.name;d.fields=n.filter(a.fields,b.hitch(this,function(a){return"esriFieldTypeGeometry"!==
a.type}))}));c.resolve(l)}),b.hitch(this,function(a){c.reject(a)}))}),b.hitch(this,function(a){c.reject(a)}));return c},_getLayerIndexByLayerUrl:function(a){var b=a.lastIndexOf("/");a=a.slice(b+1,a.length);return parseInt(a,10)},_getServiceUrlByLayerUrl:function(a){var b=a.lastIndexOf("/");return a.slice(0,b)},_isSupportObjectIds:function(a){var b=0;a.currentVersion&&(b=parseFloat(a.currentVersion));return 10<=b||a.hasOwnProperty("typeIdField")},_isImageServiceLayer:function(a){return-1<a.indexOf("/ImageServer")},
_isTable:function(a){return"Table"===a.type},_getBestQueryName:function(a){for(var c=a=a?a+(" _"+this.nls.queryResult):a+this.nls.queryResult,d=n.map(this.map.graphicsLayerIds,b.hitch(this,function(a){return this.map.getLayer(a).name})),e=2;0<=n.indexOf(d,c);)c=a+"_"+e,e++;return c},_getQueryResultTemplate:function(){return{features:[],relatedResults:[],relatedTableIds:[]}},doQuery_SupportOrderByAndPagination:function(a,c){var l=new f,e=b.hitch(this,function(a){console.error(a);l.reject(a)});this._queryCount(a,
c).then(b.hitch(this,function(g){if(0===g)this.currentAttrs.query.allCount=0,l.resolve(this._getQueryResultTemplate());else{this.currentAttrs.query.allCount=g;this.currentAttrs.query.nextIndex=0;var h=this.currentAttrs.config.objectIdField;this._queryWithPaginationAndOrder(a,c,0,this.currentAttrs.query.maxRecordCount).then(b.hitch(this,function(a){var c=a.features;a=n.map(c,b.hitch(this,function(a){a=a.attributes[h];return a=parseInt(a,10)}));a=this._queryRelatedFeaturesById(a);var k=n.map(a,b.hitch(this,
function(a){return a.promise})),g=n.map(a,function(a){return a.relationshipId});d(k).then(b.hitch(this,function(a){this.currentAttrs.query.nextIndex+=c.length;l.resolve({features:c,relatedResults:a,relatedTableIds:g})}),e)}),e)}}),e);return l},onResultsScroll_SupportOrderByAndPagination:function(){var a=new f,c=this.currentAttrs.query.nextIndex;if(c>=this.currentAttrs.query.allCount)return a.resolve(this._getQueryResultTemplate()),a;var l=b.hitch(this,function(b){console.error(b);a.reject(b)}),e=
this.currentAttrs.config.objectIdField;this._queryWithPaginationAndOrder(this.currentAttrs.query.where,this.currentAttrs.query.geometry,c,this.currentAttrs.query.maxRecordCount).then(b.hitch(this,function(c){var k=c.features;c=n.map(k,b.hitch(this,function(a){a=a.attributes[e];return a=parseInt(a,10)}));c=this._queryRelatedFeaturesById(c);var f=n.map(c,b.hitch(this,function(a){return a.promise})),m=n.map(c,function(a){return a.relationshipId});d(f).then(b.hitch(this,function(b){this.currentAttrs.query.nextIndex+=
k.length;a.resolve({features:k,relatedResults:b,relatedTableIds:m})}),l)}),l);return a},doQuery_SupportObjectIds:function(a,c){var l=new f,e=b.hitch(this,function(a){console.error(a);l.reject(a)});this._queryIds(a,c).then(b.hitch(this,function(a){if(a&&0<a.length){var c=this.currentAttrs.query.allCount=a.length;this.currentAttrs.query.objectIds=a;this.currentAttrs.query.nextIndex=0;var k=this.currentAttrs.query.maxRecordCount,f=[],f=c>k?a.slice(0,k):a,m=[];a=this._queryByObjectIds(f,!0);m.push(a);
f=this._queryRelatedFeaturesById(f);n.forEach(f,function(a){m.push(a.promise)});var q=n.map(f,function(a){return a.relationshipId});d(m).then(b.hitch(this,function(a){var b=a[0].features;this.currentAttrs.query.maxRecordCount=b.length;this.currentAttrs.query.nextIndex+=b.length;a=a.slice(1);l.resolve({features:b,relatedResults:a,relatedTableIds:q})}),e)}else this.currentAttrs.query.allCount=0,l.resolve(this._getQueryResultTemplate())}),e);return l},onResultsScroll_SupportObjectIds:function(){var a=
new f,c=this.currentAttrs.query.objectIds,l=this.currentAttrs.query.nextIndex;if(l>=c.length)a.resolve(this._getQueryResultTemplate());else{var e=Math.min(c.length-l,this.currentAttrs.query.maxRecordCount),c=c.slice(l,l+e);if(0===c.length)a.resolve(this._getQueryResultTemplate());else{var g=[],l=this._queryByObjectIds(c,!0);g.push(l);c=this._queryRelatedFeaturesById(c);n.forEach(c,function(a){g.push(a.promise)});var h=n.map(c,function(a){return a.relationshipId});d(g).then(b.hitch(this,function(b){var c=
b[0].features;this.currentAttrs.query.nextIndex+=c.length;b=b.slice(1);a.resolve({features:c,relatedResults:b,relatedTableIds:h})}),b.hitch(this,function(b){console.error(b);a.reject(b)}));return a}}},doQuery_NotSupportObjectIds:function(a,c){var d=new f;this._query(a,c,!0).then(b.hitch(this,function(a){a=a.features;this.currentAttrs.query.allCount=a.length;d.resolve({features:a,relatedResults:[],relatedTableIds:[]})}),b.hitch(this,function(a){console.error(a);d.reject(a)}));return d},_getObjectIdField:function(){return this.currentAttrs.config.objectIdField},
_getOutputFields:function(){var a=n.map(this.currentAttrs.config.popup.fields,b.hitch(this,function(a){return a.name})),c=this.currentAttrs.config.objectIdField;0>n.indexOf(a,c)&&a.push(c);(c=this.currentAttrs.config.popup.title.match(/\$\{\w+\}/g))&&0<c.length&&n.forEach(c,b.hitch(this,function(b){b=b.replace("${","").replace("}","");0>a.indexOf(b)&&a.push(b)}));var d=n.map(this.currentAttrs.layerInfo.fields,b.hitch(this,function(a){return a.name}));return a=n.filter(a,b.hitch(this,function(a){return 0<=
d.indexOf(a)}))},_query:function(a,b,c){var d=new q;d.where=a;b&&(d.geometry=b);d.outSpatialReference=this.map.spatialReference;d.returnGeometry=!!c;d.outFields=this._getOutputFields();return(new e(this.currentAttrs.config.url)).execute(d)},_queryIds:function(a,b){var c=new q;c.where=a;b&&(c.geometry=b);c.returnGeometry=!1;c.outSpatialReference=this.map.spatialReference;return(new e(this.currentAttrs.config.url)).executeForIds(c)},_queryByObjectIds:function(a,c){var d=new f,m=new q;m.returnGeometry=
!!c;m.outSpatialReference=this.map.spatialReference;m.outFields=this._getOutputFields();m.objectIds=a;(new e(this.currentAttrs.config.url)).execute(m).then(b.hitch(this,function(a){d.resolve(a)}),b.hitch(this,function(e){if(400===e.code){var h=this._getObjectIdField(),f="",m=a.length;n.forEach(a,b.hitch(this,function(a,b){f+=h+" \x3d "+a;b!==m-1&&(f+=" OR ")}));this._query(f,null,c).then(b.hitch(this,function(a){d.resolve(a)}),b.hitch(this,function(a){d.reject(a)}))}else d.reject(e)}));return d},
_queryCount:function(a,b){var c=new q;c.where=a;b&&(c.geometry=b);c.returnGeometry=!1;c.outSpatialReference=this.map.spatialReference;return(new e(this.currentAttrs.config.url)).executeForCount(c)},_queryWithPaginationAndOrder:function(a,c,d,f){var g=new q;g.where=a;c&&(g.geometry=c);g.outSpatialReference=this.map.spatialReference;g.returnGeometry=!0;g.outFields=this._getOutputFields();g.start=d;g.num=f;if((a=this.currentAttrs.config.orderByFields)&&0<a.length)g.orderByFields=a,a=n.map(a,b.hitch(this,
function(a){return a.split(" ")[0]})),n.forEach(a,b.hitch(this,function(a){0>g.outFields.indexOf(a)&&g.outFields.push(a)}));return(new e(this.currentAttrs.config.url)).execute(g)},_getCurrentRelationships:function(){return this.currentAttrs.queryTr.layerInfo.relationships||[]},_queryRelatedFeaturesById:function(a){var c=[],d=this._getCurrentRelationships();if(d&&0<d.length){var f=new e(this.currentAttrs.config.url);n.forEach(d,b.hitch(this,function(b){var d=new t;d.objectIds=a;d.relationshipId=b.id;
var e=n.map(b.fields,function(a){return a.name});d.outFields=e;d.returnGeometry=!1;d=f.executeRelationshipQuery(d);c.push({relationshipId:b.id,promise:d})}))}return c},_findRelationshipInfo:function(a){for(var b=this._getCurrentRelationships(),c=0;c<b.length;c++)if(b[c].id===a)return b[c];return null},_findRelationshipFields:function(a){var b=[];if(a=this._findRelationshipInfo(a))b=a.fields;return b},_addResultItems:function(a,b,c,d){console.log(a,b,c,d)}});s.getCleanCurrentAttrsTemplate=c;return s})},
"widgets/Query/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:dijit/templates/TitlePane.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-event\x3d"ondijitclick:_onTitleClick, onkeydown:_onTitleKey"\r\n\t\t\tclass\x3d"dijitTitlePaneTitle" data-dojo-attach-point\x3d"titleBarNode" id\x3d"${id}_titleBarNode"\x3e\r\n\t\t\x3cdiv class\x3d"dijitTitlePaneTitleFocus" data-dojo-attach-point\x3d"focusNode"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"arrowNode" class\x3d"dijitInline dijitArrowNode" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"arrowNodeInner" class\x3d"dijitArrowNodeInner"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitTitlePaneTextNode"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTitlePaneContentOuter" data-dojo-attach-point\x3d"hideNode" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d"dijitReset" data-dojo-attach-point\x3d"wipeNode" role\x3d"presentation"\x3e\r\n\t\t\t\x3cdiv class\x3d"dijitTitlePaneContentInner" data-dojo-attach-point\x3d"containerNode" role\x3d"region" id\x3d"${id}_pane" aria-labelledby\x3d"${id}_titleBarNode"\x3e\r\n\t\t\t\t\x3c!-- nested divs because wipeIn()/wipeOut() doesn\'t work right on node w/padding etc.  Put padding on inner div. --\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/_SingleFilterParameter.html":'\x3cdiv\x3e\r\n  \x3ctable style\x3d"width:100%;"\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol width\x3d"100px"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"prompt" data-dojo-attach-point\x3d"promptNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"allValueBoxContainer" style\x3d"width:100%;"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"stringTextBoxContainer" style\x3d"display:none;"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"stringTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"display:none;width:100%;" class\x3d"dijit-form-ValidationTextBox" /\x3e\r\n\r\n              \x3cdiv data-dojo-attach-point\x3d"stringCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n\r\n              \x3cdiv data-dojo-attach-point\x3d"stringUniqueValuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"label",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv data-dojo-attach-point\x3d"numberTextBoxContainer" style\x3d"display:none;"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"numberTextBox" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"display:none;width:100%;" /\x3e\r\n\r\n              \x3cdiv data-dojo-attach-point\x3d"numberCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n\r\n              \x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd style\x3d"width:40%;"\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"numberTextBox1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n                      \x3cspan\x3e${nls.and}\x3c/span\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd style\x3d"width:40%;"\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"numberTextBox2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n\r\n              \x3cdiv data-dojo-attach-point\x3d"numberUniqueValuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"label",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv data-dojo-attach-point\x3d"dateTextBoxContainer" style\x3d"display:none;"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"dateTextBox" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-props\x3d\'required:true, trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"display:none;width:100%;" /\x3e\r\n\r\n              \x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd style\x3d"width:40%;"\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"dateTextBox1" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n                      \x3cspan\x3e${nls.and}\x3c/span\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"dateTextBox2" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Calendar.html":'\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" class\x3d"dijitCalendarContainer" role\x3d"grid" aria-labelledby\x3d"${id}_mddb ${id}_year" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\x3cthead\x3e\r\n\t\t\x3ctr class\x3d"dijitReset dijitCalendarMonthContainer" valign\x3d"top"\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset dijitCalendarArrow\' data-dojo-attach-point\x3d"decrementMonth" scope\x3d"col"\x3e\r\n\t\t\t\t\x3cspan class\x3d"dijitInline dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset\' colspan\x3d"5" scope\x3d"col"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode"\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset dijitCalendarArrow\' scope\x3d"col" data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\t\x3cspan class\x3d"dijitInline dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t${!dayCellsHtml}\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/thead\x3e\r\n\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t${!dateRowsHtml}\r\n\t\x3c/tbody\x3e\r\n\t\x3ctfoot class\x3d"dijitReset dijitCalendarYearContainer"\x3e\r\n\t\t\x3ctr\x3e\r\n\t\t\t\x3ctd class\x3d\'dijitReset\' valign\x3d"top" colspan\x3d"7" role\x3d"presentation"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/tfoot\x3e\r\n\x3c/table\x3e\r\n',
"url:widgets/Query/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"jimu-widget-normal query-widget-content"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"queryList" class\x3d"query-step query-list"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"queriesNode" class\x3d"queries"\x3e\r\n        \x3cdiv class\x3d"execute-tip"\x3e\r\n          ${nls.executeQueryTip}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"queries-table-container"\x3e\r\n          \x3ctable data-dojo-attach-event\x3d"onclick:_onQueryListClicked" cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"queries-table" onselectstart\x3d"return false;"\x3e\r\n            \x3ccolgroup\x3e\r\n              \x3ccol width\x3d"14px"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n            \x3c/colgroup\x3e\r\n            \x3ctbody data-dojo-attach-point\x3d"queriesTbody"\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"invalidConfigNode" class\x3d"invalid-config"\x3e\r\n        \x3cdiv class\x3d"error"\x3e\r\n          ${nls.invalidConfig}\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"noQueryTipSection" class\x3d"no-query-tip"\x3e\r\n        ${nls.noneQueryTip}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"queryParams" class\x3d"query-step query-params"\x3e\r\n      \x3cdiv class\x3d"step-head query-params-head"\x3e\r\n        \x3cdiv class\x3d"step-title params-title"\x3e${nls.queryParams}\x3c/div\x3e\r\n        \x3cdiv class\x3d"operations"\x3e\r\n          \x3cdiv class\x3d"params-back jimu-float-leading" data-dojo-attach-event\x3d"onclick:_onBtnParamsBackClicked"\x3e\r\n            \x3cdiv class\x3d"back-icon jimu-float-leading"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"back-tip jimu-float-leading"\x3e${nls.queries}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"apply jimu-float-trailing" data-dojo-attach-point\x3d"btnApply" data-dojo-attach-event\x3d"onclick:_onBtnApplyClicked"\x3e${nls.apply}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"params-container" data-dojo-attach-point\x3d"paramsContainer"\x3e\r\n        \x3cdiv class\x3d"attributes-section" data-dojo-attach-point\x3d"parametersDiv"\x3e\r\n          \x3cspan style\x3d"display:block;margin-bottom:10px;"\x3e${nls.specifyParamsTip} :\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"spatial-section" style\x3d"margin-top:20px; margin-bottom:20px;"\x3e\r\n          \x3cdiv\x3e\r\n            \x3cinput type\x3d"checkbox" checked\x3d"false" data-dojo-attach-point\x3d"cbxUseSpatial" data-dojo-attach-event\x3d"onclick: _onCbxUseSpatialClicked" /\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"useSpatialLabel"\x3e${nls.useSpatialFilter}\x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"selectSpatialDiv" style\x3d"margin-left:7px; margin-top:7px;"\x3e\r\n            \x3ctable class\x3d"current-view" valign\x3d"top" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr class\x3d"current-extent-tr"\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"cbxUseMapExtent" checked data-dojo-attach-event\x3d"onclick:_onCbxUseMapExtentClicked" /\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd class\x3d"current-extent-td"\x3e\r\n                    \x3clabel data-dojo-attach-point\x3d"currentExtentLabel" class\x3d"map-extent-tip"\x3e${nls.useCurrentMapExtent}\x3c/label\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr class\x3d"draw-graphic-tr"\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"cbxDrawGraphic" data-dojo-attach-event\x3d"onclick:_onCbxDrawGraphicClicked" /\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd class\x3d"draw-graphic-td"\x3e\r\n                    \x3clabel data-dojo-attach-point\x3d"drawGraphicLabel" class\x3d"draw-graphic-tip"\x3e${nls.drawGraphicOnMap}\x3c/label\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n            \x3cdiv class\x3d"draw-graphic" data-dojo-attach-point\x3d"drawBoxDiv"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"operational"\x3e\r\n          \x3cinput type\x3d"checkbox" data-dojo-attach-point\x3d"cbxOperational" checked\x3d"false" /\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"operationalLayerLabel"\x3e${nls.operationalLayerTip}\x3c/label\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"operationalTipDiv" class\x3d"jimu-widget-note operational-tip-div"\x3e${nls.operationalTip}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"queryResults" class\x3d"query-step query-results"\x3e\r\n      \x3cdiv class\x3d"step-head query-results-head"\x3e\r\n        \x3cdiv class\x3d"step-title results-title"\x3e${nls.queryResults}\x3c/div\x3e\r\n        \x3cdiv class\x3d"operations"\x3e\r\n          \x3cdiv class\x3d"params-back jimu-float-leading" data-dojo-attach-event\x3d"onclick:_onBtnResultsBackClicked"\x3e\r\n            \x3cdiv class\x3d"back-icon jimu-float-leading"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"back-tip jimu-float-leading"\x3e${nls.parameters}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"results-number" data-dojo-attach-point\x3d"resultsNumberDiv"\x3e\r\n        \x3cspan\x3e${nls.numberFound}: \x3c/span\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"numSpan"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"results-container" data-dojo-attach-point\x3d"resultsContainer" data-dojo-attach-event\x3d"onscroll:_onResultsScroll" onselectstart\x3d"return false;"\x3e\r\n        \x3ctable data-dojo-attach-point\x3d"resultsTable" valign\x3d"top" class\x3d"results-table" data-dojo-attach-event\x3d"onclick:_onResultsTableClicked" cellpadding\x3d"0" cellspacing\x3d"0" \x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"resultsTbody"\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"btn-section"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"btnClearAll" data-dojo-attach-event\x3d"onclick:_onBtnClearAllClicked" \r\n    class\x3d"jimu-btn jimu-priority-secondary btn-clear-all" title\x3d"${nls.clearResults}" \x3e${nls.clearResults}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Query/css/style.css":".jimu-widget-query{position: relative; width: 99%; height: 100%; min-width: 222px; min-height: 237px; overflow-x: hidden;}.jimu-widget-query .query-widget-content{position: absolute; width: 100%; left: 0; right: 0; height: auto; top: 0; bottom: 60px;}.jimu-widget-query .btn-section{position: absolute; width: 100%; left: 0; right: 0; bottom: 0; height: auto; text-align: center;}.jimu-widget-query .btn-section .btn-clear-all{margin-left: auto; margin-right: auto; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-query .query-step{position: absolute; width: 100%; height: 100%; top: 0;}.jimu-widget-query .query-list{left: 0;}.jimu-widget-query .query-list .queries{position: absolute; width: 100%; height: 100%; left: 0; top: 0; overflow-y: auto;}.jimu-widget-query .query-list .queries .execute-tip{line-height: 20px;}.jimu-widget-query .query-list .queries .queries-table-container{width: 100%; margin-top: 15px;}.jimu-widget-query .query-list .queries .queries-table{width: 99%; border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto;}.jimu-widget-query .query-list .queries .queries-table td{height: 30px; line-height: 30px; cursor: pointer;}.jimu-widget-query .query-list .queries .queries-table tr *{cursor: pointer;}.jimu-widget-query .query-list .queries .queries-table .query-name-div{width: 100%; overflow: hidden; text-overflow: ellipsis; height: 100%;}.jimu-widget-query .query-list .queries .queries-table .third-td .arrow{background-repeat: no-repeat; background-position: center; background-image: url(images/arrow_right1.png); width: 100%; height: 100%;}.jimu-rtl .jimu-widget-query .query-list .queries .queries-table .third-td .arrow{background-image: url(images/rtl_arrow_right1.png);}.jimu-widget-query .queries-table .jimu-table-row.jimu-state-active .third-td .arrow{background-image: url(images/arrow_right2.png);}.jimu-rtl .jimu-widget-query .queries-table .jimu-table-row.jimu-state-active .third-td .arrow{background-image: url(images/rtl_arrow_right2.png);}.jimu-widget-query .queries-table .jimu-table-row:hover .third-td .arrow{background-image: url(images/arrow_right2.png);}.jimu-rtl .jimu-widget-query .queries-table .jimu-table-row:hover .third-td .arrow{background-image: url(images/rtl_arrow_right2.png);}.jimu-widget-query .query-list .invalid-config{display: none; position: absolute; width: 100%; height: 100%; left: 0; top: 0;}.jimu-widget-query .query-list .no-query-tip{display: none; line-height: 20px;}.jimu-widget-query .step-head{position: relative; width: 100%; height: 30px; line-height: 30px;}.jimu-widget-query .step-title{position: absolute; width: 100%; height: 100%; left: 0; top: 0; text-align: center; color: #86909c;}.jimu-widget-query .step-head .operations{position: absolute; width: 100%; height: 100%; left: 0; right: 0; top: 0;}.jimu-widget-query .step-head .operations .params-back{color: blue; cursor: pointer; height: 100%;}.jimu-widget-query .step-head .operations .params-back .back-icon{width: 8px; height: 100%; background-repeat: no-repeat; background-position: center center; background-image: url(images/arrow_left.png); margin-right: 5px;}.jimu-rtl .jimu-widget-query .step-head .operations .params-back .back-icon{background-image: url(images/rtl_arrow_left.png); margin-right: 0; margin-left: 5px;}.jimu-widget-query .step-head .operations .params-back .back-tip{height: 100%; color: #51b1fe;}.jimu-widget-query .query-params{left: 100%;}.jimu-widget-query .query-params .query-params-head .operations .apply{cursor: pointer; height: 100%; color: #51b1fe;}.jimu-widget-query .query-params .params-container{position: absolute; width: 100%; left: 0; top: 40px; bottom: 0; overflow-y: auto;}.jimu-widget-query .query-params table.current-view{width: auto; border-collapse: collapse; margin-top: 10px;}.jimu-widget-query .query-params table.current-view td{vertical-align: top;}.jimu-widget-query .query-params .current-extent-td{padding-left: 8px;}.jimu-rtl .jimu-widget-query .query-params .current-extent-td{padding-left: 0; padding-right: 8px;}.jimu-widget-query .query-params .draw-graphic-tr td{padding-top:5px;}.jimu-widget-query .query-params .draw-graphic-td{padding-left: 8px;}.jimu-rtl .jimu-widget-query .query-params .draw-graphic-td{padding-left: 0; padding-right: 8px;}.jimu-widget-query .query-params .draw-graphic{margin-top:5px;}.jimu-widget-query .query-params .operational-tip-div{width: auto; margin-top: 5px; margin-left: 15px;}.jimu-rtl .jimu-widget-query .query-params .operational-tip-div{margin-left: 0; margin-right: 15px;}.jimu-widget-query .query-results{left: 200%;}.jimu-widget-query .query-results .results-container{position: absolute; width: 100%; left: 0; top: 50px; bottom: 0; overflow-x: hidden; overflow-y: auto;}.jimu-widget-query .query-results .results-table{table-layout: fixed; width: 100%; border-collapse: collapse;}.jimu-widget-query .query-results .feature-attributes{max-width: 100%; border-collapse: collapse;}.jimu-widget-query .query-results .results-table\x3etbody\x3etr.query-result-item\x3etd{padding-left: 15px; padding-right: 15px; padding-top: 12px; padding-bottom: 12px; cursor: pointer;}.jimu-rtl .jimu-widget-query .query-results .results-table\x3etbody\x3etr.query-result-item\x3etd{padding-left: 0; padding-right: 15px;}.jimu-widget-query .query-results .results-table\x3etbody\x3etr.query-result-item\x3etd .feature-attributes{margin-top: 4px; width: 100%; table-layout: fixed; word-break: break-all;}.jimu-widget-query .query-results .query-result-item td.attr-name{padding: 2px 5px 5px 2px; color: #888888;}.jimu-widget-query .query-results .query-result-item td.attr-value{padding: 2px 0 5px 2px;}.jimu-rtl .jimu-widget-query .query-results .query-result-item td.attr-value{padding: 2px 2px 5px 0;}.jimu-widget-query .relationship-attr.dijitTitlePane {margin: 0 auto; width: 100%;}.jimu-widget-query .relationship-attr.dijitTitlePane .dijitTitlePaneTitle {font-size: 12px; color: #686868; border: none; background-image: none; width: 100%; padding: 0;}.jimu-widget-query .relationship-attr.dijitTitlePane .dijitTitlePaneTitleFocus {margin-top: 0; padding-top: 5px; padding-bottom: 3px;}.jimu-widget-query .query-result-item.even .relationship-attr.dijitTitlePane .dijitTitlePaneTitleClosed {background-color: #f0f0f0;}.jimu-widget-query .query-result-item.even:hover .relationship-attr.dijitTitlePane .dijitTitlePaneTitleClosed {background-color: #f0f0f0;}.jimu-widget-query .query-result-item.odd .relationship-attr.dijitTitlePane .dijitTitlePaneTitleClosed {background-color: #ffffff;}.jimu-widget-query .query-result-item.jimu-state-active .relationship-attr.dijitTitlePane .dijitTitlePaneTitleClosed {background-color: #d9dde0 !important;}.jimu-widget-query .query-result-item:hover .relationship-attr.dijitTitlePane .dijitTitlePaneTitleClosed {background-color: #d9dde0 !important;}.jimu-widget-query .relationship-attr.dijitTitlePane .dijitTitlePaneTitleOpen {background-color: #B5DDE9;}.jimu-widget-query .relationship-attr.dijitTitlePane .dijitTitlePaneContentOuter {border: 2px solid #B5DDE9;}.jimu-widget-query .relationship-attr.dijitTitlePane .dijitTitlePaneContentInner {font-size: 10px; color: #686868;}.jimu-widget-query .relationship-attr.dijitTitlePane .dijitTitlePaneContentInner .related-row{margin-top: 4px; overflow: hidden;}.jimu-widget-query .relationship-attr.dijitTitlePane .dijitTitlePaneContentInner .related-row .related-name{width: 40%;}.jimu-widget-query .relationship-attr.dijitTitlePane .dijitTitlePaneContentInner .related-row .related-value{width: 60%;}.query-popup-title{height: 20px;}.esriPopupMobile .query-popup-title{position: relative; top: 5px;}.query-popup .header{font-weight: bold;}.query-popup .hzLine{border-top: 1px solid #333333; margin-top: 6px; margin-bottom: 6px;}.query-popup .query-popup-table{width: 100%; table-layout: fixed; word-break: break-all; border-collapse: collapse;}.query-popup .query-popup-table td{padding:2px 2px 5px 2px;}.query-popup .query-popup-table .attr-name{color: #888888;}",
"url:widgets/Query/config.json":'{\r\n  "queries": []\r\n}',"*now":function(s){s(['dojo/i18n!*preload*widgets/Query/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/query dojo/_base/html dojo/_base/array dojo/_base/fx dojo/promise/all dojo/Deferred dijit/_WidgetsInTemplateMixin dijit/TitlePane jimu/BaseWidget jimu/dijit/Message jimu/dijit/DrawBox jimu/utils jimu/filterUtils jimu/dijit/FilterParameters esri/layers/GraphicsLayer esri/layers/FeatureLayer esri/renderers/SimpleRenderer esri/InfoTemplate esri/symbols/jsonUtils esri/lang esri/request ./SingleTask jimu/dijit/LoadingShelter".split(" "),function(s,
b,n,d,f,m,r,q,e,t,c,a,k,l,w,g,h,u,D,E,z,A,B,C){return s([c,e],{name:"Query",baseClass:"jimu-widget-query",isValidConfig:!1,currentAttrs:null,tempResultLayer:null,operationalLayers:null,currentSingleTask:null,_getCurrentAttrs:function(){return this.currentSingleTask?this.currentSingleTask.getCurrentAttrs():null},postMixInProperties:function(){this.inherited(arguments);this.operationalLayers=[];var a=A.substitute({clearResults:this.nls.clearResults},this.nls.operationalTip);this.nls.operationalTip=
a;this.config&&this._updateConfig()},_updateConfig:function(){this.config&&(this.config.queries&&0<this.config.queries.length)&&f.forEach(this.config.queries,b.hitch(this,function(a){this._rebuildFilter(a.url,a.filter)}))},_rebuildFilter:function(a,b){try{if(b){delete b.expr;var c=new w;c.isHosted=l.isHostedService(a);c.getExprByFilterObj(b)}}catch(d){console.log(d)}},postCreate:function(){this.inherited(arguments);this._combineRadioCheckBoxWithLabel();this._initDrawBox();this._resetAndAddTempResultLayer();
this._initSelf()},onOpen:function(){this.tempResultLayer&&this.tempResultLayer.show()},onActive:function(){this.map.setInfoWindowOnClick(!1)},onDeActive:function(){this.drawBox.deactivate()},onClose:function(){this.tempResultLayer&&this.tempResultLayer.hide();this._hideInfoWindow();this.drawBox.clear();this.inherited(arguments)},destroy:function(){this._hideInfoWindow();this.drawBox.clear();this._removeAllResultLayers(!0);this.inherited(arguments)},_combineRadioCheckBoxWithLabel:function(){l.combineRadioCheckBoxWithLabel(this.cbxUseSpatial,
this.useSpatialLabel);l.combineRadioCheckBoxWithLabel(this.cbxUseMapExtent,this.currentExtentLabel);l.combineRadioCheckBoxWithLabel(this.cbxDrawGraphic,this.drawGraphicLabel);l.combineRadioCheckBoxWithLabel(this.cbxOperational,this.operationalLayerLabel)},_isServiceSupportsOrderBy:function(a){var b=!1;a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsOrderBy&&(b=!0);return b},_isServiceSupportsPagination:function(a){var b=!1;a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsPagination&&
(b=!0);return b},_tryLocaleNumber:function(a){var b=l.localizeNumber(a);if(null===b||void 0===b)b=a;return b},_tryLocaleDate:function(a){var b=l.localizeDate(a);b||(b=a.toLocaleDateString());return b},_resetAndAddTempResultLayer:function(){this._removeTempResultLayer();this.tempResultLayer=new h;this.map.addLayer(this.tempResultLayer)},_removeTempResultLayer:function(){this.tempResultLayer&&this.map.removeLayer(this.tempResultLayer);this.tempResultLayer=null},_removeAllResultLayers:function(a){this._hideInfoWindow();
this._removeTempResultLayer();this._removeAllOperatonalLayers();this._clearResultPage();a||this._fromCurrentPageToQueryList()},_addOperationalLayer:function(a){this.operationalLayers.push(a);this.map.addLayer(a)},_fromCurrentPageToQueryList:function(){d.setStyle(this.queryList,"display","block");"block"===d.getStyle(this.queryParams,"display")?(this._slide(this.queryList,-100,0),this._slide(this.queryParams,0,100)):"block"===d.getStyle(this.queryResults,"display")&&(this._slide(this.queryList,-100,
0),this._slide(this.queryResults,0,100))},_removeAllOperatonalLayers:function(){for(var a=this.operationalLayers;0<a.length;){var b=a[0];b&&this.map.removeLayer(b);a[0]=null;a.splice(0,1)}this.operationalLayers=[]},_isConfigValid:function(){return this.config&&"object"===typeof this.config},_initDrawBox:function(){this.drawBox=new k({types:["point","polyline","polygon"],map:this.map,showClear:!0,keepOneGraphic:!0});this.drawBox.placeAt(this.drawBoxDiv);this.drawBox.startup()},_initSelf:function(){var a=
"Query_"+l.getRandomString();this.cbxUseMapExtent.name=a;this.cbxDrawGraphic.name=a;this.paramsDijit=new g;this.paramsDijit.placeAt(this.parametersDiv);this.paramsDijit.startup();(this.isValidConfig=this._isConfigValid())?(a=this.config.queries,0===a.length?(d.setStyle(this.queriesNode,"display","none"),d.setStyle(this.noQueryTipSection,"display","block"),d.setStyle(this.btnClearAll,"display","none")):f.forEach(a,b.hitch(this,function(a,b){var c=a.name,v=d.toDom('\x3ctr class\x3d"single-query jimu-table-row"\x3e\x3ctd class\x3d"first-td"\x3e\x3c/td\x3e\x3ctd class\x3d"second-td"\x3e\x3cdiv class\x3d"query-name-div"\x3e\x3c/div\x3e\x3c/td\x3e\x3ctd class\x3d"third-td"\x3e\x3cdiv class\x3d"arrow"\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e');
n(".query-name-div",v)[0].innerHTML=l.stripHTML(c);d.place(v,this.queriesTbody);v.singleConfig=a;0===b%2?d.addClass(v,"even"):d.addClass(v,"odd")}))):(d.setStyle(this.queriesNode,"display","none"),d.setStyle(this.invalidConfigNode,{display:"block",left:0}),d.setStyle(this.btnClearAll,"display","none"))},_slide:function(a,c,p){d.setStyle(a,"display","block");d.setStyle(a,"left",c+"%");m.animateProperty({node:a,properties:{left:{start:c,end:p,units:"%"}},duration:500,onEnd:b.hitch(this,function(){d.setStyle(a,
"left",p);0===p?d.setStyle(a,"display","block"):d.setStyle(a,"display","none")})}).play()},_onQueryListClicked:function(a){if(a=l.getAncestorDom(a.target||a.srcElement,b.hitch(this,function(a){return d.hasClass(a,"single-query")}),10)){var c=a.singleConfig,p=C.getCleanCurrentAttrsTemplate();this.currentSingleTask=new C(this.map,p);p.queryTr=a;p.config=b.clone(c);p.layerInfo=p.queryTr.layerInfo;a=p.config.filter;c=new w;p.askForValues=c.isAskForValues(a);p.askForValues?d.setStyle(this.parametersDiv,
"display","block"):d.setStyle(this.parametersDiv,"display","none");n("tr.single-query",this.queriesTbody).removeClass("jimu-state-active");d.addClass(p.queryTr,"jimu-state-active");var e=b.hitch(this,function(){var a=p.queryTr.layerInfo;p.layerInfo=a;this._isServiceSupportsOrderBy(a)&&this._isServiceSupportsPagination(a)?p.queryType=1:this._isSupportObjectIds(a)?p.queryType=2:p.queryType=3;this._fromQueryListToQueryParams()});p.queryTr.layerInfo?e():(a=p.config.url,this.shelter.show(),this._getLayerInfoWithRelationships(a).then(b.hitch(this,
function(a){this.domNode&&(this.shelter.hide(),p.queryTr.layerInfo=a,p.layerInfo=p.queryTr.layerInfo,e())}),b.hitch(this,function(a){console.error(a);if(this.domNode){this.shelter.hide();var b="";a&&403===a.httpCode&&(b=this.nls.noPermissionsMsg);this._showQueryErrorMsg(b)}})))}},_getLayerInfoWithRelationships:function(a){var c=new q;B({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(b.hitch(this,function(d){d.relationships||(d.relationships=[]);var e=this._getServiceUrlByLayerUrl(a),
l=f.map(d.relationships,b.hitch(this,function(a){return B({url:e+"/"+a.relatedTableId,content:{f:"json"},handleAs:"json",callbackParamName:"callback"})}));r(l).then(b.hitch(this,function(a){f.forEach(a,b.hitch(this,function(a,c){var v=d.relationships[c];v.name=a.name;v.fields=f.filter(a.fields,b.hitch(this,function(a){return"esriFieldTypeGeometry"!==a.type}))}));c.resolve(d)}),b.hitch(this,function(a){c.reject(a)}))}),b.hitch(this,function(a){c.reject(a)}));return c},_onCbxUseSpatialClicked:function(){this.cbxUseSpatial.checked?
d.setStyle(this.selectSpatialDiv,"display","block"):d.setStyle(this.selectSpatialDiv,"display","none");this.cbxUseMapExtent.checked?this._onCbxUseMapExtentClicked():this._onCbxDrawGraphicClicked();this._resetDrawBox()},_onCbxUseMapExtentClicked:function(){this.cbxUseMapExtent.checked&&(this._resetDrawBox(),d.setStyle(this.drawBoxDiv,"display","none"))},_onCbxDrawGraphicClicked:function(){this.cbxDrawGraphic.checked&&d.setStyle(this.drawBoxDiv,"display","block")},_onBtnClearAllClicked:function(){this._removeAllResultLayers()},
_resetDrawBox:function(){this.drawBox.deactivate();this.drawBox.clear()},_resetQueryParamsPage:function(){this.paramsDijit.clear();this.cbxOperational.checked=!1;this.cbxUseSpatial.checked=!1;this._onCbxUseSpatialClicked();this._resetDrawBox()},_getLayerIndexByLayerUrl:function(a){var b=a.lastIndexOf("/");a=a.slice(b+1,a.length);return parseInt(a,10)},_getServiceUrlByLayerUrl:function(a){var b=a.lastIndexOf("/");return a.slice(0,b)},_fromQueryListToQueryParams:function(){this._resetQueryParamsPage();
var a=this._getCurrentAttrs(),c=a.config.url,e=b.clone(a.config.filter);this.paramsDijit.build(c,a.layerInfo,e);a=this.queryParams;c=this.queryResults;d.setStyle(this.queryList,{left:0,display:"block"});d.setStyle(a,{left:"100%",display:"block"});d.setStyle(c,"display","none");this._slide(this.queryList,0,-100);this._slide(a,100,0)},_onBtnParamsBackClicked:function(){this._resetDrawBox();d.setStyle(this.queryList,"display","block");d.setStyle(this.queryParams,"display","block");d.setStyle(this.queryResults,
"display","none");this._slide(this.queryList,-100,0);this._slide(this.queryParams,0,100)},_onBtnApplyClicked:function(){this._clearResultPage();d.setStyle(this.resultsNumberDiv,"display","none");var c=this._getCurrentAttrs(),e=c.layerInfo;if(c.askForValues){var p=this.paramsDijit.getFilterExpr();if(!(p&&"string"===typeof p))return;c.query.where=p}else c.query.where=c.config.filter.expr;c.query.maxRecordCount=e.maxRecordCount||1E3;c.query.nextIndex=0;c.query.objectIds=[];e=c.query.where;p=null;if(this.cbxUseSpatial.checked){if(this.cbxUseMapExtent.checked)p=
this.map.extent;else{var f=this.drawBox.drawLayer.graphics;0<f.length&&(p=f[0].geometry)}if(!p){new a({message:this.nls.specifySpatialFilterMsg});return}}c.query.geometry=p;this.tempResultLayer&&this.map.removeLayer(this.tempResultLayer);this.tempResultLayer=null;this._createQueryResultLayer();this._resetDrawBox();d.setStyle(this.queryList,"display","none");d.setStyle(this.queryParams,"display","block");d.setStyle(this.queryResults,"display","block");this._slide(this.queryParams,0,-100);this._slide(this.queryResults,
100,0);var g=c.query.resultLayer,f=b.hitch(this,function(a){if(this.domNode){this.shelter.hide();var b=c.query.allCount;this.numSpan.innerHTML=l.localizeNumber(b);0<b&&(g instanceof u&&this._addOperationalLayer(g),this._addResultItems(a.features,g,a.relatedResults,a.relatedTableIds))}}),h=b.hitch(this,function(a){console.error(a);this.domNode&&(this.shelter.hide(),g&&this.map.removeLayer(g),g=null,this._showQueryErrorMsg())});1===c.queryType?(d.setStyle(this.resultsNumberDiv,"display","block"),this.shelter.show(),
this.currentSingleTask.doQuery_SupportOrderByAndPagination(e,p).then(f,h)):2===c.queryType?(d.setStyle(this.resultsNumberDiv,"display","block"),this.shelter.show(),this.currentSingleTask.doQuery_SupportObjectIds(e,p).then(f,h)):this.currentSingleTask.doQuery_NotSupportObjectIds(e,p).then(f,h)},_isSupportObjectIds:function(a){var b=0;a.currentVersion&&(b=parseFloat(a.currentVersion));return 10<=b||a.hasOwnProperty("typeIdField")},_isImageServiceLayer:function(a){return-1<a.indexOf("/ImageServer")},
_isTable:function(a){return"Table"===a.type},_createQueryResultLayer:function(){var a=null,c=null,d=this._getCurrentAttrs();d.config.resultsSymbol&&(c=z.fromJson(d.config.resultsSymbol),c=new D(c));if(this.cbxOperational.checked){var a=b.clone(d.layerInfo),e=this._getBestQueryName(d.config.name||"");a.name=e;a.drawingInfo||(a.drawingInfo={});c&&(a.drawingInfo.renderer=c.toJson());a.drawingInfo.transparency=0;a.minScale=0;a.maxScale=0;a.effectiveMinScale=0;a.effectiveMaxScale=0;a.defaultVisibility=
!0;delete a.extent;var g=this._getOutputFields();a.fields=f.filter(a.fields,b.hitch(this,function(a){return 0<=g.indexOf(a.name)}));a=new u({layerDefinition:a,featureSet:null})}else this._resetAndAddTempResultLayer(),a=this.tempResultLayer;d.query.resultLayer=a;this.queryResults.resultLayer=a;c&&a.setRenderer(c);return a},_getBestQueryName:function(a){for(var c=a=a?a+(" _"+this.nls.queryResult):a+this.nls.queryResult,d=f.map(this.map.graphicsLayerIds,b.hitch(this,function(a){return this.map.getLayer(a).name})),
e=2;0<=f.indexOf(d,c);)c=a+"_"+e,e++;return c},_onResultsScroll:function(){if(l.isScrollToBottom(this.resultsContainer)){var a=this._getCurrentAttrs(),c=a.query.resultLayer,d=b.hitch(this,function(a){this.domNode&&(this.shelter.hide(),this._addResultItems(a.features,c,a.relatedResults,a.relatedTableIds))}),e=b.hitch(this,function(a){console.error(a);this.domNode&&(this._showQueryErrorMsg(),this.shelter.hide())}),f=a.query.nextIndex;1===a.queryType?f>=a.query.allCount||this.currentSingleTask.onResultsScroll_SupportOrderByAndPagination().then(d,
e):2===a.queryType&&!(f>=a.query.objectIds.length)&&this.currentSingleTask.onResultsScroll_SupportObjectIds().then(d,e)}},_clearResultPage:function(){this._hideInfoWindow();this._unSelectResultTr();d.empty(this.resultsTbody);this.numSpan.innerHTML="0"},_unSelectResultTr:function(){this.queryResults.resultTr&&d.removeClass(this.queryResults.resultTr,"jimu-state-active");this.queryResults.resultTr=null},_selectResultTr:function(a){this._unSelectResultTr();this.queryResults.resultTr=a;this.queryResults.resultTr&&
d.addClass(this.queryResults.resultTr,"jimu-state-active")},_zoomToLayer:function(a){var b=this._getCurrentAttrs();this._isTable(b.layerInfo)||(a=l.graphicsExtent(a.graphics,1.4))&&this.map.setExtent(a)},_getObjectIdField:function(){return this._getCurrentAttrs().config.objectIdField},_getOutputFields:function(){var a=this._getCurrentAttrs(),c=f.map(a.config.popup.fields,b.hitch(this,function(a){return a.name})),d=a.config.objectIdField;0>f.indexOf(c,d)&&c.push(d);(d=a.config.popup.title.match(/\$\{\w+\}/g))&&
0<d.length&&f.forEach(d,b.hitch(this,function(a){a=a.replace("${","").replace("}","");0>c.indexOf(a)&&c.push(a)}));var e=f.map(a.layerInfo.fields,b.hitch(this,function(a){return a.name}));return c=f.filter(c,b.hitch(this,function(a){return 0<=e.indexOf(a)}))},_getCurrentRelationships:function(){return this._getCurrentAttrs().queryTr.layerInfo.relationships||[]},_findRelationshipInfo:function(a){for(var b=this._getCurrentRelationships(),c=0;c<b.length;c++)if(b[c].id===a)return b[c];return null},_findRelationshipName:function(a){var b=
"";if(a=this._findRelationshipInfo(a))b=a.name;return b},_findRelationshipFields:function(a){var b=[];if(a=this._findRelationshipInfo(a))b=a.fields;return b},_getPopupFieldsWithFieldInfos:function(){var a=this._getCurrentAttrs(),c=[],d=b.clone(a.layerInfo.fields),e={};f.forEach(d,b.hitch(this,function(a){e[a.name]=a}));a=b.clone(a.config.popup.fields);f.forEach(a,b.hitch(this,function(a){var d=e[a.name];d&&(d=b.mixin(d,a),c.push(d))}));return c},_addResultItems:function(a,c,d,e){var g=this._getCurrentAttrs(),
l=null;g.config.resultsSymbol&&(l=z.fromJson(g.config.resultsSymbol));var h=b.clone(g.layerInfo.fields),k=this._getPopupFieldsWithFieldInfos();f.forEach(a,b.hitch(this,function(a,m){var n="",n=0===m%2?"even":"odd",v=[];if(d&&0<d.length){var q=a.attributes[g.config.objectIdField];f.forEach(d,b.hitch(this,function(a,b){if(a[q]){var c=this._findRelationshipName(e[b]);v.push({tableId:e[b],name:c,features:a[q].features})}}))}a.geometry&&l&&a.setSymbol(l);c.add(a);this._createQueryResultItem({feature:a,
allFieldInfos:h,titleTemplate:g.config.popup.title,fieldInfosInAttrContent:k,trClass:n,relatedFeatures:v})}));this._zoomToLayer(c)},_createQueryResultItem:function(a){var c=a.feature,e=a.allFieldInfos,g=a.titleTemplate,h=a.fieldInfosInAttrContent,k=a.trClass,m=a.relatedFeatures,q=c&&c.attributes;if(q){a=d.toDom('\x3ctr class\x3d"jimu-table-row jimu-table-row-separator query-result-item"  cellpadding\x3d"0" cellspacing\x3d"0"\x3e\x3ctd\x3e\x3cspan class\x3d"result-item-title"\x3e\x3c/span\x3e\x3ctable class\x3d"feature-attributes" valign\x3d"top"\x3e\x3ccolgroup\x3e\x3ccol width\x3d"40%" /\x3e\x3ccol width\x3d"60%" /\x3e\x3c/colgroup\x3e\x3ctbody\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/td\x3e\x3c/tr\x3e');
d.addClass(a,k);d.place(a,this.resultsTbody);a.feature=c;var k=n("span.result-item-title",a)[0],r=n("tbody",a)[0],s=l.getBestDisplayAttributes(q,e),e=A.substitute(s,g);e||(e=this.nls.noValue);k.innerHTML=e;var u=k=g="";f.forEach(h,b.hitch(this,function(a){var b=a.name,c=a.alias||b,e=s[b],f=e,b=e;a=a.specialType;"image"===a?e&&"string"===typeof e&&(f='\x3ca href\x3d"'+e+'" target\x3d"_blank"\x3e'+e+"\x3c/a\x3e",b='\x3cimg src\x3d"'+e+'" /\x3e'):"link"===a&&(e&&"string"===typeof e)&&(b=f='\x3ca href\x3d"'+
e+'" target\x3d"_blank"\x3e'+e+"\x3c/a\x3e");if(null===e||void 0===e)f=b="";a=d.toDom('\x3ctr\x3e\x3ctd class\x3d"attr-name"\x3e'+c+':\x3c/td\x3e\x3ctd class\x3d"attr-value"\x3e'+f+"\x3c/td\x3e\x3c/tr\x3e");d.place(a,r);u+='\x3ctr valign\x3d"top"\x3e\x3ctd class\x3d"attr-name"\x3e'+c+'\x3c/td\x3e\x3ctd class\x3d"attr-value"\x3e'+b+"\x3c/td\x3e\x3c/tr\x3e"}));f.forEach(m,b.hitch(this,function(a){var c=d.create("tr"),e=d.create("td",{colspan:2},c),g=d.create("div");(new t({title:this.nls.attributesFromRelationship+
": "+a.name,content:g,open:!1,"class":"relationship-attr"})).placeAt(e);d.place(c,r);u+='\x3ctr valign\x3d"top"\x3e\x3ctd class\x3d"attr-name" colspan\x3d"2"\x3e'+this.nls.attributesFromRelationship+": "+a.name+"\x3ctd\x3e\x3c/tr\x3e";var l=this._findRelationshipFields(a.tableId);f.forEach(a.features,b.hitch(this,function(a,c){var e=d.toDom("\x3cspan\x3e"+(c+1)+"\x3c/span\x3e\x3cbr/\x3e");d.place(e,g);u+='\x3ctr valign\x3d"top"\x3e\x3ctd class\x3d"attr-name" colspan\x3d"2"\x3e'+(c+1)+"\x3c/td\x3e\x3ctr\x3e";
l&&f.forEach(l,b.hitch(this,function(b){var c=a.attributes[b.name];if("esriFieldTypeDate"===b.type){if(c)var e=new Date(parseInt(c,10)),c=this._tryLocaleDate(e)}else"number"===typeof c&&(b.domain&&"codedValue"===b.domain.type?f.some(b.domain.codedValues,function(a){if(a.code===c)return c=a.name,!0}):c=this._tryLocaleNumber(c));b=b.alias||b.name;u+='\x3ctr valign\x3d"top"\x3e\x3ctd class\x3d"attr-name"\x3e'+b+'\x3c/td\x3e\x3ctd class\x3d"attr-value"\x3e'+c+"\x3c/td\x3e\x3c/tr\x3e";b=d.toDom('\x3cdiv class\x3d"related-row"\x3e\x3cdiv class\x3d"related-name jimu-float-leading"\x3e'+
b+':\x3c/div\x3e\x3cdiv class\x3d"related-value jimu-float-leading"\x3e'+c+"\x3c/div\x3e\x3c/div\x3e");d.place(b,g)}))}))}));k='\x3cdiv class\x3d"header"\x3e'+e+"\x3c/div\x3e";u&&(k=k+'\x3cdiv class\x3d"hzLine"\x3e\x3c/div\x3e'+('\x3ctable class\x3d"query-popup-table"  cellpadding\x3d"0" cellspacing\x3d"0"\x3e\x3ccolgroup\x3e\x3ccol width\x3d"40%" /\x3e\x3ccol width\x3d"60%" /\x3e\x3c/colgroup\x3e\x3ctbody\x3e'+u+"\x3c/tbody\x3e\x3c/table\x3e"));k='\x3cdiv class\x3d"query-popup"\x3e'+k+"\x3c/div\x3e";
a.infoTemplateContent=k;h=new E;g=this.map.infoWindow&&this.map.infoWindow.declaredClass&&0<=this.map.infoWindow.declaredClass.indexOf("PopupMobile")?'\x3cdiv class\x3d"query-popup-title"\x3e'+e+"\x3c/div\x3e":'\x3cdiv class\x3d"query-popup-title"\x3e\x3c/div\x3e';h.setTitle(g);a.infoTemplateTitle=g;h.setContent(k);c.setInfoTemplate(h)}},_showQueryErrorMsg:function(b){new a({message:b||this.nls.queryError})},_onResultsTableClicked:function(a){a=a.target||a.srcElement;if(d.isDescendant(a,this.resultsTable)){var c=
l.getAncestorDom(a,b.hitch(this,function(a){return d.hasClass(a,"query-result-item")}),10);if(c){this._selectResultTr(c);d.addClass(c,"jimu-state-active");var e=c.feature;if(a=e.geometry){var f=c.infoTemplateTitle,g=c.infoTemplateContent,c=a.type,h,k=null;if("point"===c||"multipoint"===c){var m=b.hitch(this,function(){k=new q;var a=this.map.getNumLevels(),c=this.map.getLevel(),a=Math.max(c,Math.floor(2*a/3));0<=this.map.getMaxZoom()?this.map.setLevel(a).then(b.hitch(this,function(){this.map.centerAt(h).then(b.hitch(this,
function(){k.resolve()}))})):this.map.centerAt(h).then(b.hitch(this,function(){k.resolve()}))});if("point"===c)h=a,m();else if("multipoint"===c)if(1===a.points.length)h=a.getPoint(0),m();else if(1<a.points.length&&(c=a.getExtent()))c=c.expand(1.4),h=a.getPoint(0),k=this.map.setExtent(c)}else"polyline"===c?(c=a.getExtent(),c=c.expand(1.4),h=c.getCenter(),k=this.map.setExtent(c)):"polygon"===c?(c=a.getExtent(),c=c.expand(1.4),h=c.getCenter(),k=this.map.setExtent(c)):"extent"===c&&(c=a.expand(1.4),h=
c.getCenter(),k=this.map.setExtent(c));k&&k.then(b.hitch(this,function(){"function"===typeof this.map.infoWindow.setFeatures&&this.map.infoWindow.setFeatures([e]);this.map.infoWindow.setTitle(f);this.map.infoWindow.setContent(g);"function"===typeof this.map.infoWindow.reposition&&this.map.infoWindow.reposition();this.map.infoWindow.show(h)}))}}}},_hideInfoWindow:function(){this.map&&this.map.infoWindow&&(this.map.infoWindow.hide(),"function"===typeof this.map.infoWindow.setFeatures&&this.map.infoWindow.setFeatures([]),
this.map.infoWindow.setTitle(""),this.map.infoWindow.setContent(""))},_onBtnResultsBackClicked:function(){var a;a=this.queryParams;d.setStyle(this.queryList,"display","none");d.setStyle(a,{display:"block",left:"-100%"});this._slide(a,-100,0);this._slide(this.queryResults,0,100)}})});