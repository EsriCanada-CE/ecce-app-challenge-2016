// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dijit/layout/TabContainer":function(){define(["dojo/_base/lang","dojo/_base/declare","./_TabContainerBase","./TabController","./ScrollingTabController"],function(k,e,q,t,p){return e("dijit.layout.TabContainer",q,{useMenu:!0,useSlider:!0,controllerWidget:"",_makeController:function(e){var m=this.baseClass+"-tabs"+(this.doLayout?"":" dijitTabNoLayout");return new ("string"==typeof this.controllerWidget?k.getObject(this.controllerWidget):this.controllerWidget)({id:this.id+"_tablist",
ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,tabPosition:this.tabPosition,doLayout:this.doLayout,containerId:this.id,"class":m,nested:this.nested,useMenu:this.useMenu,useSlider:this.useSlider,tabStripClass:this.tabStrip?this.baseClass+(this.tabStrip?"":"No")+"Strip":null},e)},postMixInProperties:function(){this.inherited(arguments);this.controllerWidget||(this.controllerWidget=("top"==this.tabPosition||"bottom"==this.tabPosition)&&!this.nested?p:t)}})})},"dijit/layout/_TabContainerBase":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style ./StackContainer ./utils ../registry ../_TemplatedMixin dojo/text!./templates/TabContainer.html".split(" "),
function(k,e,q,t,p,g,m,u,h){return k("dijit.layout._TabContainerBase",[p,u],{tabPosition:"top",baseClass:"dijitTabContainer",tabStrip:!1,nested:!1,templateString:h,postMixInProperties:function(){this.baseClass+=this.tabPosition.charAt(0).toUpperCase()+this.tabPosition.substr(1).replace(/-.*/,"");this.srcNodeRef&&t.set(this.srcNodeRef,"visibility","hidden");this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.tablist=this._makeController(this.tablistNode);this.doLayout||
e.add(this.domNode,"dijitTabContainerNoLayout");this.nested?(e.add(this.domNode,"dijitTabContainerNested"),e.add(this.tablist.containerNode,"dijitTabContainerTabListNested"),e.add(this.tablistSpacer,"dijitTabContainerSpacerNested"),e.add(this.containerNode,"dijitTabPaneWrapperNested")):e.add(this.domNode,"tabStrip-"+(this.tabStrip?"enabled":"disabled"))},_setupChild:function(d){e.add(d.domNode,"dijitTabPane");this.inherited(arguments)},startup:function(){this._started||(this.tablist.startup(),this.inherited(arguments))},
layout:function(){if(this._contentBox&&"undefined"!=typeof this._contentBox.l){var d=this.selectedChildWidget;if(this.doLayout){var e=this.tabPosition.replace(/-h/,"");this.tablist.region=e;e=[this.tablist,{domNode:this.tablistSpacer,region:e},{domNode:this.containerNode,region:"center"}];g.layoutChildren(this.domNode,this._contentBox,e);this._containerContentBox=g.marginBox2contentBox(this.containerNode,e[2]);d&&d.resize&&d.resize(this._containerContentBox)}else{if(this.tablist.resize){e=this.tablist.domNode.style;
e.width="0";var c=q.getContentBox(this.domNode).w;e.width="";this.tablist.resize({w:c})}d&&d.resize&&d.resize()}}},destroy:function(d){this.tablist&&this.tablist.destroy(d);this.inherited(arguments)},selectChild:function(d,e){this._focused&&(d=m.byId(d),this.tablist.pane2button(d.id).focus());return this.inherited(arguments)}})})},"dijit/layout/StackContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/ready dojo/topic dojo/when ../registry ../_WidgetBase ./_LayoutWidget".split(" "),
function(k,e,q,t,p,g,m,u,h,d,s,c,l,b){g("dijit-legacy-requires")&&h(0,function(){require(["dijit/layout/StackController"])});q=q("dijit.layout.StackContainer",b,{doLayout:!0,persist:!1,baseClass:"dijitStackContainer",buildRendering:function(){this.inherited(arguments);t.add(this.domNode,"dijitLayoutContainer")},postCreate:function(){this.inherited(arguments);this.own(u(this.domNode,"keydown",m.hitch(this,"_onKeyDown")))},startup:function(){if(!this._started){var a=this.getChildren();k.forEach(a,this._setupChild,
this);this.persist?this.selectedChildWidget=c.byId(e(this.id+"_selectedChild")):k.some(a,function(a){a.selected&&(this.selectedChildWidget=a);return a.selected},this);var b=this.selectedChildWidget;!b&&a[0]&&(b=this.selectedChildWidget=a[0],b.selected=!0);d.publish(this.id+"-startup",{children:a,selected:b,textDir:this.textDir});this.inherited(arguments)}},resize:function(){if(!this._hasBeenShown){this._hasBeenShown=!0;var a=this.selectedChildWidget;a&&this._showChild(a)}this.inherited(arguments)},
_setupChild:function(a){var b=a.domNode,f=p.place("\x3cdiv role\x3d'tabpanel' class\x3d'"+this.baseClass+"ChildWrapper dijitHidden'\x3e",a.domNode,"replace"),c=a["aria-label"]||a.title||a.label;c&&f.setAttribute("aria-label",c);p.place(b,f);a._wrapper=f;this.inherited(arguments);"none"==b.style.display&&(b.style.display="block");a.domNode.removeAttribute("title")},addChild:function(a,b){this.inherited(arguments);this._started&&(d.publish(this.id+"-addChild",a,b),this.layout(),this.selectedChildWidget||
this.selectChild(a))},removeChild:function(a){var b=k.indexOf(this.getChildren(),a);this.inherited(arguments);p.destroy(a._wrapper);delete a._wrapper;this._started&&d.publish(this.id+"-removeChild",a);if(!this._descendantsBeingDestroyed){if(this.selectedChildWidget===a&&(this.selectedChildWidget=void 0,this._started)){var f=this.getChildren();f.length&&this.selectChild(f[Math.max(b-1,0)])}this._started&&this.layout()}},selectChild:function(a,b){var f;a=c.byId(a);this.selectedChildWidget!=a&&(f=this._transition(a,
this.selectedChildWidget,b),this._set("selectedChildWidget",a),d.publish(this.id+"-selectChild",a),this.persist&&e(this.id+"_selectedChild",this.selectedChildWidget.id));return s(f||!0)},_transition:function(a,b){b&&this._hideChild(b);var f=this._showChild(a);a.resize&&(this.doLayout?a.resize(this._containerContentBox||this._contentBox):a.resize());return f},_adjacent:function(a){var b=this.getChildren(),f=k.indexOf(b,this.selectedChildWidget),f=f+(a?1:b.length-1);return b[f%b.length]},forward:function(){return this.selectChild(this._adjacent(!0),
!0)},back:function(){return this.selectChild(this._adjacent(!1),!0)},_onKeyDown:function(a){d.publish(this.id+"-containerKeyDown",{e:a,page:this})},layout:function(){var a=this.selectedChildWidget;a&&a.resize&&(this.doLayout?a.resize(this._containerContentBox||this._contentBox):a.resize())},_showChild:function(a){var b=this.getChildren();a.isFirstChild=a==b[0];a.isLastChild=a==b[b.length-1];a._set("selected",!0);a._wrapper&&t.replace(a._wrapper,"dijitVisible","dijitHidden");return a._onShow&&a._onShow()||
!0},_hideChild:function(a){a._set("selected",!1);a._wrapper&&t.replace(a._wrapper,"dijitHidden","dijitVisible");a.onHide&&a.onHide()},closeChild:function(a){a.onClose&&a.onClose(this,a)&&(this.removeChild(a),a.destroyRecursive())},destroyDescendants:function(a){this._descendantsBeingDestroyed=!0;this.selectedChildWidget=void 0;k.forEach(this.getChildren(),function(b){a||this.removeChild(b);b.destroyRecursive(a)},this);this._descendantsBeingDestroyed=!1}});q.ChildWidgetProperties={selected:!1,disabled:!1,
closable:!1,iconClass:"dijitNoIcon",showTitle:!0};m.extend(l,q.ChildWidgetProperties);return q})},"dijit/layout/TabController":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/has dojo/i18n dojo/_base/lang ./StackController ../registry ../Menu ../MenuItem dojo/text!./templates/_TabButton.html dojo/i18n!../nls/common".split(" "),function(k,e,q,t,p,g,m,u,h,d,s,c){c=k("dijit.layout._TabButton"+(p("dojo-bidi")?"_NoBidi":""),u.StackButton,{baseClass:"dijitTab",cssStateNodes:{closeNode:"dijitTabCloseButton"},
templateString:c,_setNameAttr:"focusNode",scrollOnFocus:!1,buildRendering:function(){this.inherited(arguments);e.setSelectable(this.containerNode,!1)},startup:function(){this.inherited(arguments);var c=this.domNode;this.defer(function(){c.className=c.className},1)},_setCloseButtonAttr:function(c){this._set("closeButton",c);t.toggle(this.domNode,"dijitClosable",c);this.closeNode.style.display=c?"":"none";c&&(c=g.getLocalization("dijit","common"),this.closeNode&&q.set(this.closeNode,"title",c.itemClose))},
_setDisabledAttr:function(c){this.inherited(arguments);if(this.closeNode)if(c)q.remove(this.closeNode,"title");else{var b=g.getLocalization("dijit","common");q.set(this.closeNode,"title",b.itemClose)}},_setLabelAttr:function(c){this.inherited(arguments);!this.showLabel&&!this.params.title&&(this.iconNode.alt=m.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});p("dojo-bidi")&&(c=k("dijit.layout._TabButton",c,{_setLabelAttr:function(c){this.inherited(arguments);this.applyTextDir(this.iconNode,
this.iconNode.alt)}}));k=k("dijit.layout.TabController",u,{baseClass:"dijitTabController",templateString:"\x3cdiv role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown:onkeydown'\x3e\x3c/div\x3e",tabPosition:"top",buttonWidget:c,buttonWidgetCloseClass:"dijitTabCloseButton",postCreate:function(){this.inherited(arguments);var c=new d({id:this.id+"_Menu",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,targetNodeIds:[this.domNode],selector:function(a){return t.contains(a,
"dijitClosable")&&!t.contains(a,"dijitTabDisabled")}});this.own(c);var b=g.getLocalization("dijit","common"),a=this;c.addChild(new s({label:b.itemClose,ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,onClick:function(b){b=h.byNode(this.getParent().currentTarget);a.onCloseButtonClick(b.page)}}))}});k.TabButton=c;return k})},"dijit/layout/StackController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/topic ../focus ../registry ../_Widget ../_TemplatedMixin ../_Container ../form/ToggleButton dojo/touch".split(" "),
function(k,e,q,t,p,g,m,u,h,d,s,c,l,b){t=e("dijit.layout._StackButton",b,{tabIndex:"-1",closeButton:!1,_aria_attr:"aria-selected",buildRendering:function(a){this.inherited(arguments);(this.focusNode||this.domNode).setAttribute("role","tab")}});e=e("dijit.layout.StackController",[s,c,l],{baseClass:"dijitStackController",templateString:"\x3cspan role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown'\x3e\x3c/span\x3e",containerId:"",buttonWidget:t,buttonWidgetCloseClass:"dijitStackCloseButton",pane2button:function(a){return d.byId(this.id+
"_"+a)},postCreate:function(){this.inherited(arguments);this.own(u.subscribe(this.containerId+"-startup",g.hitch(this,"onStartup")),u.subscribe(this.containerId+"-addChild",g.hitch(this,"onAddChild")),u.subscribe(this.containerId+"-removeChild",g.hitch(this,"onRemoveChild")),u.subscribe(this.containerId+"-selectChild",g.hitch(this,"onSelectChild")),u.subscribe(this.containerId+"-containerKeyDown",g.hitch(this,"onContainerKeyDown")));this.containerNode.dojoClick=!0;this.own(m(this.containerNode,"click",
g.hitch(this,function(a){var b=d.getEnclosingWidget(a.target);if(b!=this.containerNode&&!b.disabled&&b.page)for(a=a.target;a!==this.containerNode;a=a.parentNode)if(q.contains(a,this.buttonWidgetCloseClass)){this.onCloseButtonClick(b.page);break}else if(a==b.domNode){this.onButtonClick(b.page);break}})))},onStartup:function(a){this.textDir=a.textDir;k.forEach(a.children,this.onAddChild,this);if(a.selected)this.onSelectChild(a.selected);var b=d.byId(this.containerId).containerNode,f=g.hitch(this,"pane2button");
a={title:"label",showtitle:"showLabel",iconclass:"iconClass",closable:"closeButton",tooltip:"title",disabled:"disabled",textdir:"textdir"};var c=function(a,c){return m(b,"attrmodified-"+a,function(a){var b=f(a.detail&&a.detail.widget&&a.detail.widget.id);b&&b.set(c,a.detail.newValue)})},l;for(l in a)this.own(c(l,a[l]))},destroy:function(a){this.destroyDescendants(a);this.inherited(arguments)},onAddChild:function(a,b){var f=new (g.isString(this.buttonWidget)?g.getObject(this.buttonWidget):this.buttonWidget)({id:this.id+
"_"+a.id,name:this.id+"_"+a.id,label:a.title,disabled:a.disabled,ownerDocument:this.ownerDocument,dir:a.dir,lang:a.lang,textDir:a.textDir||this.textDir,showLabel:a.showTitle,iconClass:a.iconClass,closeButton:a.closable,title:a.tooltip,page:a});this.addChild(f,b);a.controlButton=f;if(!this._currentChild)this.onSelectChild(a);f=a._wrapper.getAttribute("aria-labelledby")?a._wrapper.getAttribute("aria-labelledby")+" "+f.id:f.id;a._wrapper.removeAttribute("aria-label");a._wrapper.setAttribute("aria-labelledby",
f)},onRemoveChild:function(a){this._currentChild===a&&(this._currentChild=null);var b=this.pane2button(a.id);b&&(this.removeChild(b),b.destroy());delete a.controlButton},onSelectChild:function(a){if(a){if(this._currentChild){var b=this.pane2button(this._currentChild.id);b.set("checked",!1);b.focusNode.setAttribute("tabIndex","-1")}b=this.pane2button(a.id);b.set("checked",!0);this._currentChild=a;b.focusNode.setAttribute("tabIndex","0");d.byId(this.containerId)}},onButtonClick:function(a){var b=this.pane2button(a.id);
h.focus(b.focusNode);this._currentChild&&this._currentChild.id===a.id&&b.set("checked",!0);d.byId(this.containerId).selectChild(a)},onCloseButtonClick:function(a){d.byId(this.containerId).closeChild(a);this._currentChild&&(a=this.pane2button(this._currentChild.id))&&h.focus(a.focusNode||a.domNode)},adjacent:function(a){if(!this.isLeftToRight()&&(!this.tabPosition||/top|bottom/.test(this.tabPosition)))a=!a;var b=this.getChildren(),f=k.indexOf(b,this.pane2button(this._currentChild.id)),c=b[f],d;do f=
(f+(a?1:b.length-1))%b.length,d=b[f];while(d.disabled&&d!=c);return d},onkeydown:function(a,b){if(!this.disabled&&!a.altKey){var f=null;if(a.ctrlKey||!a._djpage){switch(a.keyCode){case p.LEFT_ARROW:case p.UP_ARROW:a._djpage||(f=!1);break;case p.PAGE_UP:a.ctrlKey&&(f=!1);break;case p.RIGHT_ARROW:case p.DOWN_ARROW:a._djpage||(f=!0);break;case p.PAGE_DOWN:a.ctrlKey&&(f=!0);break;case p.HOME:for(var c=this.getChildren(),d=0;d<c.length;d++){var l=c[d];if(!l.disabled){this.onButtonClick(l.page);break}}a.stopPropagation();
a.preventDefault();break;case p.END:c=this.getChildren();for(d=c.length-1;0<=d;d--)if(l=c[d],!l.disabled){this.onButtonClick(l.page);break}a.stopPropagation();a.preventDefault();break;case p.DELETE:case 87:if(this._currentChild.closable&&(a.keyCode==p.DELETE||a.ctrlKey))this.onCloseButtonClick(this._currentChild),a.stopPropagation(),a.preventDefault();break;case p.TAB:a.ctrlKey&&(this.onButtonClick(this.adjacent(!a.shiftKey).page),a.stopPropagation(),a.preventDefault())}null!==f&&(this.onButtonClick(this.adjacent(f).page),
a.stopPropagation(),a.preventDefault())}}},onContainerKeyDown:function(a){a.e._djpage=a.page;this.onkeydown(a.e)}});e.StackButton=t;return e})},"dijit/layout/ScrollingTabController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/_base/lang dojo/on dojo/query dojo/sniff ../registry dojo/text!./templates/ScrollingTabController.html dojo/text!./templates/_ScrollingTabControllerButton.html ./TabController ./utils ../_WidgetsInTemplateMixin ../Menu ../MenuItem ../form/Button ../_HasDropDown dojo/NodeList-dom ../a11yclick".split(" "),
function(k,e,q,t,p,g,m,u,h,d,s,c,l,b,a,n,f,r,x,y){c=e("dijit.layout.ScrollingTabController",[b,n],{baseClass:"dijitTabController dijitScrollingTabController",templateString:c,useMenu:!0,useSlider:!0,tabStripClass:"",_minScroll:5,_setClassAttr:{node:"containerNode",type:"class"},buildRendering:function(){this.inherited(arguments);var a=this.domNode;this.scrollNode=this.tablistWrapper;this._initButtons();this.tabStripClass||(this.tabStripClass="dijitTabContainer"+this.tabPosition.charAt(0).toUpperCase()+
this.tabPosition.substr(1).replace(/-.*/,"")+"None",q.add(a,"tabStrip-disabled"));q.add(this.tablistWrapper,this.tabStripClass)},onStartup:function(){this.inherited(arguments);p.set(this.domNode,"visibility","");this._postStartup=!0;this.own(u(this.containerNode,"attrmodified-label, attrmodified-iconclass",m.hitch(this,function(a){this._dim&&this.resize(this._dim)})))},onAddChild:function(a,b){this.inherited(arguments);p.set(this.containerNode,"width",p.get(this.containerNode,"width")+200+"px")},
onRemoveChild:function(a,b){var f=this.pane2button(a.id);this._selectedTab===f.domNode&&(this._selectedTab=null);this.inherited(arguments)},_initButtons:function(){this._btnWidth=0;this._buttons=h("\x3e .tabStripButton",this.domNode).filter(function(a){if(this.useMenu&&a==this._menuBtn.domNode||this.useSlider&&(a==this._rightBtn.domNode||a==this._leftBtn.domNode))return this._btnWidth+=t.getMarginSize(a).w,!0;p.set(a,"display","none");return!1},this)},_getTabsWidth:function(){var a=this.getChildren();
if(a.length){var b=a[this.isLeftToRight()?0:a.length-1].domNode,a=a[this.isLeftToRight()?a.length-1:0].domNode;return a.offsetLeft+a.offsetWidth-b.offsetLeft}return 0},_enableBtn:function(a){var b=this._getTabsWidth();a=a||p.get(this.scrollNode,"width");return 0<b&&a<b},resize:function(b){this._dim=b;this.scrollNode.style.height="auto";var f=this._contentBox=a.marginBox2contentBox(this.domNode,{h:0,w:b.w});f.h=this.scrollNode.offsetHeight;t.setContentSize(this.domNode,f);f=this._enableBtn(this._contentBox.w);
this._buttons.style("display",f?"":"none");this._leftBtn.region="left";this._rightBtn.region="right";this._menuBtn.region=this.isLeftToRight()?"right":"left";a.layoutChildren(this.domNode,this._contentBox,[this._menuBtn,this._leftBtn,this._rightBtn,{domNode:this.scrollNode,region:"center"}]);this._selectedTab&&(this._anim&&"playing"==this._anim.status()&&this._anim.stop(),this.scrollNode.scrollLeft=this._convertToScrollLeft(this._getScrollForSelectedTab()));this._setButtonClass(this._getScroll());
this._postResize=!0;return{h:this._contentBox.h,w:b.w}},_getScroll:function(){return this.isLeftToRight()||8>d("ie")||d("ie")&&d("quirks")||d("webkit")?this.scrollNode.scrollLeft:p.get(this.containerNode,"width")-p.get(this.scrollNode,"width")+(8<=d("ie")?-1:1)*this.scrollNode.scrollLeft},_convertToScrollLeft:function(a){if(this.isLeftToRight()||8>d("ie")||d("ie")&&d("quirks")||d("webkit"))return a;var b=p.get(this.containerNode,"width")-p.get(this.scrollNode,"width");return(8<=d("ie")?-1:1)*(a-b)},
onSelectChild:function(a){var b=this.pane2button(a.id);if(b){b=b.domNode;if(b!=this._selectedTab&&(this._selectedTab=b,this._postResize)){var f=this._getScroll();(f>b.offsetLeft||f+p.get(this.scrollNode,"width")<b.offsetLeft+p.get(b,"width"))&&this.createSmoothScroll().play()}this.inherited(arguments)}},_getScrollBounds:function(){var a=this.getChildren(),b=p.get(this.scrollNode,"width"),f=p.get(this.containerNode,"width")-b,c=this._getTabsWidth();if(a.length&&c>b)return{min:this.isLeftToRight()?
0:a[a.length-1].domNode.offsetLeft,max:this.isLeftToRight()?a[a.length-1].domNode.offsetLeft+a[a.length-1].domNode.offsetWidth-b:f};a=this.isLeftToRight()?0:f;return{min:a,max:a}},_getScrollForSelectedTab:function(){var a=this._selectedTab,b=p.get(this.scrollNode,"width"),f=this._getScrollBounds(),a=a.offsetLeft+p.get(a,"width")/2-b/2;return a=Math.min(Math.max(a,f.min),f.max)},createSmoothScroll:function(a){if(0<arguments.length){var b=this._getScrollBounds();a=Math.min(Math.max(a,b.min),b.max)}else a=
this._getScrollForSelectedTab();this._anim&&"playing"==this._anim.status()&&this._anim.stop();var f=this,c=this.scrollNode,d=new g.Animation({beforeBegin:function(){this.curve&&delete this.curve;var b=c.scrollLeft,n=f._convertToScrollLeft(a);d.curve=new g._Line(b,n)},onAnimate:function(a){c.scrollLeft=a}});this._anim=d;this._setButtonClass(a);return d},_getBtnNode:function(a){for(a=a.target;a&&!q.contains(a,"tabStripButton");)a=a.parentNode;return a},doSlideRight:function(a){this.doSlide(1,this._getBtnNode(a))},
doSlideLeft:function(a){this.doSlide(-1,this._getBtnNode(a))},doSlide:function(a,b){if(!b||!q.contains(b,"dijitTabDisabled")){var f=0.75*p.get(this.scrollNode,"width")*a,f=this._getScroll()+f;this._setButtonClass(f);this.createSmoothScroll(f).play()}},_setButtonClass:function(a){var b=this._getScrollBounds();this._leftBtn.set("disabled",a<=b.min);this._rightBtn.set("disabled",a>=b.max)}});l=e("dijit.layout._ScrollingTabControllerButtonMixin",null,{baseClass:"dijitTab tabStripButton",templateString:l,
tabIndex:"",isFocusable:function(){return!1}});e("dijit.layout._ScrollingTabControllerButton",[x,l]);e("dijit.layout._ScrollingTabControllerMenuButton",[x,y,l],{containerId:"",tabIndex:"-1",isLoaded:function(){return!1},loadDropDown:function(a){this.dropDown=new f({id:this.containerId+"_menu",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir});var b=s.byId(this.containerId);k.forEach(b.getChildren(),function(a){var f=new r({id:a.id+"_stcMi",label:a.title,iconClass:a.iconClass,
disabled:a.disabled,ownerDocument:this.ownerDocument,dir:a.dir,lang:a.lang,textDir:a.textDir||b.textDir,onClick:function(){b.selectChild(a)}});this.dropDown.addChild(f)},this);a()},closeDropDown:function(a){this.inherited(arguments);this.dropDown&&(this._popupStateNode.removeAttribute("aria-owns"),this.dropDown.destroyRecursive(),delete this.dropDown)}});return c})},"widgets/AttributeTable/_ResourceManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all esri/lang ./_FeatureTable ./_RelationshipTable ./utils".split(" "),
function(k,e,q,t,p,g,m,u,h){return k(null,{_activeLayerInfoId:null,_activeRelationshipKey:null,nls:null,config:null,map:null,_delayedLayerInfos:[],_layerInfosFromMap:[],featureTableSet:{},relationshipsSet:{},relationshipTableSet:{},currentRelationshipKey:null,constructor:function(d){this.map=d&&d.map;this.nls=d&&d.nls;this._delayedLayerInfos=[];this._layerInfosFromMap=[];this.featureTableSet={};this.relationshipsSet={};this.relationshipTableSet={};this.currentRelationshipKey=null},setConfig:function(d){this.config=
e.clone(d||{})},setMap:function(d){this.map=d},updateLayerInfoResources:function(d){var s=new t;h.readConfigLayerInfosFromMap(this.map,!1,!0).then(e.hitch(this,function(c){this._layerInfosFromMap=c;this._processDelayedLayerInfos();d&&(0===this.config.layerInfos.length?(c=h.getConfigInfosFromLayerInfos(c),this.config.layerInfos=q.filter(c,function(c){return c.show})):this.config.layerInfos=q.filter(e.delegate(this.config.layerInfos),e.hitch(this,function(c){var b=this._getLayerInfoById(c.id);return c.show&&
b&&(c.name=b.name||b.title)})));s.resolve()}),function(c){s.reject(c)});return s},isEmpty:function(){return this.config&&this.config.layerInfos&&0>=this.config.layerInfos.length},getConfigInfos:function(){return e.clone(this.config.layerInfos)},addLayerInfo:function(d){0===this._layerInfosFromMap.length?this._delayedLayerInfos.push(d):0<this._layerInfosFromMap.length&&!this._getLayerInfoById(d.id)&&this._layerInfosFromMap.push(d)},addConfigInfo:function(d){this._getConfigInfoById(d.id)||(d=h.getConfigInfoFromLayerInfo(d),
this.config.layerInfos.push({id:d.id,name:d.name,layer:{url:d.layer.url,fields:d.layer.fields}}))},removeLayerInfo:function(d){d=this._getLayerInfoById(d);d=this._layerInfosFromMap.indexOf(d);this._layerInfosFromMap.splice(d,1)},removeConfigInfo:function(d){if(e.getObject("config.layerInfos",!1,this))for(var s=this.config.layerInfos.length,c=0;c<s;c++)if(this.config.layerInfos[c].id===d){this.featureTableSet[d]&&(this.featureTableSet[d].destroy(),delete this.featureTableSet);this.config.layerInfos.splice(c,
1);break}},getQueryTable:function(d,s){var c=new t;this._activeLayerInfoId=d;this.featureTableSet[d]?c.resolve({isSupportQuery:!0,table:this.featureTableSet[d]}):this._getQueryTableInfo(d).then(e.hitch(this,function(l){if(l){var b=l.layerInfo,a=l.layerObject;l=l.tableInfo;if(e.getObject("isSupportQuery",!1,l)){var n=this._getConfigInfoById(d);n.layer.fields=this._clipValidFields(n.layer.fields,a&&a.fields);b=new m({map:this.map,matchingMap:s,layerInfo:b,configedInfo:n,nls:this.nls});this.featureTableSet[d]=
b;c.resolve({isSupportQuery:l.isSupportQuery,table:b})}else c.resolve({isSupportQuery:!1})}else c.resolve(null)}),function(d){c.reject(d)});return c},getRelationTable:function(d,e){var c=new t,l=this.relationshipsSet[e];this._activeRelationshipKey=e;if(l){l=this.relationshipTableSet[e];if(!l){var l=this._getLayerInfoById(d),b=this.relationshipsSet[e],a=this._getConfigInfoById(b&&b.shipInfo&&b.shipInfo.id),l=new u({relationship:b,configedInfo:a,originalInfo:l,nls:this.nls});this.relationshipTableSet[e]=
l}c.resolve(l)}else c.resolve(null);return c},removeRelationTable:function(d){this.relationshipTableSet[d]&&(this.relationshipTableSet[d].destroy(),this.relationshipTableSet[d]=null)},getCurrentTable:function(d){return this.featureTableSet[d]||this.relationshipTableSet[d]},collectRelationShips:function(d,e){this._collectRelationShips(d,d.layerObject,e)},getConfigInfoById:function(d){return this._getConfigInfoById(d)},getLayerInfoById:function(d){return this._getLayerInfoById(d)},getRelationshipsByInfoId:function(d){var e=
[],c;for(c in this.relationshipsSet){var l=this.relationshipsSet[c];l._layerInfoId===d&&e.push(l)}return e},empty:function(){this._delayedLayerInfos=[];this._layerInfosFromMap=[];this.featureTableSet={};for(var d in this.relationshipsSet)this.relationshipsSet[d].shipInfo=null;this.relationshipsSet={};this.relationshipTableSet={};this.nls=this.map=this.config=this.currentRelationshipKey=null},_processDelayedLayerInfos:function(){0<this._delayedLayerInfos.length&&(q.forEach(this._delayedLayerInfos,
e.hitch(this,function(d){this._getLayerInfoById(d&&d.id)||this._layerInfosFromMap.push(d)})),this._delayedLayerInfos=[])},_getLayerInfoById:function(d){for(var e=0,c=this._layerInfosFromMap.length;e<c;e++)if(this._layerInfosFromMap[e]&&this._layerInfosFromMap[e].id===d)return this._layerInfosFromMap[e]},_getConfigInfoById:function(d){if(!e.getObject("layerInfos.length",!1,this.config))return null;for(var h=0,c=this.config.layerInfos.length;h<c;h++){var l=this.config.layerInfos[h];if(l&&l.id===d)return l}return null},
_getQueryTableInfo:function(d){var h=new t,c=this._getLayerInfoById(d);if(c){var l=[],b=c.getUrl();l.push(c.getLayerObject());l.push(c.getSupportTableInfo());b&&l.push(c.getRelatedTableInfoArray());p(l).then(e.hitch(this,function(a){if(this._activeLayerInfoId!==d||!a)h.resolve(null);else{var n=a[0],f=a[1];a=b?a[2]:[];g.isDefined(a)&&(g.isDefined(n)&&0<a.length)&&this._collectRelationShips(c,n,a);h.resolve({layerInfo:c,layerObject:n,tableInfo:f})}}),function(a){h.reject(a)})}else console.error("no activeLayerInfo!"),
h.reject(Error());return h},_collectRelationShips:function(d,h,c){var l=h.relationships;if(l&&0<l.length&&h&&h.url){var b=h.url.split("/");q.forEach(l,e.hitch(this,function(a){b[b.length-1]=a.relatedTableId;var n=b.join("/"),f=q.filter(c,e.hitch(this,function(a){a=a.getUrl();return g.isDefined(a)&&g.isDefined(n)&&a.toLowerCase()===n.toLowerCase()}));f&&0<f.length&&(a.shipInfo=f[0]);f=d.id+"_"+a.name+"_"+a.id;a._relKey=f;a._layerInfoId=d.id;this.relationshipsSet[f]||(this.relationshipsSet[f]=a,this.relationshipsSet[f].objectIdField=
h.objectIdField)}))}},_getLayerInfoLabel:function(d){return d.name||d.title},_getLayerInfoId:function(d){return d&&d.id||""},_clipValidFields:function(d,e){if(!d||!d.length)return e||[];if(!e||!e.length)return d;for(var c=[],l=0,b=d.length;l<b;l++)for(var a=d[l],n=0,f=e.length;n<f;n++)if(e[n].name===a.name){c.push(a);break}return c}})})},"widgets/AttributeTable/_FeatureTable":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase jimu/dijit/Message dgrid/OnDemandGrid dgrid/Selection dgrid/extensions/ColumnHider dgrid/extensions/ColumnResizer dgrid/extensions/ColumnReorder dojo/Deferred dojo/when dojo/Evented dojo/store/Memory esri/config esri/lang esri/request esri/tasks/RelationParameters esri/layers/GraphicsLayer esri/layers/FeatureLayer esri/tasks/QueryTask esri/tasks/query esri/tasks/ProjectParameters esri/graphic esri/geometry/Point esri/geometry/Multipoint esri/geometry/Polyline esri/geometry/Polygon esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/Color esri/geometry/normalizeUtils dojo/_base/lang dojo/on dojo/aspect dojo/_base/array jimu/dijit/LoadingIndicator jimu/CSVUtils ./utils dojo/query".split(" "),
function(k,e,q,t,p,g,m,u,h,d,s,c,l,b,a,n,f,r,x,y,z,D,w,K,F,C,L,G,H,I,M,v,B,N,A,O,P,E,J){return k([q,c],{baseClass:"jimu-widget-attributetable-feature-table",_defaultFeatureCount:2E3,_defaultBatchCount:25,_batchCount:0,_filterObj:null,_currentDef:null,_requestStatus:"initial",map:null,matchingMap:!1,layerInfo:null,configedInfo:null,parentWidget:null,footerHeight:25,layer:null,loading:null,grid:null,footer:null,selectedRowsLabel:null,selectionRows:null,griaphicLayer:null,nls:null,_dblClickResult:null,
actived:!1,showSelected:!1,tableCreated:!1,constructor:function(a){a=a||{};this.set("map",a.map||null);this.set("matchingMap",!!a.matchingMap);this.set("layerInfo",a.layerInfo||null);this.set("layer",a.layer||null);this.set("configedInfo",a.configedInfo||null);this.parentWidget=a.parentWidget||null},postCreate:function(){this.selectionRows=[];this.loading=new O;this.loading.placeAt(this.domNode);e.setAttr(this.domNode,"data-layerinfoid",v.getObject("layerInfo.id",!1,this));this.get("map")&&this.own(B(this.map,
"extent-change",v.hitch(this,"_onExtentChange")))},startup:function(){this.map&&(this.graphicsLayer=new r,this.map.addLayer(this.graphicsLayer))},setLayerDefinition:function(a){this._layerDefinition=a},getLayerDefinition:function(){return this._getLayerDifinition()},getFilterableFields:function(){if(this._layerDefinition&&this.configedInfo){var a=v.clone(this._layerDefinition);return this._getFilterableFields(a.fields,this.configedInfo.layer.fields)}return[]},getFilterObj:function(){return this._filterObj},
setFilterObj:function(a){this._filterObj=a},showRefreshing:function(a){a?this.loading.show():this.loading.hide()},active:function(){this.actived=!0},deactive:function(){this.actived=!1},cancelThread:function(){"fulfilled"!==this._requestStatus&&this._currentDef&&(this._currentDef.cancel({canceledBySelf:!0}),this._requestStatus="canceled")},isCanceled:function(){return"canceled"===this._requestStatus},startQuery:function(){this.cancelThread();if(!this.tableCreated||!this.layerInfo||!this.layerInfo.isTable)this._requestStatus=
"processing",this.loading.show(),this._getLayerObject().then(v.hitch(this,function(a){this.domNode&&(this.layer=a,(a=!this.layerInfo.isTable&&this.matchingMap&&this.map.extent||null)&&a.spatialReference&&a.spatialReference.isWebMercator()?(this._currentDef=M.normalizeCentralMeridian([a],null,v.hitch(this,function(a){return a[0]}))).then(v.hitch(this,function(a){this._doQuery(a)}),v.hitch(this,function(a){a&&"Request canceled"!==a.message&&console.error(a);this.loading.hide()})):this._doQuery(a))}),
v.hitch(this,function(a){console.error(a);this.loading.hide()}))},getSelectedRows:function(){return this.selectionRows},zoomTo:function(){this._zoomToSelected()},toggleSelectedRecords:function(){this.tableCreated&&(this.showSelected?this.showAllSelectedRecords():this.showSelectedRecords(),this.showSelected=!this.showSelected)},showSelectedRecords:function(){if(this.tableCreated){var a=this.layer.objectIdField;this.grid._clickShowSelectedRecords=!0;var b=this._getSelectedIds();0<b.length&&this.grid&&
(this.grid.store instanceof l?this.grid.set("query",v.hitch(this,function(f){return"number"===typeof f&&-1<b.indexOf(f)||-1<b.indexOf(f[a])?!0:!1})):this.grid.set("query",function(){return b}))}},showAllSelectedRecords:function(){this.tableCreated&&(this.grid.set("query",{}),A.forEach(this.selectionRows,v.hitch(this,function(a){this.grid.select(a)})),this.setSelectedNumber())},clearSelection:function(a){this.tableCreated&&(this.grid.clearSelection(),this.selectionRows=[],a&&this.grid.set("query",
{}),this._closePopup(),this.graphicsLayer.clear(),this.setSelectedNumber(),this.showSelected=!1,this.emit("clear-selection"))},refresh:function(){this.grid&&this.grid.clearSelection();this.startQuery()},exportToCSV:function(a){if(this.layerInfo&&this.layer&&this.tableCreated){var b=null,b=this.layer.objectIdField,f=this.getSelectedRowsData(),b=this._getOutFieldsFromLayerInfos(b),b=this._processExecuteFields(this.layer.fields,b),c={};f&&0<f.length?c.datas=f:this.grid.store instanceof l&&(f=this.grid.store.data,
c.datas=f);c.fromClient=!1;c.outFields=b;c.formatNumber=!1;c.formatDate=!0;c.formatCodedValue=!0;c.popupInfo=this.layerInfo.getPopupInfo();return P.exportCSVFromFeatureLayer(a||this.configedInfo.name,this.layer,c)}},toggleColumns:function(){this.tableCreated&&this.grid._toggleColumnHiderMenu()},changeHeight:function(a){this.grid&&0<=a-this.footerHeight&&e.setStyle(this.grid.domNode,"height",a-this.footerHeight+"px")},showGraphic:function(){this.graphicsLayer&&this.graphicsLayer.show()},hideGraphic:function(){this.graphicsLayer&&
this.graphicsLayer.hide()},isSupportQueryToServer:function(){var a=this.layer&&"esri.layers.CSVLayer"===this.layer.declaredClass,b=this.layer&&"esri.layers.StreamLayer"===this.layer.declaredClass;return this.layer&&this.layer.url&&this.configedInfo.layer.url&&!a&&!b},isSupportQueryOnClient:function(){var a=this.layer&&"esri.layers.CSVLayer"===this.layer.declaredClass,b=this.layer&&"esri.layers.StreamLayer"===this.layer.declaredClass;return!(this.layer&&this.layer.url&&this.configedInfo.layer.url)||
a||b},destroy:function(){this._destroyed||(this.layer=this.parentWidget=this.configedInfo=this.layerInfo=null,this.graphicsLayer&&this.graphicsLayer.clear&&(this.graphicsLayer.clear(),this.map.removeLayer(this.graphicsLayer)),this._dblClickResult=null,this.grid&&this.grid.destroy(),this.nls=this.map=null,this._currentDef&&!this._currentDef.isCanceled()&&this._currentDef.cancel({canceledBySelf:!0}),this.inherited(arguments))},_closePopup:function(){var a=this.map.infoWindow.getSelectedFeature(),a=
a&&this._dblClickResult&&a===this._dblClickResult;this.domNode&&a&&(this.map.infoWindow.hide(),this._dblClickResult=null)},_getLayerObject:function(){return(this._currentDef=this.layerInfo.getLayerObject()).then(v.hitch(this,function(a){var b=new d;"esri.layers.ArcGISImageServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass?(a=new x(a.url),this.own(B(a,"load",v.hitch(this,function(a){b.resolve(a.layer)})))):b.resolve(a);return b}))},_getLayerDifinition:function(){return this._layerDefinition?
s(v.clone(this._layerDefinition)):n({url:this.layer.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(v.hitch(this,function(a){this.setLayerDefinition(a);return this.getLayerDefinition()}))},_getFilterableFields:function(b,f){return A.filter(b,function(b){return A.some(f,function(f){return b.name===f.name&&(f.show||!a.isDefined(f.show))&&v.mixin(b,f)})})},_doQuery:function(a){if(this.layer){var b=this.getSelectedRows(),f=this.layer.objectIdField;this.isSupportQueryToServer()?
this._queryToServer(a,f,b):this.isSupportQueryOnClient()&&this._queryOnClient(a,f,b)}},_queryOnClient:function(c,d,n){var e={};e.features="esri.layers.StreamLayer"===this.layer.declaredClass?this.layer.getLatestObservations():this.layer.graphics;var r=this.layer.fields,w=this.configedInfo.layer.fields;e.fields=w?A.filter(w,v.hitch(this,function(b){a.isDefined(b.show)||(b.show=!0);if(b.name===d&&("esriFieldTypeOID"===b.type||"esriFieldTypeInteger"===b.type))b._pk=!0;for(var f=0,c=r.length;f<c;f++)r[f].name===
b.name&&!b.type&&(b.type=r[f].type);return b.show||b._pk})):A.filter(r,v.hitch(this,function(b){a.isDefined(b.show)||(b.show=!0);if(b.name===d&&("esriFieldTypeOID"===b.type||"esriFieldTypeInteger"===b.type))b._pk=!0;return b.show||b._pk}));for(var w=[],l=e.features.length,h=0;h<l;h++)e&&(e.features&&e.features[h]&&e.features[h].geometry)&&w.push(e.features[h].geometry);e.selectionRows=n;c&&b.defaults.geometryService&&0<w.length?(l=new f,l.geometries1=w,l.geometries2=[c],l.relation=f.SPATIAL_REL_INTERSECTION,
(this._currentDef=b.defaults.geometryService.relation(l,v.hitch(this,function(a){return a}))).then(v.hitch(this,function(a,b){for(var f=b.length,c=[],d=0;d<f;d++)c.push(a.features[b[d].geometry1Index]);a.features=c;this.queryExecute(n,a.fields,a.features.length,!1,a)},e),v.hitch(this,function(a){a&&"Request canceled"!==a.message&&console.error(a);this.loading.hide()}))):this.queryExecute(n,e.fields,e.features.length,!1,e)},_queryToServer:function(b,f,c){this._getFeatureCount(b).then(v.hitch(this,
function(d){if(this.domNode){var n=this.layer,e=a.isDefined(n.maxRecordCount)?n.maxRecordCount:1E3;this._batchCount=Math.min(e,this._defaultBatchCount);if(d<e)this._queryFeatureLayer(b,f,c,d,!1);else{var w=this._getOutFieldsFromLayerInfos(f),r={fields:this.layer.fields};this.layer._recordCounts=d;n.advancedQueryCapabilities&&n.advancedQueryCapabilities.supportsPagination?this.queryExecute(c,w,d,!0,r,b):this._getFeatureIds(f,b).then(v.hitch(this,function(a){this.domNode&&(this.layer._objectIds=a,this.queryExecute(c,
w,d,!0,r))}))}}}))},_getFeatureCount:function(a){var b=new d,f=new z;f.returnGeometry=!1;f.where=this._getLayerFilterExpression();a&&(f.geometry=a);(this._currentDef=this.layer.queryCount(f)).then(v.hitch(this,function(a){b.resolve(a)}),v.hitch(this,function(a){a&&"Request canceled"!==a.message&&(console.error(a),console.log("Could not get feature count."));this.loading.hide();b.reject(a)}));return b},_queryFeatureLayer:function(a,b,f,c,d){var n=new y(this.configedInfo.layer.url),e=new z;e.where=
this._getLayerFilterExpression();var w=this._getOutFieldsFromLayerInfos(b);0<w.length?(b=A.map(w,function(a){return a.name}),e.outFields=b):e.outFields=["*"];a&&(e.geometry=a,e.spatialRelationship=z.SPATIAL_REL_INTERSECTS);e.outSpatialReference=v.clone(this.map.spatialReference);e.returnGeometry=!1;(this._currentDef=n.execute(e,v.hitch(this,function(a){return a}))).then(v.hitch(this,function(a){this.queryExecute(f,w,c,d,a)}),v.hitch(this,function(a){a&&"Request canceled"!==a.message&&console.error(a);
this.loading.hide()}))},_getFeatureIds:function(a,b){var f=new d,c=new z;c.returnGeometry=!1;c.returnIdsOnly=!0;c.where=this._getLayerFilterExpression();c.orderByFields=this.layer._orderByFields||[a+" ASC"];b&&(c.geometry=b);(this._currentDef=this.layer.queryIds(c)).then(v.hitch(this,function(a){f.resolve(a)}),v.hitch(this,function(a){a&&"Request canceled"!==a.message&&(console.error(a),console.log("Could not get feature Ids"));f.resolve([])}));return f},queryExecute:function(a,b,f,c,d,n){var e=[],
e=null,w={};if(this.domNode){d.fields=this._processExecuteFields(this.layer.fields,b);c?e=E.generateCacheStore(this.layer,f,this._batchCount,this._getLayerFilterExpression(),n):(e=A.map(d.features,v.hitch(this,function(a){return v.clone(a.attributes)})),e=E.generateMemoryStore(e,this.layer.objectIdField));var r=this.layer;b=r.typeIdField;n=r.types;w=r.advancedQueryCapabilities&&r.advancedQueryCapabilities.supportsOrderBy;r=r.advancedQueryCapabilities&&r.advancedQueryCapabilities.supportsPagination;
w=E.generateColumnsFromFields(this.layerInfo.getPopupInfo(),d.fields,b,n,w&&r||!c);this.createTable(w,e,f);if(a&&a.length){for(var l in a)this.grid.select(a[l]);this.selectionRows=a;this.setSelectedNumber()}this.emit("data-loaded")}},createTable:function(a,b,f){if(this.grid)this.grid.set("store",b),this.grid.refresh();else{var c={};c.columns=a;c.store=b;c.keepScrollPosition=!0;c.pagingDelay=1E3;c.allowTextSelection=!0;this.grid=new (k([p,g,m,u,h]))(c,e.create("div"));e.place(this.grid.domNode,this.domNode);
this.grid.startup();this.grid._clickShowSelectedRecords=!1;this.own(B(this.grid,".dgrid-row:click",v.hitch(this,this._onRowClick)));this.own(B(this.grid,".dgrid-row:dblclick",v.hitch(this,function(){this.layerInfo&&this.layerInfo.isShowInMap()&&this._zoomToSelected()})));this.own(B(this.grid,"dgrid-refresh-complete",v.hitch(this,this._onRefreshComplete)))}this.getParent()&&(a=J(".dgrid-scroller",this.grid.domNode)[0],c=J(".dgrid-header",this.grid.domNode)[0],b=e.getComputedStyle(a),c=e.getMarginBox(c),
b=parseInt(b.marginTop,10),isFinite(b)&&(c&&b<c.h)&&e.setStyle(a,"marginTop",c.h+"px"));this.footer?e.empty(this.footer):this.footer=e.create("div",null,this.domNode);f=e.create("div",{"class":"dgrid-status self-footer",innerHTML:f+"\x26nbsp;"+this.nls.features+"\x26nbsp;"},this.footer);this.selectedRowsLabel=e.create("div",{"class":"dgrid-status self-footer",innerHTML:"0\x26nbsp;"+this.nls.selected+"\x26nbsp;"},f,"after");f=e.getStyle(this.domNode,"height");this.changeHeight(f);this._requestStatus=
"fulfilled";this.tableCreated=!0;this.loading.hide()},getSelectedRowsData:function(){if(!this.grid)return null;var a=this.layer.objectIdField,b=this.grid.store,f=b._entityData||b.data,b=this.getSelectedRows();return A.map(b,v.hitch(this,function(b){for(var c=0,d=f.length;c<d;c++)if(f[c]&&f[c][a]===b)return f[c];return{}}))||[]},setSelectedNumber:function(){if(this.selectedRowsLabel&&this.grid){var a=this.getSelectedRows();this.selectedRowsLabel.innerHTML="\x26nbsp;\x26nbsp;"+a.length+" "+this.nls.selected+
"\x26nbsp;\x26nbsp;"}},selectFeatures:function(a,b){b&&0<b.length?("rowclick"===a||"selectall"===a?this.addGraphics(b,!0):"zoom"===a&&this.getExtent(b).then(v.hitch(this,function(a){if(a){var f=null;"point"===a.type?(f=15,f=-1<this.map.getMaxZoom()?this.map.getMaxZoom():0.1,f=this.map.centerAndZoom(a,f)):f=this.map.setExtent(a.expand(1.1));f.then(v.hitch(this,function(){var f=this.map.infoWindow,c=this.layerInfo.getInfoTemplate();if(f&&f.setFeatures&&1===b.length&&c){A.forEach(b,v.hitch(this,function(a){a._layer=
this.layerInfo.layerObject;a.setInfoTemplate(c)}));f.setFeatures(b);var d=null;if("point"===a.type){var d=b[0].geometry,e=v.clone(f.markerSymbol);A.forEach(this.graphicsLayer.graphics,function(a){a.setSymbol(e)})}else d=a.getCenter();f.show(d,{closetFirst:!0});this._dblClickResult=b[0];B.once(f,"hide",v.hitch(this,function(){var a=f.getSelectedFeature(),c=v.getObject("_layer.objectIdField",!1,a),c=v.getObject("attributes."+c,!1,a),a=a&&-1<b.indexOf(a),d=this._getSelectedIds();this.domNode&&(a&&c&&
-1<d.indexOf(c))&&this.clearSelection(!1);n&&n.remove&&(n.remove(),n=null)}));var n=N.after(f,"show",v.hitch(this,function(){var a=f.getSelectedFeature(),a=a&&-1<b.indexOf(a);this.domNode&&!a&&(this.clearSelection(!1),n.remove(),n=null)}))}}))}}),v.hitch(this,function(a){a&&"Request canceled"!==a.message&&console.error(a)})),this.setSelectedNumber()):this._popupMessage(this.nls.dataNotAvailable)},getGraphicsFromLocalFeatureLayer:function(a){for(var b=[],f,c,d=a.length,n=this.layer.graphics.length,
e=this.layer.objectIdField,w=0;w<d;w++)for(var r=0;r<n;r++)if(f=this.layer.graphics[r].attributes[e]+"",c=a[w]+"",f===c){b.push(this.layer.graphics[r]);break}return b},addGraphics:function(a){var b,f,c=a.length,d=new G(G.STYLE_SOLID,new I([0,255,255]),2);this.graphicsLayer.clear();for(var n=0;n<c;n++)f=null,a[n].geometry?(a[n].geometry.spatialReference.equals(this.map.spatialReference)||console.warn("unable to draw graphic result in different wkid from map"),"point"===a[n].geometry.type?(f=new K(a[n].geometry.toJson()),
b=v.clone(this.map.infoWindow.markerSymbol)):"multipoint"===a[n].geometry.type?(f=new F(a[n].geometry.toJson()),b=v.clone(this.map.infoWindow.markerSymbol)):"polyline"===a[n].geometry.type?(f=new C(a[n].geometry.toJson()),b=d):"polygon"===a[n].geometry.type&&(f=new L(a[n].geometry.toJson()),b=new H(H.STYLE_SOLID,d,new I([255,255,255,0.25]))),f=new w(f,b,a[n].attributes,a[n].infoTemplate),this.graphicsLayer.add(f)):console.error("unable to get geometry of the reocord: ",a[n])},getExtent:function(a){var f=
new d,c,n,e=a.length;if(1===e&&a[0].geometry&&"point"===a[0].geometry.type)c=a[0].geometry;else{if(1===e&&!a[0].geometry)return f.reject(Error("AttributeTable.getExtent:: extent was not projected.")),f;for(var r=0;r<e;r++)a[r].geometry?"point"===a[r].geometry.type?(n||(n=new F(a[r].geometry.spatialReference)),n.addPoint(a[r].geometry),r===e-1&&(c=n.getExtent())):c=c?c.union(a[r].geometry.getExtent()):a[r].geometry.getExtent():console.error("unable to get geometry of the reocord: ",a[r])}if(!c||!c.spatialReference)return f.reject(Error("AttributeTable.getExtent:: extent was not projected.")),
f;a=this.map.spatialReference;c.spatialReference.equals(a)?f.resolve(c):(n=new D,n.geometries=[c],n.outSR=a,b.defaults.geometryService.project(n,v.hitch(this,function(a){this.domNode&&(a&&a.length?f.resolve(a[0]):f.reject(Error("AttributeTable.getExtent:: extent was not projected.")))}),v.hitch(this,function(a){a||(a=Error("AttributeTable.getExtent:: extent was not projected."));f.reject(a)})));return f},_onRefreshComplete:function(a){if(a.grid._clickShowSelectedRecords){var b=this.selectionRows;
A.forEach(b,v.hitch(this,function(b){a.grid.select(b)}));a.grid._clickShowSelectedRecords=!1;this.isSupportQueryToServer()?this._queryFeaturesByIds(b,"selectall"):this.isSupportQueryOnClient()&&this.selectFeatures("selectall",this.getGraphicsFromLocalFeatureLayer(b))}},_zoomToSelected:function(){if(this.configedInfo&&this.tableCreated){var a=this._getSelectedIds();0!==a.length&&(this.isSupportQueryToServer()?this._queryFeaturesByIds(a,"zoom"):this.isSupportQueryOnClient()&&this.selectFeatures("zoom",
this.getGraphicsFromLocalFeatureLayer(a)))}},_queryFeaturesByIds:function(a,b){var f=new z;f.objectIds=a;f.returnGeometry=!0;f.outSpatialReference=v.clone(this.map.spatialReference);f.outFields=["*"];var c=this.layer,n="esri.layers.CSVLayer"===c.declaredClass;c.url&&!n?(new y(c.url)).execute(f,v.hitch(this,function(a){this.selectFeatures(b,a.features)}),v.hitch(this,this._errorSelectFeatures)):c.selectFeatures(f,x.SELECTION_NEW,v.hitch(this,this.selectFeatures,b),v.hitch(this,this._errorSelectFeatures))},
_onRowClick:function(){var a=this._getSelectedIds();this.selectionRows=a;this._closePopup();a.length&&!this.layerInfo.isTable?this.isSupportQueryToServer()?this._queryFeaturesByIds(a,"rowclick"):this.isSupportQueryOnClient()&&this.selectFeatures("rowclick",this.getGraphicsFromLocalFeatureLayer(a)):this.graphicsLayer.clear();this.setSelectedNumber();this.emit("row-click",{table:this,selectedIds:a})},_onExtentChange:function(a){this.matchingMap&&(this.actived&&this.layerInfo&&!this.layerInfo.isTable)&&
this.startQuery(a.extent)},_getLayerFilterExpression:function(){var a=this._filterObj&&this._filterObj.expr||"",b=this.layerInfo.getFilterOfWebmap();return a?b?a+" AND "+b:a:b?b:"1\x3d1"},_getOutFieldsFromLayerInfos:function(b){var f=this.configedInfo.layer.fields,c=[];f&&A.forEach(f,v.hitch(this,function(f){a.isDefined(f.show)||(f.show=!0);if(f.name===b&&("esriFieldTypeOID"===f.type||"esriFieldTypeInteger"===f.type||!f.type))f._pk=!0;(f.show||f._pk)&&c.push(f)}));return c},_processExecuteFields:function(a,
b){if(a&&0<a.length){var f=[];if(!b.length)return a;for(var c=0,n=b.length;c<n;c++)for(var d=0;d<a.length;d++)if(b[c].name===a[d].name&&(b[c].type===a[d].type||!b[c].type))a[d]=v.mixin(a[d],b[c]),f.push(a[d]);return f}return b},_getSelectedIds:function(){var a=[],b=this.grid.selection,f;for(f in b)b[f]&&(isFinite(f)?a.push(parseInt(f,10)):a.push(f));return a},_errorSelectFeatures:function(a){console.error(a)},_popupMessage:function(a){var b=new t({message:a,buttons:[{label:this.nls.ok,onClick:v.hitch(this,
function(){b.close()})}]});this.loading.hide()}})})},"dgrid/extensions/ColumnHider":function(){define("dojo/_base/declare dojo/has dojo/on ../util/misc put-selector/put dojo/i18n!./nls/columnHider xstyle/css!../css/extensions/ColumnHider.css".split(" "),function(k,e,q,t,p,g){var m,u,h=e("ie"),d=h&&e("quirks"),s=8>h||d?"htmlFor":"for";return k("dgrid.extensions.ColumnHider",null,{hiderMenuNode:null,hiderToggleNode:null,i18nColumnHider:g,_hiderMenuOpened:!1,_columnHiderRules:null,_columnHiderCheckboxes:null,
_renderHiderMenuEntries:function(){var c=this.subRows,d=!0,b,a,n,f;delete this._columnHiderFirstCheckbox;n=0;for(b=c.length;n<b;n++){f=0;for(a=c[n].length;f<a;f++)this._renderHiderMenuEntry(c[n][f]),d&&(d=!1,this._columnHiderFirstCheckbox=this._columnHiderCheckboxes[c[n][f].id])}},_renderHiderMenuEntry:function(c){var d=c.id,b=t.escapeCssIdentifier(d,"-"),a,n;c.hidden&&(c.hidden=!1,this._hideColumn(d),c.hidden=!0);c.unhidable||(a=p("div.dgrid-hider-menu-row"),n=this.domNode.id+"-hider-menu-check-"+
b,d=this._columnHiderCheckboxes[d]=p(a,"input.dgrid-hider-menu-check.hider-menu-check-"+b+"[type\x3dcheckbox]"),d.id=n,p(a,"label.dgrid-hider-menu-label.hider-menu-label-"+b+"["+s+"\x3d"+n+"]",c.label||c.field||""),p(this.hiderMenuNode,a),c.hidden||(d.checked=!0))},renderHeader:function(){function c(a){a.stopPropagation()}var e=this,b=this.hiderMenuNode,a=this.hiderToggleNode,n;this.inherited(arguments);if(b){for(n in this._columnHiderRules)this._columnHiderRules[n].remove();b.innerHTML=""}else a=
this.hiderToggleNode=p(this.domNode,"button.ui-icon.dgrid-hider-toggle[type\x3dbutton][aria-label\x3d"+this.i18nColumnHider.popupTriggerLabel+"]"),this._listeners.push(q(a,"click",function(a){e._toggleColumnHiderMenu(a)})),b=this.hiderMenuNode=p("div.dgrid-hider-menu[role\x3ddialog][aria-label\x3d"+this.i18nColumnHider.popupLabel+"]"),b.id=this.id+"-hider-menu",this._listeners.push(q(b,"keyup",function(b){if(27===(b.charCode||b.keyCode))e._toggleColumnHiderMenu(b),a.focus()})),b.style.display="none",
p(this.domNode,b),this._listeners.push(q(b,".dgrid-hider-menu-check:"+(9>h||d?"click":"change"),function(a){e._updateColumnHiddenState(a.target.id.substr(e.id.length+18),!a.target.checked)})),this._listeners.push(q(b,"mousedown",c),q(a,"mousedown",c)),u||(u=q.pausable(document,"mousedown",function(a){m&&m._toggleColumnHiderMenu(a)}),u.pause());this._columnHiderCheckboxes={};this._columnHiderRules={};this._renderHiderMenuEntries()},destroy:function(){this.inherited(arguments);for(var c in this._columnHiderRules)this._columnHiderRules[c].remove()},
left:function(c,d){return this.right(c,-d)},right:function(c,d){c.element||(c=this.cell(c));for(var b=this.inherited(arguments),a=c;b.column.hidden;){b=this.inherited(arguments,[b,0<d?1:-1]);if(a.element===b.element)return c;a=b}return b},isColumnHidden:function(c){return!!this._columnHiderRules[c]},_toggleColumnHiderMenu:function(){var c=this._hiderMenuOpened,d=this.hiderMenuNode,b=this.domNode,a;d.style.display=c?"none":"";c?d.style.height="":(d.offsetHeight>b.offsetHeight-12&&(d.style.height=b.offsetHeight-
12+"px"),(a=this._columnHiderFirstCheckbox)&&a.focus());u[c?"pause":"resume"]();m=c?null:this;this._hiderMenuOpened=!c},_hideColumn:function(c){var d=this,b="#"+t.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-",a;if(!this._columnHiderRules[c]&&(this._columnHiderRules[c]=t.addCssRule(b+t.escapeCssIdentifier(c,"-"),"display: none;"),(8===e("ie")||10===e("ie"))&&!e("quirks")))a=t.addCssRule(".dgrid-row-table","display: inline-table;"),window.setTimeout(function(){a.remove();d.resize()},0)},_showColumn:function(c){this._columnHiderRules[c]&&
(this._columnHiderRules[c].remove(),delete this._columnHiderRules[c])},_updateColumnHiddenState:function(c,d){this[d?"_hideColumn":"_showColumn"](c);this.columns[c].hidden=d;q.emit(this.domNode,"dgrid-columnstatechange",{grid:this,column:this.columns[c],hidden:d,bubbles:!0});this.resize()},toggleColumnHiddenState:function(c,d){"undefined"===typeof d&&(d=!this._columnHiderRules[c]);this._updateColumnHiddenState(c,d);this._columnHiderCheckboxes[c].checked=!d}})})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-geometry dojo/has ../util/misc put-selector/put dojo/_base/html xstyle/css!../css/extensions/ColumnResizer.css".split(" "),
function(k,e,q,t,p,g,m,u,h){function d(a){for(var b=a.length,f=b,c=a[0].length,d=Array(b);b--;)d[b]=Array(c);for(var e={},b=0;b<f;b++)for(var l=d[b],h=a[b],w=0,m=0;w<c;w++){var g=h[m],s;if("undefined"==typeof l[w]){l[w]=g.id;if(g.rowSpan&&1<g.rowSpan){s=d;for(var k=g.rowSpan,p=b,u=w,q=g.id,t=1;t<k;t++)s[p+t][u]=q}if(0<b&&g.colSpan&&1<g.colSpan)for(s=1;s<g.colSpan;s++)if(l[++w]=g.id,g.rowSpan&&1<g.rowSpan)for(var k=d,p=g.rowSpan,u=b,q=w,t=g.id,v=1;v<p;v++)k[u+v][q]=t;e[g.id]=a[0][w].id;m++}}return e}
function s(a,b,f,c,d){if(!(0>=f)){var l=a.columns[b],h;if(l&&(h={grid:a,columnId:b,width:f,bubbles:!0,cancelable:!0},c&&(h.parentType=c),!a._resizedColumns||e.emit(a.headerNode,"dgrid-columnresize",h)))return"auto"===f?delete l.width:(l.width=f,f+="px"),(c=a._columnSizes[b])?c.set("width",f):c=u.addCssRule("#"+u.escapeCssIdentifier(a.domNode.id)+" .dgrid-column-"+u.escapeCssIdentifier(b,"-"),"width: "+f+";"),a._columnSizes[b]=c,!1!==d&&a.resize(),!0}}var c,l=0,b={create:function(){c=h("div.dgrid-column-resizer")},
destroy:function(){h(c,"!");c=null},show:function(a){a=g.position(a.domNode,!0);c.style.top=a.y+"px";c.style.height=a.h+"px";h(document.body,c)},move:function(a){c.style.left=a+"px"},hide:function(){c.parentNode.removeChild(c)}};return k("dgrid.extensions.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);l++||b.create()},destroy:function(){this.inherited(arguments);for(var a in this._columnSizes)this._columnSizes[a].remove();
--l||b.destroy()},resizeColumnWidth:function(a,b){return s(this,a,b)},configStructure:function(){var a=this._oldColumnSizes=t.mixin({},this._columnSizes),b;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);for(b in a)b in this._columnSizes||a[b].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var b=a.id,f;"width"in a&&((f=this._oldColumnSizes[b])?f.set("width",a.width+"px"):f=u.addCssRule("#"+u.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+
u.escapeCssIdentifier(b,"-"),"width: "+a.width+"px;"),this._columnSizes[b]=f)},renderHeader:function(){this.inherited(arguments);var a=this,b;if(this.columnSets&&this.columnSets.length)for(var f=this.columnSets.length;f--;)b=t.mixin(b||{},d(this.columnSets[f]));else this.subRows&&1<this.subRows.length&&(b=d(this.subRows));for(var f=q(".dgrid-cell",a.headerNode),c=f.length;c--;){var l=f[c],y=l.columnId,g=a.columns[y],s=l.childNodes;if(g&&!1!==g.resizable){g=h("div.dgrid-resize-header-container");for(l.contents=
g;0<s.length;)h(g,s[0]);l=h(l,g,"div.dgrid-resize-handle.resizeNode-"+u.escapeCssIdentifier(y,"-"));l.columnId=b&&b[y]||y}}a.mouseMoveListen||(e(a.headerNode,".dgrid-resize-handle:mousedown"+(m("touch")?",.dgrid-resize-handle:touchstart":""),function(b){a._resizeMouseDown(b,this);a.mouseMoveListen.resume();a.mouseUpListen.resume()}),a._listeners.push(a.mouseMoveListen=e.pausable(document,"mousemove"+(m("touch")?",touchmove":""),u.throttleDelayed(function(b){a._updateResizerPosition(b)}))),a._listeners.push(a.mouseUpListen=
e.pausable(document,"mouseup"+(m("touch")?",touchend":""),function(b){a._resizeMouseUp(b);a.mouseMoveListen.pause();a.mouseUpListen.pause()})),a.mouseMoveListen.pause(),a.mouseUpListen.pause())},_resizeMouseDown:function(a,c){a.preventDefault();p.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(a);this._targetCell=q(".dgrid-column-"+u.escapeCssIdentifier(c.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(a);b.show(this)},_resizeMouseUp:function(a){var c=this._columnSizes,
f,d,e;this.adjustLastColumn&&(e=this.headerNode.clientWidth-1);this._resizedColumns||(f=q(".dgrid-cell",this.headerNode),this.columnSets&&this.columnSets.length?f=f.filter(function(a){return"0"==a.columnId.split("-")[0]&&!(a.columnId in c)}):this.subRows&&1<this.subRows.length&&(f=f.filter(function(a){return"0"==a.columnId.charAt(0)&&!(a.columnId in c)})),d=f.map(function(a){return a.offsetWidth}),f.forEach(function(a,b){s(this,a.columnId,d[b],null,!1)},this),this._resizedColumns=!0);p.setSelectable(this.domNode,
!0);f=this._targetCell;var l=this._getResizeMouseLocation(a)-this._startX,h=f.offsetWidth+l,g=this._getResizedColumnWidths(),w=g.totalWidth,g=g.lastColId,m=q(".dgrid-column-"+u.escapeCssIdentifier(g,"-"),this.headerNode)[0].offsetWidth;h<this.minWidth&&(h=this.minWidth);s(this,f.columnId,h,a.type)&&f.columnId!=g&&this.adjustLastColumn&&(w+l<e?s(this,g,"auto",a.type):m-l<=this.minWidth&&s(this,g,this.minWidth,a.type));b.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(a){if(this._targetCell){a=
this._getResizeMouseLocation(a);var c=this._targetCell.offsetWidth,f=a;c+(a-this._startX)<this.minWidth&&(f=this._startX-(c-this.minWidth));b.move(f)}},_getResizeMouseLocation:function(a){var b=0;a.pageX?b=a.pageX:a.clientX&&(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return b},_getResizedColumnWidths:function(){var a=0,b=q((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),f=b.length;if(!f)return{};for(var c=b[f-1].columnId;f--;)a+=
b[f].offsetWidth;return{totalWidth:a,lastColId:c}}})})},"dgrid/extensions/ColumnReorder":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/on dojo/query dojo/dnd/Source put-selector/put xstyle/css!../css/extensions/ColumnReorder.css".split(" "),function(k,e,q,t,p,g,m){function u(c,d){var b=d[2],a=c[b?"columnSets":"subRows"][d[1]];return b?a[d[2]]:a}function h(c,d,b){d[2]?c.columnSets[d[1]][d[2]]=b:c.subRows[d[1]]=b}function d(c,d){return d.slice(("dgrid-"+c+"-").length)}
var s=/(\d+)(?:-(\d+))?$/;k=e(g,{copyState:function(){return!1},checkAcceptance:function(c,d){return c==this},_legalMouseDown:function(c){return-1<c.target.className.indexOf("dgrid-resize-handle")?!1:this.inherited(arguments)},onDropInternal:function(c){var e=this.grid,b=s.exec(d(e.id,c[0].getAttribute("dndType"))),a=b[2]?"columnSets":"subRows",n=u(e,b),f=e.columns;this.inherited(arguments);b&&setTimeout(function(){var d=q.map(c[0].parentNode.childNodes,function(a){return f[a.columnId]});h(e,b,d);
d={grid:e,subRow:d,column:f[c[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"};d[a]=e[a];t.emit(e.domNode,"dgrid-columnreorder",d)?e.set(a,e[a]):(h(e,b,n),e.renderHeader(),this._sort&&this._sort.length&&this.updateSortArrow(this._sort))},0)}});e=e("dgrid.extensions.ColumnReorder",null,{columnDndConstructor:k,_initSubRowDnd:function(c,d){var b,a,e,f;a=0;for(e=c.length;a<e;a++)f=c[a],!1!==f.reorderable&&(f=f.headerNode,"TH"!=f.tagName&&(f=f.parentNode),m(f,".dojoDndItem[dndType\x3d"+d+"]"),b||
(b=f.parentNode));b&&this._columnDndSources.push(new this.columnDndConstructor(b,{horizontal:!0,grid:this}))},renderHeader:function(){var c="dgrid-"+this.id+"-",d,b;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets){b=0;for(d=this.columnSets.length;b<d;b++)q.forEach(this.columnSets[b],function(a,d){this._initSubRowDnd(a,c+b+"-"+d)},this)}else q.forEach(this.subRows,function(a,b){this._initSubRowDnd(a,c+b)},this)},_destroyColumns:function(){this._columnDndSources&&q.forEach(this._columnDndSources,
function(c){c.destroy()});this.inherited(arguments)}});e.ColumnDndSource=k;return e})},"esri/tasks/RelationParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),function(k,e,q,t,p,g,m){k=k(null,{declaredClass:"esri.tasks.RelationParameters",geometries1:null,geometries2:null,relation:null,relationParam:null,toJson:function(){var e=q.map(this.geometries1,function(c){return c.toJson()}),h=q.map(this.geometries2,
function(c){return c.toJson()}),d={},g=this.geometries1;g&&0<g.length&&(d.geometries1=t.toJson({geometryType:m.getJsonType(g[0]),geometries:e}),e=this.geometries1[0].spatialReference,d.sr=e.wkid?e.wkid:t.toJson(e.toJson()));if((e=this.geometries2)&&0<e.length)d.geometries2=t.toJson({geometryType:m.getJsonType(e[0]),geometries:h});this.relation&&(d.relation=this.relation);this.relationParam&&(d.relationParam=this.relationParam);return d}});e.mixin(k,{SPATIAL_REL_CROSS:"esriGeometryRelationCross",SPATIAL_REL_DISJOINT:"esriGeometryRelationDisjoint",
SPATIAL_REL_IN:"esriGeometryRelationIn",SPATIAL_REL_INTERIORINTERSECTION:"esriGeometryRelationInteriorIntersection",SPATIAL_REL_INTERSECTION:"esriGeometryRelationIntersection",SPATIAL_REL_COINCIDENCE:"esriGeometryRelationLineCoincidence",SPATIAL_REL_LINETOUCH:"esriGeometryRelationLineTouch",SPATIAL_REL_OVERLAP:"esriGeometryRelationOverlap",SPATIAL_REL_POINTTOUCH:"esriGeometryRelationPointTouch",SPATIAL_REL_TOUCH:"esriGeometryRelationTouch",SPATIAL_REL_WITHIN:"esriGeometryRelationWithin",SPATIAL_REL_RELATION:"esriGeometryRelationRelation"});
return k})},"jimu/CSVUtils":function(){define("exports dojo/_base/lang dojo/_base/array dojo/_base/html dojo/has dojo/Deferred jimu/utils esri/lang esri/tasks/QueryTask esri/tasks/query".split(" "),function(k,e,q,t,p,g,m,u,h,d){k.exportCSV=function(d,c,e){return k._createCSVStr(c,e).then(function(b){return k._download(d+".csv",b)})};k.exportCSVFromFeatureLayer=function(d,c,e){e=e||{};return k._getExportData(c,{datas:e.datas,fromClient:e.fromClient,outFields:e.outFields,filterExpression:e.filterExpression}).then(function(b){return k._formattedData(c,
b,{formatNumber:e.formatNumber,formatDate:e.formatDate,formatCodedValue:e.formatCodedValue,popupInfo:e.popupInfo}).then(function(a){return k.exportCSV(d,a.datas,a.columns)})})};k.exportCSVByAttributes=function(d,c,h,b){b=e.mixin({},b);b.datas=h;return k.exportCSVFromFeatureLayer(d,c,b)};k.exportCSVByGraphics=function(d,c,e,b){e=q.map(e,function(a){return a.attributes});return k.exportCSVByAttributes(d,c,e,b)};k._createCSVStr=function(d,c){var e=new g,b="",a=0,n=0,f="",r="";try{q.forEach(c,function(a){b=
b+f+a;f=","});for(var b=b+"\r\n",a=d.length,n=c.length,h=0;h<a;h++){for(var f="",y=0;y<n;y++)r=d[h][c[y]],!r&&"number"!==typeof r&&(r=""),r&&/[",\r\n]/g.test(r)&&(r='"'+r.replace(/(")/g,'""')+'"'),b=b+f+r,f=",";b+="\r\n"}e.resolve(b)}catch(m){console.error(m),e.resolve("")}return e};k._isIE11=function(){return 11===m.has("ie")};k._isEdge=function(){return m.has("edge")};k._getDownloadUrl=function(d){return window.Blob&&window.URL&&window.URL.createObjectURL?(d=new Blob(["\ufeff"+d],{type:"text/csv"}),
URL.createObjectURL(d)):"data:attachment/csv;charset\x3dutf-8,\ufeff"+encodeURIComponent(d)};k._download=function(d,c){var e=new g;try{if(p("ie")&&10>p("ie")){var b=window.top.open("about:blank","_blank");b.document.write("sep\x3d,\r\n"+c);b.document.close();b.document.execCommand("SaveAs",!0,d);b.close()}else if(10===p("ie")||k._isIE11()||k._isEdge()){var a=new Blob(["\ufeff"+c],{type:"text/csv"});navigator.msSaveBlob(a,d)}else{var n=t.create("a",{href:k._getDownloadUrl(c),target:"_blank",download:d},
document.body);if(p("safari")){var f=document.createEvent("MouseEvents");f.initEvent("click",!0,!0);n.dispatchEvent(f)}else n.click();t.destroy(n)}e.resolve()}catch(r){e.reject(r)}return e};k._getExportData=function(d,c){var e=new g,b=null,a=c.datas,b=c.outFields;if(!b||!b.length)b=d.fields;a&&0<a.length?e.resolve({data:a||[],outFields:b}):c.fromClient?(a=q.map(d.graphics,function(a){return a.attributes}),e.resolve({data:a||[],outFields:b})):k._getExportDataFromServer(d,b,c).then(function(a){e.resolve({data:a||
[],outFields:b})});return e};k._getExportDataFromServer=function(e,c,m){var b=new g;if("esri.layers.FeatureLayer"!==e.declaredClass)return b.resolve([]),b;var a=new h(e.url),n=new d;n.where=m.filterExpression||e.getDefinitionExpression&&e.getDefinitionExpression()||"1\x3d1";0<c.length?(e=q.map(c,function(a){return a.name}),n.outFields=e):n.outFields=["*"];n.returnGeometry=!1;a.execute(n,function(a){a=q.map(a.features,function(a){return a.attributes});b.resolve(a)},function(a){console.error(a);b.resolve([])});
return b};k._formattedData=function(d,c,e){var b=new g,a=[],n=c.data;c=c.outFields;for(var f=0,r=n.length;f<r;f++){for(var h={},y=0;y<c.length;y++){var m=c[y];h[m.alias||m.name]=k._getExportValue(n[f][m.name],m,d.objectIdField,d.typeIdField,n[f][d.typeIdField],d.types,e)}a.push(h)}d=q.map(c,function(a){return a.alias||a.name});b.resolve({datas:a,columns:d});return b};k._getExportValue=function(d,c,e,b,a,n,f){function r(a){if(h&&u.isDefined(h.fieldInfos))for(var b=0,f=h.fieldInfos.length;b<f;b++){var c=
h.fieldInfos[b];if(c.fieldName===a)return c.format}return null}var h=f.popupInfo,g=!!c.domain&&f.formatCodedValue;f="esriFieldTypeDate"===c.type&&f.formatDate;var k=e&&c.name===e;b=b&&c.name===b;return f?m.fieldFormatter.getFormattedDate(d,r(c.name)):b?m.fieldFormatter.getTypeName(d,n):g?m.fieldFormatter.getCodedValue(c.domain,d):!g&&!f&&!k&&!b?(g=null,e&&n&&0<n.length&&(e=(e=q.filter(n,function(b){return b.id===a}))&&e[0])&&(e.domains&&e.domains[c.name]&&e.domains[c.name].codedValues)&&(g=m.fieldFormatter.getFormattedCodedValue(e.domains[c.name],
d)),null!==g?g:d):d}})},"widgets/AttributeTable/utils":function(){define("dojo/_base/lang dojo/_base/array jimu/LayerInfos/LayerInfos dojo/Deferred dojo/promise/all exports dojo/store/Observable dojo/store/Cache dojo/store/Memory esri/lang ./FeatureLayerQueryStore jimu/utils".split(" "),function(k,e,q,t,p,g,m,u,h,d,s,c){function l(a){var b=[],f=[];e.forEach(a,function(c){var d=b.indexOf(c.name);0>d?b.push(c.name):(f.push(a[d]),f.push(c))});e.forEach(f,function(a){a.name=a.name+"-"+a.id})}function b(a,
b){if(!a||!a.length)return b||[];if(!b||!b.length)return a;for(var f=[],c=0,d=a.length;c<d;c++)for(var e=a[c],h=0,g=b.length;h<g;h++)if(b[h].name===e.name){f.push(e);break}return f}g.readLayerInfosObj=function(a){return q.getInstance(a,a.itemInfo)};g.readLayerInfosFromMap=function(a,b,f){var c=new t;q.getInstance(a,a.itemInfo).then(k.hitch(this,function(a){var d=[];b?a.traversalLayerInfosOfWebmap(function(a){d.push(a)}):a.traversal(function(a){d.push(a)});if(f){var h=[],g=a.getMapNotesLayerInfoArray();
e.forEach(g,function(a){h.push(a.id);a.traversal(function(a){h.push(a.id)})});d=e.filter(d,function(a){return-1===h.indexOf(a.id)})}a=a.getTableInfoArray();d=d.concat(a);c.resolve(d)}),k.hitch(this,function(a){console.error(a);c.reject(a)}));return c.promise};g.generateColumnsFromFields=function(a,b,f,c,h){function m(b){if(a&&d.isDefined(a.fieldInfos))for(var f=0,c=a.fieldInfos.length;f<c;f++){var e=a.fieldInfos[f];if(e.fieldName===b)return e.format}return null}var l={};e.forEach(b,k.hitch(g,function(a,
b,n){var p="field"+b,C=!!a.domain,u="esriFieldTypeDate"===a.type,s=f&&a.name===f;l[p]={label:a.alias||a.name,className:p,hidden:1===n.length?!1:!a.show&&d.isDefined(a.show),unhidable:1===n.length?!1:!a.show&&d.isDefined(a.show)&&a._pk,field:a.name};l[p].sortable=!!h;if("esriFieldTypeString"===n[b].type)l[p].formatter=k.hitch(g,g.urlFormatter);else if("esriFieldTypeDate"===n[b].type)l[p].formatter=k.hitch(g,g.dateFormatter,m(a.name));else if("esriFieldTypeDouble"===n[b].type||"esriFieldTypeSingle"===
n[b].type||"esriFieldTypeInteger"===n[b].type||"esriFieldTypeSmallInteger"===n[b].type)l[p].formatter=k.hitch(g,g.numberFormatter,m(a.name));C?l[p].get=k.hitch(g,function(a,b){return this.getCodeValue(a.domain,b[a.name])},a):s?l[p].get=k.hitch(g,function(a,b,f){return this.getTypeName(f[a.name],b)},a,c):!C&&(!u&&!s)&&(l[p].get=k.hitch(g,function(a,b,f,c){var d=null;b&&f&&0<f.length&&(f=(f=e.filter(f,k.hitch(g,function(a){return a.name===c[b]})))&&f[0]||null)&&(f.domains&&f.domains[a.name]&&f.domains[a.name].codedValues)&&
(d=this.getCodeValue(f.domains[a.name],c[a.name]));return(a=null!==d?d:c[a.name])||isFinite(a)?a:""},a,f,c))}));return l};g.getTypeName=function(a,b){return c.fieldFormatter.getTypeName(a,b)};g.getCodeValue=function(a,b){return c.fieldFormatter.getCodedValue(a,b)};g.urlFormatter=function(a){return c.fieldFormatter.getFormattedUrl(a)};g.dateFormatter=function(a,b){return c.fieldFormatter.getFormattedDate(b,a)};g.numberFormatter=function(a,b){return c.fieldFormatter.getFormattedNumber(b,a)};g.readLayerObjectsFromMap=
function(a,b,f){var c=new t,d=[];this.readLayerInfosFromMap(a,b,f).then(k.hitch(this,function(a){e.forEach(a,k.hitch(this,function(a){d.push(a.getLayerObject())}));p(d).then(k.hitch(this,function(a){c.resolve(a)}),k.hitch(this,function(a){c.reject(a);console.error(a)}))}),k.hitch(this,function(a){c.reject(a)}));return c.promise};g.readSupportTableInfoFromLayerInfos=function(a){var b=new t,f=[];e.forEach(a,k.hitch(this,function(a){f.push(a.getSupportTableInfo())}));p(f).then(k.hitch(this,function(f){f=
k.clone(f);e.forEach(f,function(b,f){b.id=a[f].id});b.resolve(f)}),function(a){b.reject(a)});return b.promise};g.readConfigLayerInfosFromMap=function(a,b,f){var c=new t,d=[];this.readLayerInfosFromMap(a,b,f).then(k.hitch(this,function(a){var b=[];e.forEach(a,function(a){d.push(a.getSupportTableInfo())});p(d).then(k.hitch(this,function(f){e.forEach(f,k.hitch(this,function(f,c){f.isSupportedLayer&&(a[c].name=a[c].title,b.push(a[c]))}));l(b);c.resolve(b)}),k.hitch(this,function(a){c.reject(a)}))}),k.hitch(this,
function(a){c.reject(a)}));return c.promise};g.getConfigInfosFromLayerInfos=function(a){return e.map(a,function(a){return g.getConfigInfoFromLayerInfo(a)})};g.getConfigInfoFromLayerInfo=function(a){var c={};c.name=a.name||a.title;c.id=a.id;c.show=a.isShowInMap();c.layer={url:a.getUrl()};var f=a.getPopupInfo();f&&!f.description&&(c.layer.fields=e.map(f.fieldInfos,function(a){return{name:a.fieldName,alias:a.label,show:a.visible,format:a.format}}),a=k.getObject("layerObject.fields",!1,a),c.layer.fields=
b(c.layer.fields,a),e.some(c.layer.fields,function(a){return a.show})||(c.layer.fields[0].show=!0));return c};g.generateCacheStore=function(a,b,f,c,d){a=new s({layer:a,objectIds:a._objectIds||null,totalCount:b,batchCount:f,where:c||"1\x3d1",spatialFilter:d});b=new h;return new u(a,b,{})};g.generateMemoryStore=function(a,b){return new m(new h({data:a||[],idProperty:b}))};g.merge=function(a,b,f,c){for(var d=e.map(b,function(a){return a[f]}),h=0,g=a.length;h<g;h++){var m=d.indexOf(a[h][f]);-1<m&&c(a[h],
b[m])}};g.syncOrderWith=function(a,b,f){function c(a,b){return e.map(a,function(a){return a[b]})}if(!k.isArray(b)||!f)return a;for(var d=c(a,f),h=[],g=0,m=b.length;g<m;g++){var w=d.indexOf(b[g][f]);-1<w&&(h=h.concat(a.splice(w,1)),d=c(a,f))}return h.concat(a)}})},"dojo/store/Observable":function(){define(["../_base/kernel","../_base/lang","../when","../_base/array"],function(k,e,q,t){k=function(k){function g(e,c){var h=k[e];h&&(k[e]=function(b){var a;"put"===e&&(a=k.getIdentity(b));if(d)return h.apply(this,
arguments);d=!0;try{var g=h.apply(this,arguments);q(g,function(f){c("object"==typeof f&&f||b,a)});return g}finally{d=!1}})}var m=[],u=0;k=e.delegate(k);k.notify=function(d,c){u++;for(var e=m.slice(),b=0,a=e.length;b<a;b++)e[b](d,c)};var h=k.query;k.query=function(d,c){c=c||{};var g=h.apply(this,arguments);if(g&&g.forEach){var b=e.mixin({},c);delete b.start;delete b.count;var a=k.queryEngine&&k.queryEngine(d,b),n=u,f=[],r;g.observe=function(b,d){1==f.push(b)&&m.push(r=function(b,e){q(g,function(h){var g=
h.length!=c.count,r,m;if(++n!=u)throw Error("Query is out of date, you must observe() the query prior to any data modifications");var l,x=-1,s=-1;if(void 0!==e){r=0;for(m=h.length;r<m;r++){var q=h[r];if(k.getIdentity(q)==e){l=q;x=r;(a||!b)&&h.splice(r,1);break}}}if(a){if(b&&(a.matches?a.matches(b):a([b]).length))r=-1<x?x:h.length,h.splice(r,0,b),s=t.indexOf(a(h),b),h.splice(r,1),c.start&&0==s||!g&&s==h.length?s=-1:h.splice(s,0,b)}else b&&(void 0!==e?s=x:c.start||(s=k.defaultIndex||0,h.splice(s,0,
b)));if((-1<x||-1<s)&&(d||!a||x!=s)){g=f.slice();for(r=0;h=g[r];r++)h(b||l,x,s)}})});var e={};e.remove=e.cancel=function(){var a=t.indexOf(f,b);-1<a&&(f.splice(a,1),f.length||m.splice(t.indexOf(m,r),1))};return e}}return g};var d;g("put",function(d,c){k.notify(d,c)});g("add",function(d){k.notify(d)});g("remove",function(d){k.notify(void 0,d)});return k};e.setObject("dojo.store.Observable",k);return k})},"dojo/store/Cache":function(){define(["../_base/lang","../when"],function(k,e){var q=function(q,
p,g){g=g||{};return k.delegate(q,{query:function(e,k){var h=q.query(e,k);h.forEach(function(d){(!g.isLoaded||g.isLoaded(d))&&p.put(d)});return h},queryEngine:q.queryEngine||p.queryEngine,get:function(g,k){return e(p.get(g),function(h){return h||e(q.get(g,k),function(d){d&&p.put(d,{id:g});return d})})},add:function(g,k){return e(q.add(g,k),function(e){p.add(e&&"object"==typeof e?e:g,k);return e})},put:function(g,k){p.remove(k&&k.id||this.getIdentity(g));return e(q.put(g,k),function(e){p.put(e&&"object"==
typeof e?e:g,k);return e})},remove:function(g,k){return e(q.remove(g,k),function(e){return p.remove(g,k)})},evict:function(e){return p.remove(e)}})};k.setObject("dojo.store.Cache",q);return q})},"widgets/AttributeTable/FeatureLayerQueryStore":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array esri/tasks/query esri/tasks/QueryTask ./FeatureLayerQueryResult".split(" "),function(k,e,q,t,p,g){return k(null,{queryUrl:"",idProperty:"id",data:null,_entityData:null,constructor:function(e){k.safeMixin(this,
e);this.data=[];this._entityData=[];this.layer=e.layer;this.objectIds=e.objectIds;this.where=e.where;this.orderByFields=e.orderByFields;this.totalCount=e.totalCount;this.batchCount=e.batchCount||25;this.idProperty=this.layer.objectIdField;this.spatialFilter=e.spatialFilter;this.layer&&this.layer.url&&(this.queryTask=new p(this.layer.url))},get:function(e){return this.data[e]},getIdentity:function(e){return e[this.idProperty]},query:function(k,p){var h=new t,d=p&&p.start||0,s=this.batchCount,c=null;
"function"===typeof k?c=k(this._entityData):"[object Array]"===Object.prototype.toString.call(k)&&(c=k);if(this.objectIds)c=c?c:this.objectIds,h.objectIds=c.length>=d+this.batchCount?c.slice(d,d+s):c.slice(d);else if(c&&0<c.length?h.objectIds=c.length>=d+this.batchCount?c.slice(d,d+s):c.slice(d):(h.start=d,h.num=s,h.where=this.where,h.geometry=this.spatialFilter,h.spatialRelationship=t.SPATIAL_REL_INTERSECTS),(d=p.sort)&&0<d.length)d=q.map(d,function(b){return b.attribute+" "+(b.descending?"DESC":
"ASC")}),h.orderByFields=d;h.returnGeometry=!1;h.outFields=["*"];var l=this.totalCount,d=null,d=!h.where;if(!(h.objectIds&&0<h.objectIds.length)&&d)return new g([]);d=this.queryTask?this.queryTask.execute(h):this.layer.queryFeatures(h);d.total=d.then(e.hitch(this,function(b){var a=0,c=this.layer.objectIdField;if(this.objectIds){if(!c)for(a=0;a<b.fields.length;a++)if("esriFieldTypeOID"===b.fields[a].type){c=b.fields[a].name;break}for(var f={},a=0;a<b.features.length;a++)f[b.features[a].attributes[c]]=
b.features[a];b.features=q.map(h.objectIds,function(a){return f[a]})}for(a=0;a<b.features.length;a++)b.features[a]&&(b.features[a]=b.features[a].attributes,this.data[b.features[a][c]]=b.features[a],this._entityData.push(b.features[a]));b=b.features;return l}),function(){console.log("FeatureLayerQueryStore queryFeatures failed.");return 0});return new g(d)}})})},"widgets/AttributeTable/FeatureLayerQueryResult":function(){define("esri/main dojo/_base/lang dojo/_base/kernel dojo/_base/Deferred dojo/DeferredList dojo/_base/array".split(" "),
function(k,e,q,t){var p=function(g){function m(e){g[e]||(g[e]=function(){var h=arguments;return t.when(g,function(d){Array.prototype.unshift.call(h,d.features||d);return p(q[e].apply(q,h))})})}if(!g)return g;g.then&&(g=e.delegate(g));g.total||(g.total=t.when(g,function(e){return k._isDefined(e.total)?e.total:e.length||0}));m("forEach");m("filter");m("map");m("some");m("every");return g};return p})},"widgets/AttributeTable/_RelationshipTable":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dgrid/OnDemandGrid dgrid/Selection dgrid/extensions/ColumnHider dgrid/extensions/ColumnResizer dgrid/extensions/ColumnReorder dojo/Evented dojo/store/Memory esri/request esri/tasks/RelationshipQuery esri/lang dojo/_base/lang dojo/on dojo/_base/array dojo/query jimu/dijit/LoadingIndicator jimu/CSVUtils jimu/utils ./utils".split(" "),
function(k,e,q,t,p,g,m,u,h,d,s,c,l,b,a,n,f,r,x,y,z){return k([q,h],{baseClass:"jimu-widget-attributetable-relationship-table",_defaultFeatureCount:2E3,_defaultBatchCount:25,_batchCount:0,_currentDef:null,_requestStatus:"initial",relationship:null,parentWidget:null,footerHeight:25,loading:null,grid:null,footer:null,selectedRowsLabel:null,selectionRows:null,nls:null,actived:!1,showSelected:!1,tableCreated:!1,constructor:function(a){a=a||{};this.set("relationship",a.relationship||null);this.parentWidget=
a.parentWidget||null;this.configedInfo=a.configInfo||null;this.originalInfo=a.originalInfo||null},postCreate:function(){this.selectionRows=[];this.loading=new r;this.loading.placeAt(this.domNode);e.setAttr(this.domNode,"data-originalinfoid",b.getObject("originalInfo.id",!1,this));e.setAttr(this.domNode,"data-configedinfoid",b.getObject("configedInfo.id",!1,this))},showRefreshing:function(a){a?this.loading.show():this.loading.hide()},active:function(){this.actived=!0},deactive:function(){this.actived=
!1},cancelThread:function(){"fulfilled"!==this._requestStatus&&this._currentDef&&(this._currentDef.cancel({canceledBySelf:!0}),this._requestStatus="canceled")},isCanceled:function(){return"canceled"===this._requestStatus},startQuery:function(a){var f=a&&a.layer,d=a&&a.selectedIds,h=this.relationship;f&&h&&d&&0<d.length&&!y.isEqual(this._currentSelectedIds,d)&&b.getObject("originalInfo.layerObject.url",!1,this)?(this.loading.show(),this._requestStatus="processing",b.getObject("relatedTableUrl",!1,
this)||(a=this.originalInfo.layerObject.url.split("/"),a[a.length-1]=this.relationship.relatedTableId,this.relatedTableUrl=a.join("/")),this._currentDef=a=s({url:this.relatedTableUrl,content:{f:"json"},hangleAs:"json",callbackParamName:"callback"}),a.then(b.hitch(this,function(a){if(this.domNode){var g=this.relationship.shipInfo;if(g){var r=this.configedInfo,g=z.getConfigInfoFromLayerInfo(g),r=b.getObject("layer.fields",!1,r)||b.getObject("layer.fields",!1,g);z.merge(a.fields,r,"name",function(a,
f){b.mixin(a,f)});a.fields=z.syncOrderWith(a.fields,r,"name")}var k=[];n.forEach(a.fields,function(b){(!l.isDefined(b.show)||!0===b.show||"esriFieldTypeOID"===b.type||l.isDefined(a.objectIdField)&&b.name===a.objectIdField)&&k.push(b.name)});r=new c;r.objectIds=d;r.outFields=k.length?k:["*"];r.relationshipId=h.id;r.returnGeometry=!1;(this._currentDef=f.queryRelatedFeatures(r,function(a){return a})).then(b.hitch(this,function(b){if(this.domNode){var f={displayFieldName:h.objectIdField,fields:a.fields,
features:[],fieldAliases:null},c;for(c in b){var g=b[c];g.features&&0<g.features.length&&(f.features=f.features.concat(g.features))}0<f.features.length?(this.tableDefinition=a,this.createTable(a,f),this._currentSelectedIds=d,this.emit("data-loaded")):(b=e.toDom("\x3cdiv\x3e"+this.nls.noRelatedRecords+"\x3c/div\x3e"),this._removeTable(),e.empty(this.domNode),e.place(b,this.domNode),e.place(this.loading.domNode,this.domNode));h.opened=!0;this.loading.hide()}}),b.hitch(this,function(a){a&&"Request canceled"!==
a.message&&console.error(a);a=e.toDom("\x3cdiv\x3e"+this.nls.noRelatedRecords+"\x3c/div\x3e");this._removeTable();e.empty(this.domNode);e.place(a,this.domNode);e.place(this.loading.domNode,this.domNode);this.loading.hide()}))}}),b.hitch(this,function(a){a&&"Request canceled"!==a.message&&console.error(a);this.loading.hide()}))):this.loading.hide()},getSelectedRows:function(){if(this.tableCreated)return this.selectionRows},zoomTo:function(){},toggleSelectedRecords:function(){this.tableCreated&&(this.showSelected?
this.showAllSelectedRecords():this.showSelectedRecords(),this.showSelected=!this.showSelected)},showSelectedRecords:function(){if(this.tableCreated){var a=this.relationship.objectIdField;this.grid._clickShowSelectedRecords=!0;var f=this._getSelectedIds();0<f.length&&this.grid&&this.grid.set("query",b.hitch(this,function(b){return"number"===typeof b&&-1<f.indexOf(b)||-1<f.indexOf(b[a])?!0:!1}))}},showAllSelectedRecords:function(){this.tableCreated&&(this.grid.set("query",{}),n.forEach(this.selectionRows,
b.hitch(this,function(a){this.grid.select(a)})),this.setSelectedNumber())},clearSelection:function(a){this.tableCreated&&(this.grid.clearSelection(),this.selectionRows=[],a&&this.grid.set("query",{}),this.setSelectedNumber(),this.showSelected=!1,this.emit("clear-selection"))},refresh:function(){this.grid&&this.grid.clearSelection();this.startQuery()},exportToCSV:function(a){if(this.relationship&&this.tableDefinition&&this.tableCreated){var b=this.grid.__outFields,f=this.getSelectedRowsData(),c={};
f&&0<f.length?c.datas=f:this.grid.store instanceof d&&(f=this.grid.store.data,c.datas=f);c.fromClient=!1;c.outFields=b;c.formatNumber=!1;c.formatDate=!0;c.formatCodedValue=!0;b=this.relationship.shipInfo&&this.relationship.shipInfo.getPopupInfo();c.popupInfo=b;return x.exportCSVFromFeatureLayer(a||this.relationship.name,this.tableDefinition,c)}},toggleColumns:function(){this.grid&&this.grid._toggleColumnHiderMenu()},changeHeight:function(a){this.grid&&0<=a-this.footerHeight&&e.setStyle(this.grid.domNode,
"height",a-this.footerHeight+"px")},destroy:function(){this.destroyed||(this.parentWidget=this.configedInfo=this.layerInfo=null,this.grid&&this.grid.destroy(),this.nls=this.map=null,this.relationship.opened=!1,this.relationship=null,this.inherited(arguments))},createTable:function(c,d){var h=n.map(d.features,b.hitch(this,function(a){return a.attributes})),r=z.generateMemoryStore(h,d.displayFieldName),l=c.typeIdField,x=c.types,y=this.relationship.shipInfo&&this.relationship.shipInfo.getPopupInfo(),
l=z.generateColumnsFromFields(y,d.fields,l,x);this.grid?(this.grid.set("store",r),this.grid.refresh()):(r={columns:l,store:r,keepScrollPosition:!0,pagingDelay:1E3,allowTextSelection:!0},this.grid=new (k([t,p,g,m,u]))(r,e.create("div")),e.empty(this.domNode),e.place(this.grid.domNode,this.domNode),e.place(this.loading.domNode,this.domNode),this.grid.startup(),this.grid.__pk=d.displayFieldName,this.grid.__outFields=d.fields,this.own(a(this.grid,".dgrid-row:click",b.hitch(this,this._onRowClick))));this.getParent()&&
(r=f(".dgrid-scroller",this.grid.domNode)[0],x=f(".dgrid-header",this.grid.domNode)[0],l=e.getComputedStyle(r),x=e.getMarginBox(x),l=parseInt(l.marginTop,10),isFinite(l)&&(x&&l<x.h)&&e.setStyle(r,"marginTop",x.h+"px"));this.footer?e.empty(this.footer):this.footer=e.create("div",null,this.domNode);h=e.create("div",{"class":"dgrid-status self-footer",innerHTML:h.length+"\x26nbsp;"+this.nls.features+"\x26nbsp;"},this.footer);this.selectedRowsLabel=e.create("div",{"class":"dgrid-status self-footer",innerHTML:"0\x26nbsp;"+
this.nls.selected+"\x26nbsp;"},h,"after");h=e.getStyle(this.domNode,"height");this.changeHeight(h);this._requestStatus="fulfilled";this.tableCreated=!0},_removeTable:function(){this.grid&&this.grid.domNode&&(this.grid.destroy(),this.grid=null);this.footer&&(e.destroy(this.footer),this.selectedRowsLabel=this.footer=null)},getSelectedRowsData:function(){if(!this.grid)return null;var a=this.relationship.objectIdField,f=this.grid.store,c=f._entityData||f.data,f=this.getSelectedRows();return n.map(f,b.hitch(this,
function(b){for(var f=0,d=c.length;f<d;f++)if(c[f]&&c[f][a]===b)return c[f];return{}}))||[]},setSelectedNumber:function(){if(this.selectedRowsLabel&&this.grid){var a=this.getSelectedRows();this.selectedRowsLabel.innerHTML="\x26nbsp;\x26nbsp;"+a.length+" "+this.nls.selected+"\x26nbsp;\x26nbsp;"}},_onRowClick:function(){this.selectionRows=this._getSelectedIds();this.setSelectedNumber();this.emit("row-click",{table:this,selectedIds:b.clone(this.selectionRows)})},_getSelectedIds:function(){var a=[],b=
this.grid.selection,f;for(f in b)b[f]&&(isFinite(f)?a.push(parseInt(f,10)):a.push(f));return a}})})},"widgets/AttributeTable/_TableFunctionController":function(){define("dojo/_base/declare dojo/_base/lang dojo/Evented dojo/_base/html dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/Toolbar dijit/form/Button dijit/DropDownMenu dijit/MenuItem dijit/form/ToggleButton dijit/form/DropDownButton jimu/dijit/Popup jimu/dijit/Filter jimu/dijit/Message ./_FeatureTable ./_RelationshipTable".split(" "),
function(k,e,q,t,p,g,m,u,h,d,s,c,l,b,a,n,f,r,x){return k([g,m,u,q],{templateString:"\x3cdiv\x3e\x3c/div\x3e",_handlers:[],_resourceManager:null,zoomButton:null,exportButton:null,selectionMenu:null,refreshButton:null,matchingCheckBox:null,matchingMap:!0,nls:null,postCreate:function(){var a=new h({},t.create("div")),f=new s;this.showSelectedRecords=new c({label:this.nls.showSelectedRecords,iconClass:"esriAttributeTableSelectPageImage",onClick:e.hitch(this,this._showSelectedRecords)});f.addChild(this.showSelectedRecords);
this.showRelatedRecords=new c({label:this.nls.showRelatedRecords,iconClass:"esriAttributeTableSelectAllImage",onClick:e.hitch(this,this._showRelatedRecords)});f.addChild(this.showRelatedRecords);this.filter=new c({label:this.nls.filter,iconClass:"esriAttributeTableFilterImage",onClick:e.hitch(this,this._showFilter)});f.addChild(this.filter);this.columns=new c({label:this.nls.columns,iconClass:"esriAttributeTableColumnsImage",onClick:e.hitch(this,this._toggleColumns)});f.addChild(this.columns);this.hideExportButton||
(this.exportButton=new c({label:this.nls.exportFiles,showLabel:!0,iconClass:"esriAttributeTableExportImage",onClick:e.hitch(this,this._onExportFiles)}),f.addChild(this.exportButton));this.selectionMenu=new b({label:this.nls.options,iconClass:"esriAttributeTableOptionsImage",dropDown:f});a.addChild(this.selectionMenu);this.matchingCheckBox=new l({checked:this.filterByMapExtent?!0:!1,showLabel:!0,label:this.nls.filterByExtent,onChange:e.hitch(this,function(a){this.matchingMap=a;this.activeTable&&(this.activeTable.cancelThread(),
this.activeTable.set("matchingMap",a),this.activeTable.startQuery())})});this.matchingMap=this.filterByMapExtent;a.addChild(this.matchingCheckBox);this.zoomButton=new d({label:this.nls.zoomto,iconClass:"esriAttributeTableZoomImage",onClick:e.hitch(this,this._zoomTo)});a.addChild(this.zoomButton);f=new d({label:this.nls.clearSelection,iconClass:"esriAttributeTableClearImage",onClick:e.hitch(this,this._clearSelection,!1)});a.addChild(f);this.refreshButton=new d({label:this.nls.refresh,showLabel:!0,
iconClass:"esriAttributeTableRefreshImage",onClick:e.hitch(this,this._refresh)});a.addChild(this.refreshButton);this.closeButton=new d({title:this.nls.closeMessage,iconClass:"esriAttributeTableCloseImage",onClick:e.hitch(this,this._onCloseBtnClicked)});t.addClass(this.closeButton.domNode,"close-button");a.addChild(this.closeButton);t.place(a.domNode,this.domNode);a.startup();this.inherited(arguments)},startup:function(){this.resetButtonStatus()},setResourceManager:function(a){this._resourceManager=
a},setMap:function(a){this.map=a},active:function(){this.activeTable&&this.activeTable.active()},deactive:function(){this.activeTable&&this.activeTable.deactive()},setActiveTable:function(a,b){this.activeTable&&(this.activeTable.cancelThread(),this.activeTable.deactive(),this._unbindEvent());if(a){this.activeTable=a;this.activeTable.active();this.activeTable.changeHeight(b.h);if(this.matchingMap||!this.matchingMap&&this.activeTable.matchingMap||!this.activeTable.tableCreated||this.activeTable instanceof
x)this.activeTable.set("matchingMap",this.matchingMap),this.activeTable.startQuery(b);this._bindEvent();this.checkMapInteractiveFeature()}this.resetButtonStatus()},getActiveTable:function(){return this.activeTable},changeHeight:function(a){this.activeTable&&this.activeTable.changeHeight(a)},checkMapInteractiveFeature:function(){if(this.activeTable){var a=this.activeTable,b=this.activeTable.layerInfo;b&&(b.isShowInMap()?(a&&a.showGraphic(),(a=a.getSelectedRows())&&0<a.length?this.zoomButton.set("disabled",
!1):this.zoomButton.set("disabled",!0)):(a&&a.hideGraphic(),this.zoomButton.set("disabled",!0)))}},resetButtonStatus:function(){var a=this.activeTable;if(a){var b=a.getSelectedRows();a.showSelected?this.showSelectedRecords.set("label",this.nls.showAllRecords):this.showSelectedRecords.set("label",this.nls.showSelectedRecords);a.tableCreated&&b&&0<b.length?this.showSelectedRecords.set("disabled",!1):this.showSelectedRecords.set("disabled",!0);this.showRelatedRecords.set("disabled",!0);if(e.getObject("layerInfo",
!1,a)&&a instanceof r&&a.isSupportQueryToServer()&&b&&0<b.length){this._relatedDef&&!this._relatedDef.isFulfilled()&&this._relatedDef.cancel();var f=a.layerInfo.getRelatedTableInfoArray();this._relatedDef=f;f.then(e.hitch(this,function(b){if(this.domNode){var f=a.getSelectedRows();a.tableCreated&&(b&&0<b.length&&f&&0<f.length)&&this.showRelatedRecords.set("disabled",!1)}}))}a.tableCreated&&a instanceof r&&a.isSupportQueryToServer()?this.filter.set("disabled",!1):this.filter.set("disabled",!0);a instanceof
r?this.matchingCheckBox.set("disabled",!1):this.matchingCheckBox.set("disabled",!0);a.tableCreated?this.columns.set("disabled",!1):this.columns.set("disabled",!0);this.hideExportButton||(b&&0<b.length?this.exportButton.set("label",this.nls.exportSelected):this.exportButton.set("label",this.nls.exportAll),a.tableCreated?this.exportButton.set("disabled",!1):this.exportButton.set("disabled",!0));a.tableCreated&&a instanceof r&&b&&0<b.length?a.layerInfo.isShowInMap()?this.zoomButton.set("disabled",!1):
this.zoomButton.set("disabled",!0):this.zoomButton.set("disabled",!0)}else this.showSelectedRecords.set("disabled",!0),this.showRelatedRecords.set("disabled",!0),this.matchingCheckBox.set("disabled",!0),this.filter.set("disabled",!0),this.columns.set("disabled",!0),this.hideExportButton||this.exportButton.set("disabled",!0),this.zoomButton.set("disabled",!0)},destroy:function(){this._unbindEvent();this.nls=this.matchingCheckBox=this.refreshButton=this.selectionMenu=this.exportButton=this.zoomButton=
this.activeTable=null;this._filterPopup&&this._filterPopup.domNode&&(this._filterPopup.close(),this._filterPopup=null);this.inherited(arguments)},_bindEvent:function(){this._handlers.push(p(this.activeTable,"data-loaded",e.hitch(this,"_onTableDataLoaded")));this._handlers.push(p(this.activeTable,"row-click",e.hitch(this,"_onTableRowClick")));this._handlers.push(p(this.activeTable,"clear-selection",e.hitch(this,"_onTableClearSelection")))},_unbindEvent:function(){for(;0<this._handlers.length;){var a=
this._handlers.pop();a&&a.remove&&a.remove()}},_onTableDataLoaded:function(){this.resetButtonStatus()},_onTableRowClick:function(){this.resetButtonStatus();var a=this._resourceManager.featureTableSet,b;for(b in a){var f=a[b];f!==this.activeTable&&f.clearSelection(!1)}},_onTableClearSelection:function(){this.resetButtonStatus()},_showSelectedRecords:function(){this.activeTable&&(this.activeTable.toggleSelectedRecords(),this.activeTable.showSelected?this.showSelectedRecords.set("label",this.nls.showAllRecords):
this.showSelectedRecords.set("label",this.nls.showSelectedRecords));this.emit("show-selected-records",{layerInfoId:e.getObject("layerInfo.id",!1,this.activeTable)?this.activeTable.layerInfo.id:null})},_showRelatedRecords:function(){this.emit("show-related-records",{layerInfoId:e.getObject("layerInfo.id",!1,this.activeTable)?this.activeTable.layerInfo.id:null,objectIds:this.activeTable?this.activeTable.getSelectedRows():null})},_showFilter:function(){this.activeTable&&(this.activeTable.showRefreshing(!0),
this.activeTable.getLayerDefinition().then(e.hitch(this,function(b){if(this.domNode){b=e.clone(b);var c=this.activeTable,d=c.getFilterableFields();b.fields=d;var h=new n({noFilterTip:this.nls.noFilterTip,style:"width:100%;margin-top:22px;"});this._filterPopup=new a({titleLabel:this.nls.filter,width:720,height:485,content:h,buttons:[{label:this.nls.ok,onClick:e.hitch(this,function(){var a=h.toJson();a&&a.expr?(c.setFilterObj(a),c.clearSelection(!1),c.startQuery(),this._filterPopup.close(),this._filterPopup=
null):new f({message:this.nls.setFilterTip})})},{label:this.nls.cancel}]});(d=c.getFilterObj())?h.buildByFilterObj(c.layer.url,d,b):h.buildByExpr(c.layer.url,null,b)}}),e.hitch(this,function(a){this.domNode&&console.error(a)})).always(e.hitch(this,function(){this.activeTable.showRefreshing(!1)})));this.emit("show-filter",{layerInfoId:e.getObject("layerInfo.id",!1,this.activeTable)?this.activeTable.layerInfo.id:null})},_toggleColumns:function(){this.activeTable&&this.activeTable.toggleColumns();this.emit("toggle-columns",
{layerInfoId:e.getObject("layerInfo.id",!1,this.activeTable)?this.activeTable.layerInfo.id:null})},_onExportFiles:function(){if(this.activeTable)var a=new f({message:this.nls.exportMessage,titleLabel:this.nls.exportFiles,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:e.hitch(this,function(){this._exportToCSV();a.close()})},{label:this.nls.cancel}]});this.emit("export-csv",{layerInfoId:e.getObject("layerInfo.id",!1,this.activeTable)?this.activeTable.layerInfo.id:null})},_exportToCSV:function(){this.activeTable.exportToCSV()},
_zoomTo:function(){this.activeTable&&this.activeTable.zoomTo()},_clearSelection:function(){this.activeTable&&this.activeTable.clearSelection(!0)},_refresh:function(){this.activeTable&&this.activeTable.refresh()},_onCloseBtnClicked:function(){this.emit("click-close")}})})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(k,e,q,t,p,g,m,u){q("dijit-legacy-requires")&&p(0,function(){k(["dijit/ToolbarSeparator"])});
return e("dijit.Toolbar",[g,u,m],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"jimu/dijit/Filter":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/Filter.html jimu/filterUtils jimu/utils dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/aspect dojo/query dojo/Deferred esri/request ./_SingleFilter ./_FilterSet ./LoadingIndicator".split(" "),
function(k,e,q,t,p,g,m,u,h,d,s,c,l,b,a,n,f){return k([e,q,t,g],{templateString:p,baseClass:"jimu-filter",declaredClass:"jimu.dijit.Filter",nls:null,_validOptions:!1,_layerDefinition:null,_def:null,noFilterTip:"",enableAskForValues:!1,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;var a=this.nls.matchMsg.split("${any_or_all}");this.nls.strMatchMsgPart1=a[0]||"";this.nls.strMatchMsgPart2=a[1]||"";this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.noFilterTip&&
"string"===typeof this.noFilterTip&&(this.noFilterTipSection.innerHTML=this.noFilterTip)},reset:function(){this.isBuilding()||(this.removeAllFilters(),this.url=null,this.isHosted=!1,this.partsObj=this.expr=this._layerDefinition=null)},isBuilding:function(){return this._def&&!this._def.isFulfilled()},buildByExpr:function(a,f,c){var d=new b;this.isBuilding()?d.reject("Filter is already building."):(this._def=null,this.reset(),this.url=a,this.isHosted=m.isHostedService(this.url),this.expr=f||"1\x3d1",
this._layerDefinition=c,d=this._def=this._init("expr"));return d},buildByFilterObj:function(a,f,c){var d=new b;this.isBuilding()?d.reject("Filter is already building."):(this._def=null,this.reset(),this.url=a,this.isHosted=m.isHostedService(this.url),this.partsObj=f,this._layerDefinition=c,d=this._def=this._init("partsObj"));return d},removeAllFilters:function(){this._destroyAllFilters()},_validateLayerDefinition:function(a){return this._isObject(a)},_init:function(f){var c=new b;if(!this._isString(this.url))return c.reject(),
c;var e=h.hitch(this,function(){setTimeout(h.hitch(this,function(){c.resolve()}),1500)}),g=h.hitch(this,function(){d.setStyle(this.contentSection,"display","block");d.setStyle(this.errorSection,"display","none");this.removeAllFilters();var a=this._layerDefinition.fields;a&&0<a.length?(a=s.filter(a,h.hitch(this,function(a){return 0<=this._supportFieldTypes.indexOf(a.type)})))&&0<a.length?(this._validOptions=!0,d.removeClass(this.btnAddSet,"jimu-state-disabled"),d.removeClass(this.btnAddExp,"jimu-state-disabled"),
d.removeClass(this.iconAddExp,"jimu-state-disabled"),d.removeClass(this.iconAddSet,"jimu-state-disabled"),this.createFieldsStore(),"expr"===f?this._isString(this.expr)?("1\x3d1"===this.expr.replace(/\s/gi,"")&&this.removeAllFilters(),this._parseExpr(this.expr)?e():c.reject()):c.reject():"partsObj"===f?this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),e()):c.reject():this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),e()):this._isString(this.expr)?this._parseExpr(this.expr)?
e():c.reject():(this.removeAllFilters(),e())):(this._showErrorOptions(this.nls.error.noFilterFields),c.reject()):c.reject()});this._validateLayerDefinition(this._layerDefinition)?g():(this.loading.show(),a({url:this.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(h.hitch(this,function(a){this.domNode?(this.loading.hide(),this._layerDefinition=a,g()):c.reject()}),h.hitch(this,function(a){console.error(a);c.reject();this.domNode&&this.loading.hide()})));return c},toJson:function(){var a=
{logicalOperator:this.allAnySelect.value,parts:[]},b=this._getAllSingleFiltersAndFilterSets();if(0===b.length)return a.expr="1\x3d1",a;s.forEach(b,h.hitch(this,function(b){b=b.toJson();a.parts.push(b)}));return s.every(a.parts,h.hitch(this,function(a){return!!a}))&&0<a.parts.length?(a.expr=this.getExprByFilterObj(a),a):null},createFieldsStore:function(){if(!this._layerDefinition.fields||0===this._layerDefinition.fields.length)this._showErrorOptions(this.nls.error.noFilterFields);else{var a=h.clone(this._layerDefinition).fields;
0===this.setFieldsStoreByFieldInfos(a)&&this._showErrorOptions(this.nls.error.noFilterFields)}},_parsePartsObj:function(a){this._validatePartsObj(a)&&(this.removeAllFilters(),this._buildEditUIByPartsObj(a))},_parseExpr:function(a){this._destroyAllFilters();var b=null;if(!this._validateLayerDefinition(this._layerDefinition))return b;if(!a||"string"!==typeof a)return this._showErrorOptions(this.nls.error.invalidSQL),b;if("1\x3d1"===this.expr.replace(/\s/gi,""))return b={expr:"1\x3d1",parts:[],logicalOperator:"AND"};
try{b=this.getFilterObjByExpr(a)}catch(f){b=null,console.error(f)}b?this._buildEditUIByPartsObj(b):this._showErrorOptions(this.nls.error.cantParseSQL);return b},_buildEditUIByPartsObj:function(a){a&&(this._destroyAllFilters(),this.allAnySelect.value=a.logicalOperator,s.forEach(a.parts,h.hitch(this,function(a){a.parts?this._addFilterSet(a):a.fieldObj&&(a.operator&&a.valueObj)&&this._addSingleFilter(a)})))},_addSingleFilter:function(a){a={url:this.url,layerInfo:this._layerDefinition,stringFieldType:this._stringFieldType,
dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,part:a,OPERATORS:h.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,isHosted:this.isHosted};a=new n(a);a.placeAt(this.allExpsBox);a.startup();this.own(c.after(a,"_destroySelf",h.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_addFilterSet:function(a){a={url:this.url,layerInfo:this._layerDefinition,stringFieldType:this._stringFieldType,dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,
partsObj:a,OPERATORS:h.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,isHosted:this.isHosted};a=new f(a);a.placeAt(this.allExpsBox);a.startup();this.own(c.after(a,"_destroySelf",h.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_destroyAllFilters:function(){for(var a=this._getAllSingleFiltersAndFilterSets();0<a.length;)a[0].destroy(),a.splice(0,1);this._checkFilterNumbers()},_getAllSingleFiltersAndFilterSetsDoms:function(){return l(".allExpsBox\x3e.jimu-single-filter,.allExpsBox\x3e.jimu-filter-set",
this.contentSection)},_getAllSingleFiltersAndFilterSets:function(){var a=this._getAllSingleFiltersAndFilterSetsDoms();return s.map(a,h.hitch(this,function(a){return u.byNode(a)}))},_checkFilterNumbers:function(){var a=this._getAllSingleFiltersAndFilterSetsDoms();1<a.length?d.setStyle(this.matchMsg,"display","block"):d.setStyle(this.matchMsg,"display","none");0<a.length?d.setStyle(this.noFilterTipSection,"display","none"):d.setStyle(this.noFilterTipSection,"display","block");s.forEach(a,h.hitch(this,
function(a,b){d.removeClass(a,"even-filter");d.removeClass(a,"odd-filter");d.addClass(a,0===(b+1)%2?"even-filter":"odd-filter")}))},_showErrorOptions:function(a){console.error(a);d.setStyle(this.contentSection,"display","none");d.setStyle(this.errorSection,"display","none");this.errorTip.innerHTML=a;this.loading.hide()},_onBtnAddSetClick:function(){this._layerDefinition&&this._validOptions&&this._addFilterSet()},_onBtnAddExpClick:function(){this._layerDefinition&&this._validOptions&&this._addSingleFilter()}})})},
"jimu/dijit/_SingleFilter":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilter.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/json dojo/on dojo/store/Memory esri/request jimu/utils jimu/dijit/CheckBox dijit/form/Select dijit/form/FilteringSelect dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/NumberTextBox".split(" "),function(k,e,q,t,p,g,m,u,h,d,s,c,l){return k([e,q,t],{templateString:p,
baseClass:"jimu-single-filter",declaredClass:"jimu.dijit._SingleFilter",nls:null,url:null,layerInfo:null,stringFieldType:"",dateFieldType:"",numberFieldTypes:[],supportFieldTypes:[],part:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,postMixInProperties:function(){this.supportFieldTypes=[];this.supportFieldTypes.push(this.stringFieldType);this.supportFieldTypes.push(this.dateFieldType);this.supportFieldTypes=this.supportFieldTypes.concat(this.numberFieldTypes);this.nls=window.jimuNls.filterBuilder;
this.nls.caseSensitive||(this.nls.caseSensitive="Case Sensitive")},postCreate:function(){this.inherited(arguments);this._initSelf()},toJson:function(){var b=null,a=this._isUseAskForValues(),c=this._getSelectedFilteringItem(this.fieldsSelect);if(!c)return null;b={fieldObj:"",operator:"",valueObj:"",interactiveObj:"",caseSensitive:!1};if(a){if(!this.promptTB.validate())return this._showValidationErrorTip(this.promptTB),null;b.interactiveObj={prompt:this.promptTB.get("value"),hint:this.hintTB.get("value")}}b.fieldObj=
{name:c.name,label:c.name,shortType:c.shortType,type:c.type};if("none"===this.operatorsSelect.get("value"))return null;b.operator=this.operatorsSelect.get("value");b.valueObj={isValid:!0,type:""};var f=c.shortType;if(this.valueRadio.checked)if(b.valueObj.type="value","string"===f)if(b.operator===this.OPERATORS.stringOperatorIsBlank||b.operator===this.OPERATORS.stringOperatorIsNotBlank)b.valueObj.value=null;else if(this._isFieldCoded(c)&&b.operator===this.OPERATORS.stringOperatorIs){if(!this.stringCodedValuesFS.validate())return this._showValidationErrorTip(this.stringCodedValuesFS),
null;a=this._getSelectedFilteringItem(this.stringCodedValuesFS);b.valueObj.value=a?a.code:""}else{if(!this.stringTextBox.validate())return this._showValidationErrorTip(this.stringTextBox),null;b.valueObj.value=this.stringTextBox.get("value")}else if("number"===f)if(b.operator===this.OPERATORS.numberOperatorIsBlank||b.operator===this.OPERATORS.numberOperatorIsNotBlank)b.valueObj.value=null;else if(b.operator===this.OPERATORS.numberOperatorIsBetween||b.operator===this.OPERATORS.numberOperatorIsNotBetween){if(!this.numberTextBox1.validate())return this._showValidationErrorTip(this.numberTextBox1),
null;if(!this.numberTextBox2.validate())return this._showValidationErrorTip(this.numberTextBox2),null;b.valueObj.value1=this._getValueForNumberTextBox(this.numberTextBox1);b.valueObj.value2=this._getValueForNumberTextBox(this.numberTextBox2);b.valueObj.isValid=l.isValidNumber(b.valueObj.value1)&&l.isValidNumber(b.valueObj.value2)}else{if(this._isFieldCoded(c)&&b.operator===this.OPERATORS.numberOperatorIs){if(!this.numberCodedValuesFS.validate())return this._showValidationErrorTip(this.numberCodedValuesFS),
null;a=this._getSelectedFilteringItem(this.numberCodedValuesFS);b.valueObj.value=a?parseFloat(a.code):null}else{if(!this.numberTextBox.validate())return this._showValidationErrorTip(this.numberTextBox),null;b.valueObj.value=this._getValueForNumberTextBox(this.numberTextBox)}b.valueObj.isValid=l.isValidNumber(b.valueObj.value)}else{if("date"===f)if(b.operator===this.OPERATORS.dateOperatorIsBlank||b.operator===this.OPERATORS.dateOperatorIsNotBlank)b.valueObj.value=null;else if(b.operator===this.OPERATORS.dateOperatorIsBetween||
b.operator===this.OPERATORS.dateOperatorIsNotBetween){if(!this.dateTextBox1.validate())return this._showValidationErrorTip(this.dateTextBox1),null;if(!this.dateTextBox2.validate())return this._showValidationErrorTip(this.dateTextBox2),null;b.valueObj.value1=this.dateTextBox1.get("value").toDateString();b.valueObj.value2=this.dateTextBox2.get("value").toDateString()}else{if(!this.dateTextBox.validate())return this._showValidationErrorTip(this.dateTextBox),null;b.valueObj.value=this.dateTextBox.get("value").toDateString()}}else if(this.fieldRadio.checked){a=
this._getSelectedFilteringItem(this.fieldsSelect2);if(!a)return this._showValidationErrorTip(this.fieldsSelect2),null;b.valueObj.value=a.name;b.valueObj.label=a.name;b.valueObj.type="field"}else if(this.uniqueRadio&&this.uniqueRadio.checked)if(b.valueObj.type="unique",c=this._getSelectedFilteringItem(this.uniqueValuesSelect))"string"===f?b.valueObj.value=c.value:"number"===f&&(b.valueObj.value=parseFloat(c.value));else if(a)"string"===f?b.valueObj.value="":"number"===f&&(b.valueObj.value=null,b.valueObj.isValid=
!1);else return this._showValidationErrorTip(this.uniqueValuesSelect),null;if("string"===f)switch(b.operator){case this.OPERATORS.stringOperatorStartsWith:case this.OPERATORS.stringOperatorEndsWith:case this.OPERATORS.stringOperatorContains:case this.OPERATORS.stringOperatorDoesNotContain:b.caseSensitive=this.cbxCaseSensitive.getValue()}return b},showDelteIcon:function(){m.setStyle(this.btnDelete,"display","inline-block")},hideDeleteIcon:function(){m.setStyle(this.btnDelete,"display","none")},_showCaseSensitive:function(){m.setStyle(this.cbxCaseSensitive.domNode,
"display","inline-block")},_hideCaseSensitive:function(){m.setStyle(this.cbxCaseSensitive.domNode,"display","none")},_getProcessedString:function(b){return l.isNotEmptyString(b,!0)?b:""},_getProcessedNumber:function(b){return l.isValidNumber(b)?b:null},_setValueForStringTextBox:function(b,a){a=this._getProcessedString(a);b.set("value",a)},_setValueForNumberTextBox:function(b,a){l.isValidNumber(a)&&b.set("value",a)},_getValueForNumberTextBox:function(b){b=b.get("value");return this._getProcessedNumber(b)},
_initSelf:function(){this.isHosted&&(this.cbxCaseSensitive.setValue(!1),this.cbxCaseSensitive.setStatus(!1),this.cbxCaseSensitive.domNode.title=this.nls.notSupportCaseSensitiveTip);this.own(d(this.cbxAskValues,"status-change",g.hitch(this,this._onCbxAskValuesStatusChanged)));this.cbxAskValues.onChange=g.hitch(this,this._onCbxAskValuesClicked);this.own(d(this.fieldsSelect,"MouseEnter",g.hitch(this,this._updateFieldsSelectTitle)));this.own(d(this.operatorsSelect,"MouseEnter",g.hitch(this,this._updateOperatorsSelectTitle)));
this.own(d(this.dateTextBox1,"MouseEnter",g.hitch(this,this._updateDateTextBox1Title)));this.own(d(this.dateTextBox2,"MouseEnter",g.hitch(this,this._updateDateTextBox2Title)));var b=new s({idProperty:"id",data:[]});this.uniqueValuesSelect.set("store",b);this.enableAskForValues?(m.setStyle(this.cbxAskValues.domNode,"display","inline-block"),m.setStyle(this.promptSection,"display","block")):(m.setStyle(this.cbxAskValues.domNode,"display","none"),m.setStyle(this.promptSection,"display","none"));this.layerInfo=
g.mixin({},this.layerInfo);this._initRadios();b=0;this.layerInfo.currentVersion&&(b=parseFloat(this.layerInfo.currentVersion));if(10.1>b||this._isStreamServer(this.url))m.destroy(this.uniqueTd),this.uniqueRadio=null;if((b=this.layerInfo.fields)&&0<b.length)b=u.filter(b,g.hitch(this,function(a){return 0<=this.supportFieldTypes.indexOf(a.type)})),this._enableRadios(),this._initFieldsSelect(b)},_isStreamServer:function(b){b=(b||"").replace(/\/*$/g,"");return/\/StreamServer$/gi.test(b)},_updateFieldsSelectTitle:function(){this.fieldsSelect.domNode.title=
"";var b=this._getSelectedFilteringItem(this.fieldsSelect);b&&(this.fieldsSelect.domNode.title=b.displayName||b.alias||b.name)},_updateOperatorsSelectTitle:function(){this.operatorsSelect.domNode.title="";var b=this.operatorsSelect.get("value");b&&(b=this.operatorsSelect.getOptions(b),this.operatorsSelect.domNode.title=b.label)},_updateDateTextBox1Title:function(){var b=this.dateTextBox1.get("displayedValue")||"";this.dateTextBox1.domNode.title=b},_updateDateTextBox2Title:function(){var b=this.dateTextBox2.get("displayedValue")||
"";this.dateTextBox2.domNode.title=b},_showValidationErrorTip:function(b){try{!b.validate()&&b.domNode&&b.focusNode&&(b.focusNode.focus(),b.focusNode.blur())}catch(a){console.error(a)}},_focusValidationTextBox:function(b){try{b&&b.focusNode&&b.focusNode.focus()}catch(a){console.error(a)}},_isFieldCoded:function(b){return(b=b.domain)&&"codedValue"===b.type&&b.codedValues&&0<b.codedValues.length},_getSelectedFilteringItem:function(b){if(b.validate()){var a=b.get("item");if(a)return a}this._showValidationErrorTip(b);
return null},_getShortTypeByFieldType:function(b){return b===this.stringFieldType?"string":b===this.dateFieldType?"date":0<=this.numberFieldTypes.indexOf(b)?"number":null},_getOperatorsByShortType:function(b){var a=[];"string"===b?a=[this.OPERATORS.stringOperatorIs,this.OPERATORS.stringOperatorIsNot,this.OPERATORS.stringOperatorStartsWith,this.OPERATORS.stringOperatorEndsWith,this.OPERATORS.stringOperatorContains,this.OPERATORS.stringOperatorDoesNotContain,this.OPERATORS.stringOperatorIsBlank,this.OPERATORS.stringOperatorIsNotBlank]:
"number"===b?a=[this.OPERATORS.numberOperatorIs,this.OPERATORS.numberOperatorIsNot,this.OPERATORS.numberOperatorIsAtLeast,this.OPERATORS.numberOperatorIsLessThan,this.OPERATORS.numberOperatorIsAtMost,this.OPERATORS.numberOperatorIsGreaterThan,this.OPERATORS.numberOperatorIsBetween,this.OPERATORS.numberOperatorIsNotBetween,this.OPERATORS.numberOperatorIsBlank,this.OPERATORS.numberOperatorIsNotBlank]:"date"===b&&(a=[this.OPERATORS.dateOperatorIsOn,this.OPERATORS.dateOperatorIsNotOn,this.OPERATORS.dateOperatorIsBefore,
this.OPERATORS.dateOperatorIsAfter,this.OPERATORS.dateOperatorIsBetween,this.OPERATORS.dateOperatorIsNotBetween,this.OPERATORS.dateOperatorIsBlank,this.OPERATORS.dateOperatorIsNotBlank]);return a},_initFieldsSelect:function(b){b=u.map(b,g.hitch(this,function(a,b){var c=g.mixin({},a);c.id=b;c.shortType=this._getShortTypeByFieldType(a.type);c.alias||(c.alias=c.name);var d="";"string"===c.shortType?d=this.nls.string:"number"===c.shortType?d=this.nls.number:"date"===c.shortType&&(d=this.nls.date);c.displayName=
c.alias+" ("+d+")";return c}));if(0<b.length){var a=new s({data:b});this.fieldsSelect.set("store",a);this.fieldsSelect.set("value",b[0].id)}this.fieldsSelect.focusNode.focus();this.fieldsSelect.focusNode.blur();this._onFieldsSelectChange();this.part&&this._showPart(this.part)},_showPart:function(b){if((this.part=b)&&this.part.fieldObj&&this.part.operator&&this.part.valueObj){b=this.part.fieldObj.name;var a=this.part.operator;this.part.caseSensitive=!!this.part.caseSensitive;b=this.fieldsSelect.store.query({name:b});
if(0!==b.length&&(b=b[0]))this.fieldsSelect.set("value",b.id),setTimeout(g.hitch(this,function(){this.domNode&&(this._onFieldsSelectChange(),this.operatorsSelect.set("value",a),setTimeout(g.hitch(this,function(){this.domNode&&this._resetByFieldAndOperation(this.part)}),50),setTimeout(g.hitch(this,function(){if(this.domNode){var a=this.part.interactiveObj;a&&(this.cbxAskValues.check(),this._updatePrompt(),this.promptTB.set("value",a.prompt||""),this.hintTB.set("value",a.hint||""))}}),100))}),0)}},
_onFieldsSelectChange:function(){this._updateFieldsSelectTitle();this.operatorsSelect.removeOption(this.operatorsSelect.getOptions());this.operatorsSelect.addOption({value:"none",label:this.nls.none});this.valueRadio.checked=!0;var b=this._getSelectedFilteringItem(this.fieldsSelect);b&&(this.operatorsSelect.shortType=b.shortType,b=this._getOperatorsByShortType(b.shortType),this.operatorsSelect.removeOption(this.operatorsSelect.getOptions()),u.forEach(b,g.hitch(this,function(a){this.operatorsSelect.addOption({value:a,
label:this.nls[a]})})));this._onOperatorsSelectChange()},_onOperatorsSelectChange:function(){this._updateOperatorsSelectTitle();this.valueRadio.checked=!0;this._resetByFieldAndOperation()},_onRangeNumberBlur:function(){if(this.numberTextBox1.validate()&&this.numberTextBox2.validate()){var b=this._getValueForNumberTextBox(this.numberTextBox1),a=this._getValueForNumberTextBox(this.numberTextBox2);l.isValidNumber(b)&&l.isValidNumber(a)&&b>a&&(this._setValueForNumberTextBox(this.numberTextBox1,a),this._setValueForNumberTextBox(this.numberTextBox2,
b))}},_onRangeDateBlur:function(){if(this.dateTextBox1.validate()&&this.dateTextBox2.validate()){var b=this.dateTextBox1.get("value"),a=b.getTime(),c=this.dateTextBox2.get("value"),f=c.getTime();a>f&&(this.dateTextBox1.set("value",c),this.dateTextBox2.set("value",b))}},_initRadios:function(){var b="radio_"+l.getRandomString();this.valueRadio.name=b;this.fieldRadio.name=b;l.combineRadioCheckBoxWithLabel(this.valueRadio,this.valueLabel);l.combineRadioCheckBoxWithLabel(this.fieldRadio,this.fieldLabel);
this.own(d(this.valueRadio,"click",g.hitch(this,function(){this._resetByFieldAndOperation()})));this.own(d(this.fieldRadio,"click",g.hitch(this,function(){this._resetByFieldAndOperation()})));this.uniqueRadio&&(this.uniqueRadio.name=b,l.combineRadioCheckBoxWithLabel(this.uniqueRadio,this.uniqueLabel),this.own(d(this.uniqueRadio,"click",g.hitch(this,function(){this._resetByFieldAndOperation()}))));this._resetByFieldAndOperation()},_enableRadios:function(){this.valueRadio.disabled=!1;this.fieldRadio.disabled=
!1;this.uniqueRadio&&(this.uniqueRadio.disabled=!1)},_disableRadios:function(){this.valueRadio.disabled=!0;this.fieldRadio.disabled=!0;this.uniqueRadio&&(this.uniqueRadio.disabled=!0)},_resetByFieldAndOperation:function(b){var a=b&&b.valueObj;m.setStyle(this.attributeValueContainer,"display","block");this._enableRadios();this._hideCaseSensitive();a&&("value"===a.type?this.valueRadio.checked=!0:"field"===a.type?this.fieldRadio.checked=!0:"unique"===a.type&&this.uniqueRadio&&(this.uniqueRadio.checked=
!0));var c=this._getSelectedFilteringItem(this.fieldsSelect),f=c&&c.shortType,d=this.operatorsSelect.get("value");if(c)if("string"===f)switch(d){case this.OPERATORS.stringOperatorStartsWith:case this.OPERATORS.stringOperatorEndsWith:case this.OPERATORS.stringOperatorContains:case this.OPERATORS.stringOperatorDoesNotContain:this.valueRadio.checked=!0,this._disableRadios(),this._showCaseSensitive(),b&&this.cbxCaseSensitive.setValue(b.caseSensitive)}else if("number"===f)switch(d){case this.OPERATORS.numberOperatorIsBetween:case this.OPERATORS.numberOperatorIsNotBetween:this.valueRadio.checked=
!0,this._disableRadios()}else if("date"===f){switch(d){case this.OPERATORS.dateOperatorIsBetween:case this.OPERATORS.dateOperatorIsNotBetween:this.valueRadio.checked=!0,this._disableRadios()}this.uniqueRadio&&(this.uniqueRadio.disabled=!0,this.uniqueRadio.checked&&(this.valueRadio.checked=!0))}this._updateUIOfAttrValueContainer(c,d,a)},_updateUIOfAttrValueContainer:function(b,a,c){this._updatePrompt();var f=b&&b.shortType;if("string"===f||"number"===f||"date"===f)if(m.setStyle(this.attributeValueContainer,
"display","block"),this.valueRadio.checked)if(m.setStyle(this.fieldsSelect2.domNode,"display","none"),m.setStyle(this.uniqueValuesSelect.domNode,"display","none"),this._showAllValueBoxContainer(),this._resetValueTextBox(),"string"===f)m.setStyle(this.stringTextBoxContainer,"display","block"),m.setStyle(this.numberTextBoxContainer,"display","none"),m.setStyle(this.dateTextBoxContainer,"display","none"),this._isFieldCoded(b)&&a===this.OPERATORS.stringOperatorIs?(m.setStyle(this.stringCodedValuesFS.domNode,
"display","inline-block"),m.setStyle(this.stringTextBox.domNode,"display","none"),b=u.map(b.domain.codedValues,g.hitch(this,function(a,b){var c=g.mixin({},a);c.id=b;return c})),f=new s({data:b}),this.stringCodedValuesFS.set("store",f),c?(f=u.filter(b,g.hitch(this,function(a){return a.code===c.value})),0<f.length?this.stringCodedValuesFS.set("value",f[0].id):this.stringCodedValuesFS.set("value",b[0].id)):this.stringCodedValuesFS.set("value",b[0].id)):(m.setStyle(this.stringTextBox.domNode,"display",
"inline-block"),m.setStyle(this.stringCodedValuesFS.domNode,"display","none"),c&&this._setValueForStringTextBox(this.stringTextBox,c.value)),(a===this.OPERATORS.stringOperatorIsBlank||a===this.OPERATORS.stringOperatorIsNotBlank)&&m.setStyle(this.attributeValueContainer,"display","none");else if("number"===f){m.setStyle(this.stringTextBoxContainer,"display","none");m.setStyle(this.numberTextBoxContainer,"display","block");m.setStyle(this.dateTextBoxContainer,"display","none");if(a===this.OPERATORS.numberOperatorIsBetween||
a===this.OPERATORS.numberOperatorIsNotBetween){if(m.setStyle(this.numberTextBox.domNode,"display","none"),m.setStyle(this.numberRangeTable,"display","table"),m.setStyle(this.numberCodedValuesFS.domNode,"display","none"),c){var d;b=l.isValidNumber(c.value1);f=l.isValidNumber(c.value2);b&&f?(f=parseFloat(c.value1),d=parseFloat(c.value2),b=Math.min(f,d),f=Math.max(f,d),this.numberTextBox1.set("value",b),this.numberTextBox2.set("value",f)):b&&!f?(f=parseFloat(c.value1),this.numberTextBox1.set("value",
f)):!b&&f&&(d=parseFloat(c.value2),this.numberTextBox2.set("value",d))}}else if(m.setStyle(this.numberRangeTable,"display","none"),this._isFieldCoded(b)&&a===this.OPERATORS.numberOperatorIs)if(m.setStyle(this.numberTextBox.domNode,"display","none"),m.setStyle(this.numberCodedValuesFS.domNode,"display","inline-block"),b=u.map(b.domain.codedValues,g.hitch(this,function(a,b){var c=g.mixin({},a);c.id=b;return c})),f=new s({data:b}),this.numberCodedValuesFS.set("store",f),c&&!isNaN(c.value)){var e=parseFloat(c.value),
f=u.filter(b,g.hitch(this,function(a){return parseFloat(a.code)===e}));0<f.length?this.numberCodedValuesFS.set("value",f[0].id):this.numberCodedValuesFS.set("value",b[0].id)}else this.numberCodedValuesFS.set("value",b[0].id);else m.setStyle(this.numberTextBox.domNode,"display","inline-block"),m.setStyle(this.numberCodedValuesFS.domNode,"display","none"),c&&this._setValueForNumberTextBox(this.numberTextBox,c.value);(a===this.OPERATORS.numberOperatorIsBlank||a===this.OPERATORS.numberOperatorIsNotBlank)&&
m.setStyle(this.attributeValueContainer,"display","none")}else"date"===f&&(m.setStyle(this.stringTextBoxContainer,"display","none"),m.setStyle(this.numberTextBoxContainer,"display","none"),m.setStyle(this.dateTextBoxContainer,"display","block"),a===this.OPERATORS.dateOperatorIsBetween||a===this.OPERATORS.dateOperatorIsNotBetween?(m.setStyle(this.dateTextBox.domNode,"display","none"),m.setStyle(this.dateRangeTable,"display","table"),c&&(c.value1&&c.value2)&&(this.dateTextBox1.set("value",new Date(c.value1)),
this.dateTextBox2.set("value",new Date(c.value2)))):(m.setStyle(this.dateTextBox.domNode,"display","inline-block"),m.setStyle(this.dateRangeTable,"display","none"),c&&c.value&&this.dateTextBox.set("value",new Date(c.value))),(a===this.OPERATORS.dateOperatorIsBlank||a===this.OPERATORS.dateOperatorIsNotBlank)&&m.setStyle(this.attributeValueContainer,"display","none"));else this.fieldRadio.checked?(this._hideAllValueBoxContainer(),m.setStyle(this.uniqueValuesSelect.domNode,"display","none"),m.setStyle(this.fieldsSelect2.domNode,
"display","inline-block"),this._resetFieldsSelect2(),c&&c.value&&(a=this.fieldsSelect2.store.query({name:c.value}),0<a.length&&(a=a[0])&&this.fieldsSelect2.set("value",a.id))):this.uniqueRadio&&this.uniqueRadio.checked&&(this._hideAllValueBoxContainer(),m.setStyle(this.fieldsSelect2.domNode,"display","none"),m.setStyle(this.uniqueValuesSelect.domNode,"display","inline-block"),this._resetUniqueValuesSelect(c));else m.setStyle(this.attributeValueContainer,"display","none")},_showAllValueBoxContainer:function(){m.setStyle(this.allValueBoxContainer,
"display","block")},_hideAllValueBoxContainer:function(){m.setStyle(this.allValueBoxContainer,"display","none")},_resetValueTextBox:function(){this.stringTextBox.set("value","");this.numberTextBox.set("value","");this.dateTextBox.set("value",new Date)},_resetFieldsSelect2:function(){this.fieldsSelect2.set("displayedValue","");var b=new s({data:[]});this.fieldsSelect2.set("store",b);if(this.fieldsSelect.validate()){var a=this._getSelectedFilteringItem(this.fieldsSelect);if(a){var b=this.fieldsSelect.store.query({shortType:a.shortType}),
c=u.filter(b,g.hitch(this,function(b){return b.id!==a.id})),b=new s({data:c});this.fieldsSelect2.set("store",b);0<c.length&&this.fieldsSelect2.set("value",c[0].id)}}},_tryLocaleNumber:function(b){var a=l.localizeNumber(b);if(null===a||void 0===a)a=b;return a},_resetUniqueValuesSelect:function(b){this.uniqueValuesSelect.reset();this.uniqueValuesSelect.store.setData([]);if(this.layerInfo&&10.1<=parseFloat(this.layerInfo.currentVersion)){var a=this._getSelectedFilteringItem(this.fieldsSelect);if(a){var d=
this.url+"/generateRenderer",f=h.stringify({type:"uniqueValueDef",uniqueValueFields:[a.name]});c({url:d,content:{classificationDef:f,f:"json"},handleAs:"json",callbackParamName:"callback",timeout:15E3}).then(g.hitch(this,function(c){c=c&&c.uniqueValueInfos;var f=this._getSelectedFilteringItem(this.fieldsSelect);if(c&&f&&a.id===f.id){this.uniqueValuesSelect.store.setData([]);var d=-1,e=this._hasCodedValues(f);c=u.map(c,g.hitch(this,function(a,c){var h=a.value,g=h;"number"===f.shortType&&(h=parseFloat(h),
g=this._tryLocaleNumber(h));e&&(g=this._getDisplayNameOfCodedValues(h,f));g={id:c,value:h,label:g};b&&b.value===h&&(d=g.id);return g}));this.uniqueValuesSelect.store.setData(c);0<c.length&&0<=d&&(c=this.uniqueValuesSelect.store.get(d))&&this.uniqueValuesSelect.set("item",c)}}),g.hitch(this,function(a){console.error(a)}))}}},_hasCodedValues:function(b){var a=!1;b.domain&&(b=b.domain.codedValues)&&0<b.length&&(a=!0);return a},_getDisplayNameOfCodedValues:function(b,a){var c=b;u.some(a.domain.codedValues,
function(a){return a.code===b?(c=a.name,!0):!1});return c},_onCbxAskValuesClicked:function(){this._updateRequiredProperty();this._updatePrompt()},_onCbxAskValuesStatusChanged:function(){this._updateRequiredProperty()},_isUseAskForValues:function(){return this.cbxAskValues.status&&this.cbxAskValues.checked},_isValueRequired:function(){return!this._isUseAskForValues()},_updateRequiredProperty:function(){var b=this._isValueRequired();this.stringTextBox.set("required",b);this.stringCodedValuesFS.set("required",
b);this.numberTextBox.set("required",b);this.numberTextBox1.set("required",b);this.numberTextBox2.set("required",b);this.numberCodedValuesFS.set("required",b);this.uniqueValuesSelect.set("required",b)},_updatePrompt:function(){this.promptTB.set("value","");this.hintTB.set("value","");this.cbxAskValues.setStatus(!0);m.setStyle(this.promptTable,"display","table");var b=this.operatorsSelect.get("value"),a=this.nls[b];this.fieldRadio.checked&&this.cbxAskValues.setStatus(!1);b===this.OPERATORS.stringOperatorIsBlank&&
this.cbxAskValues.setStatus(!1);b===this.OPERATORS.stringOperatorIsNotBlank&&this.cbxAskValues.setStatus(!1);b===this.OPERATORS.numberOperatorIsBlank&&this.cbxAskValues.setStatus(!1);b===this.OPERATORS.numberOperatorIsNotBlank&&this.cbxAskValues.setStatus(!1);b===this.OPERATORS.dateOperatorIsBlank&&this.cbxAskValues.setStatus(!1);b===this.OPERATORS.dateOperatorIsNotBlank&&this.cbxAskValues.setStatus(!1);if(this.cbxAskValues.status&&this.cbxAskValues.checked){m.setStyle(this.promptTable,"display",
"table");var c=this._getSelectedFilteringItem(this.fieldsSelect);c&&"none"!==b&&this.promptTB.set("value",(c.alias||c.name)+" "+a)}else m.setStyle(this.promptTable,"display","none")},_destroySelf:function(){this.destroy()}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(k,e,q,t,p){return k("dijit.form.FilteringSelect",[t,p],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},
isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(e,k,p,h){k&&k[this.searchAttr]!==this._lastQuery||!k&&e.length&&this.store.getIdentity(e[0])!=this._lastQuery||(e.length?this.set("item",e[0],h):this.set("value","",h||void 0===h&&!this.focused,this.textbox.value,null))},_openResultList:function(e,k,p){k[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),
void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(g,k,p,h){this._onChangeActive||(k=null);if(void 0===h){if(null===g||""===g)if(g="",!e.isString(p)){this._setDisplayedValueAttr(p||"",k);return}var d=this;this._lastQuery=g;q(this.store.get(g),function(e){d._callbackSetLabel(e?[e]:[],void 0,void 0,k)})}else this.valueNode.value=g,this.inherited(arguments,[g,k,p,h])},_setItemAttr:function(e,k,
p){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(e){return e.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(g,k){null==g&&(g="");if(!this._created){if(!("displayedValue"in this.params))return;k=!1}if(this.store){this.closeDropDown();var p=e.clone(this.query),h=this._getDisplayQueryString(g),d;this.store._oldAPI?d=h:(d=this._patternToRegExp(h),d.toString=function(){return h});this._lastQuery=p[this.searchAttr]=d;this._lastDisplayedValue=
this.textbox.value=g;this._set("displayedValue",g);var s=this,c={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};e.mixin(c,this.fetchProperties);this._fetchHandle=this.store.query(p,c);q(this._fetchHandle,function(d){s._fetchHandle=null;s._callbackSetLabel(d||[],p,c,k)},function(c){s._fetchHandle=null;s._cancelingQuery||console.error("dijit.form.FilteringSelect: "+c.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare",
"../Calendar","./_DateTimeTextBox"],function(k,e,q){return k("dijit.form.DateTextBox",q,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:e,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
function(k,e,q,t,p,g,m,u,h,d,s,c,l,b,a,n,f){var r=t("dijit.Calendar",[l,b,a],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){u.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new r._MonthDropDownButton({id:this.id+"_mddb",
tabIndex:-1,onMonthSelect:d.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(s(this.domNode,"keydown",d.hitch(this,"_onKeyDown")),s(this.dateRowsNode,"mouseover",d.hitch(this,"_onDayMouseOver")),s(this.dateRowsNode,"mouseout",d.hitch(this,"_onDayMouseOut")),s(this.dateRowsNode,"mousedown",d.hitch(this,"_onDayMouseDown")),s(this.dateRowsNode,"mouseup",d.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=
new this.dateClassObj(this.currentFocus);b.setDate(1);b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var c=this.currentFocus.getDate();b.setDate(Math.min(c,a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){if((a=g.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!g.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode))g.add(a,"dijitCalendarHoveredDate"),this._currentNode=a},_onDayMouseOut:function(a){this._currentNode&&
!(a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode)&&(a="dijitCalendarHoveredDate",g.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),g.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){if((a=a.target.parentNode)&&a.dijitDateValue&&!g.contains(a,"dijitCalendarDisabledDate"))g.add(a,"dijitCalendarActiveDate"),this._currentNode=a},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&g.remove(a,"dijitCalendarActiveDate")},
handleKey:function(a){var b=-1,c,f=this.currentFocus;switch(a.keyCode){case h.RIGHT_ARROW:b=1;case h.LEFT_ARROW:c="day";this.isLeftToRight()||(b*=-1);break;case h.DOWN_ARROW:b=1;case h.UP_ARROW:c="week";break;case h.PAGE_DOWN:b=1;case h.PAGE_UP:c=a.ctrlKey||a.altKey?"year":"month";break;case h.END:f=this.dateModule.add(f,"month",1),c="day";case h.HOME:f=new this.dateClassObj(f);f.setDate(1);break;default:return!0}c&&(f=this.dateModule.add(f,c,b));this._setCurrentFocusAttr(f);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});r._MonthDropDownButton=t("dijit.Calendar._MonthDropDownButton",f,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new r._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.dropDown.set("months",
b);this.containerNode.innerHTML=(6==c("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});r._MonthDropDown=t("dijit.Calendar._MonthDropDown",[b,n,a],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";k.forEach(a,function(a,b){m.create("div",{className:"dijitCalendarMonthLabel",month:b,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(p.get(a.target,"month"))},onChange:function(){}});return r})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(k,e,q,t,p,g,m,u,h,d,s,c,l,b,a){var n=e("dijit.CalendarLite",[l,b],{templateString:a,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=new this.dateClassObj(a);
b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=g.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){a&&(a=new this.dateClassObj(a),
a.setHours(1,0,0,0));return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),b=a.getDay(),c=this.dateModule.getDaysInMonth(a),d=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),e=new this.dateClassObj,h=q.getFirstDayOfWeek(this.lang);h>b&&(h-=7);if(!this.summary){var g=this.dateLocaleModule.getNames("months",
"wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",g[a.getMonth()])}this._date2cell={};k.forEach(this.dateCells,function(g,k){var w=k+h,l=new this.dateClassObj(a),m="dijitCalendar",n=0;w<b?(w=d-b+w+1,n=-1,m+="Previous"):w>=b+c?(w=w-b-c+1,n=1,m+="Next"):(w=w-b+1,m+="Current");n&&(l=this.dateModule.add(l,"month",n));l.setDate(w);this.dateModule.compare(l,e,"date")||(m="dijitCalendarCurrentDate "+m);this.isDisabledDate(l,this.lang)?(m="dijitCalendarDisabledDate "+m,g.setAttribute("aria-disabled",
"true")):(m="dijitCalendarEnabledDate "+m,g.removeAttribute("aria-disabled"),g.setAttribute("aria-selected","false"));(n=this.getClassForDate(l,this.lang))&&(m=n+" "+m);g.className=m+"Month dijitCalendarDateTemplate";m=l.valueOf();this._date2cell[m]=g;g.dijitDateValue=m;this._setText(this.dateLabels[k],l.getDateLocalized?l.getDateLocalized(this.lang):l.getDate())},this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);this.monthWidget.set("month",a);var b=
a.getFullYear()-1,c=new this.dateClassObj;k.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?h.getObject(a.datePackage,!1):t;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?h.getObject(a.datePackage+".locale",!1):p},_createMonthWidget:function(){return n._MonthWidget({id:this.id+
"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var a=this.dowTemplateString,b=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),d=q.getFirstDayOfWeek(this.lang);this.dayCellsHtml=c.substitute([a,a,a,a,a,a,a].join(""),{d:""},function(){return b[d++%7]});a=c.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[a,a,a,a,a,a].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);
m.setSelectable(this.domNode,!1);a=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",a,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=h.hitch(this,function(a,b,c){this[a].dojoClick=!0;return d(this[a],"click",h.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,b,c))}))});this.own(a("incrementMonth","month",1),a("decrementMonth","month",-1),
a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,b){var c=this.currentFocus,d=this._getNodeByDate(c);a=this._patchDate(a);this._set("currentFocus",a);if(!this._date2cell||0!=this.dateModule.difference(c,a,"month"))this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]);c=this._getNodeByDate(a);c.setAttribute("tabIndex",this.tabIndex);(this.focused||b)&&c.focus();d&&d!=c&&(s("webkit")?d.setAttribute("tabIndex","-1"):
d.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue;a=a.parentNode);a&&!u.contains(a,"dijitCalendarDisabledDate")&&this.set("value",a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function b(a,c){u.toggle(c,"dijitCalendarSelectedDate",a);c.setAttribute("aria-selected",
a?"true":"false")}k.forEach(this._selectedCells||[],h.partial(b,!1));this._selectedCells=k.filter(k.map(a,this._getNodeByDate,this),function(a){return a});k.forEach(this._selectedCells,h.partial(b,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});n._MonthWidget=e("dijit.CalendarLite._MonthWidget",l,{_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a),c=6==s("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+k.map(b,
function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=c+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});return n})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(k,e,q,t,p,g,m,u){new Date("X");return t("dijit.form._DateTimeTextBox",
[g,m],{templateString:u,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:e.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(e,d){var g=this._isInvalidDate(e),c=this._isInvalidDate(d);if(g||c)return g&&c?0:!g?1:-1;var g=this.format(e,this._unboundedConstraints),c=this.format(d,this._unboundedConstraints),l=this.parse(g,this._unboundedConstraints),b=this.parse(c,this._unboundedConstraints);
return g==c?0:k.compare(l,b,this._selector)},autoWidth:!0,format:function(e,d){return!e?"":this.dateLocaleModule.format(e,d)},parse:function(e,d){return this.dateLocaleModule.parse(e,d)||(this._isEmpty(e)?null:void 0)},serialize:function(e,d){e.toGregorian&&(e=e.toGregorian());return q.toISOString(e,d)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(h){h=h||{};this.dateModule=h.datePackage?p.getObject(h.datePackage,!1):k;this.dateClassObj=
this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=h.datePackage?p.getObject(h.datePackage+".locale",!1):e;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},
_setConstraintsAttr:function(e){e.selector=this._selector;e.fullYear=!0;var d=q.fromISOString;"string"==typeof e.min&&(e.min=d(e.min),this.dateClassObj instanceof Date||(e.min=new this.dateClassObj(e.min)));"string"==typeof e.max&&(e.max=d(e.max),this.dateClassObj instanceof Date||(e.max=new this.dateClassObj(e.max)));this.inherited(arguments);this._unboundedConstraints=p.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(e){return!e||isNaN(e)||"object"!=typeof e||e.toString()==
this._invalidDate},_setValueAttr:function(e,d,g){void 0!==e&&("string"==typeof e&&(e=q.fromISOString(e)),this._isInvalidDate(e)&&(e=null),e instanceof Date&&!(this.dateClassObj instanceof Date)&&(e=new this.dateClassObj(e)));this.inherited(arguments,[e,d,g]);this.value instanceof Date&&(this.filterString="");this.dropDown&&this.dropDown.set("value",e,!1)},_set:function(e,d){if("value"==e){d instanceof Date&&!(this.dateClassObj instanceof Date)&&(d=new this.dateClassObj(d));var g=this._get("value");
if(g instanceof this.dateClassObj&&0==this.compare(d,g))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(e){this._isInvalidDate(e)&&(e=new this.dateClassObj);this._set("dropDownDefaultValue",e)},openDropDown:function(e){this.dropDown&&this.dropDown.destroy();var d=p.isString(this.popupClass)?p.getObject(this.popupClass,!1):this.popupClass,g=this,c=this.get("value");this.dropDown=new d({onChange:function(c){g.set("value",c,!0)},id:this.id+"_popup",dir:g.dir,lang:g.lang,value:c,
textDir:g.textDir,currentFocus:!this._isInvalidDate(c)?c:this.dropDownDefaultValue,constraints:g.constraints,filterString:g.filterString,datePackage:g.datePackage,isDisabledDate:function(c){return!g.rangeCheck(c,g.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(e,d){this._setValueAttr(this.parse(e,this.constraints),d,e)}})})},"jimu/dijit/_FilterSet":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_FilterSet.html dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/aspect dojo/query ./_SingleFilter".split(" "),
function(k,e,q,t,p,g,m,u,h,d,s,c,l){return k([e,q,t],{templateString:p,baseClass:"jimu-filter-set",nls:null,url:null,layerInfo:null,stringFieldType:"",dateFieldType:"",numberFieldTypes:[],partsObj:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;var b=this.nls.matchMsgSet.split("${any_or_all}");this.nls.strMatchMsgPart1=b[0]||"";this.nls.strMatchMsgPart2=b[1]||"";this.inherited(arguments)},postCreate:function(){this.inherited(arguments);
this._initSelf()},toJson:function(){var b=c(".jimu-single-filter",this.allExpsBox),b=h.map(b,m.hitch(this,function(a){return g.byNode(a).toJson()}));return h.every(b,m.hitch(this,function(a){return!!a}))&&0<b.length?{logicalOperator:this.allAnySelect.value,parts:b}:null},showDelteIcon:function(){u.setStyle(this.btnDelete,"display","block")},hideDeleteIcon:function(){u.setStyle(this.btnDelete,"display","none")},_initSelf:function(){this.own(d(this.btnAdd,"click",m.hitch(this,this._addSingleFilter)));
if(this.partsObj){this.allAnySelect.value=this.partsObj.logicalOperator;var b=this.partsObj.parts||[];0===b.length?(this._addSingleFilter(),this._addSingleFilter()):1===b.length?(this._addSingleFilter(b[0]),this._addSingleFilter()):h.forEach(b,m.hitch(this,function(a){this._addSingleFilter(a)}))}else this._addSingleFilter(),this._addSingleFilter()},_addSingleFilter:function(b){b=new l({url:this.url,layerInfo:this.layerInfo,stringFieldType:this.stringFieldType,dateFieldType:this.dateFieldType,numberFieldTypes:this.numberFieldTypes,
part:b,OPERATORS:this.OPERATORS,enableAskForValues:this.enableAskForValues,isHosted:this.isHosted,style:{margin:"15px auto 0 auto",border:0,background:"inherit"}});b.placeAt(this.allExpsBox);b.startup();this.own(s.after(b,"_destroySelf",m.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_checkFilterNumbers:function(){var b=c(".jimu-single-filter",this.allExpsBox),a=2<b.length;h.forEach(b,m.hitch(this,function(b){b=g.byNode(b);a?b.showDelteIcon():b.hideDeleteIcon()}))},_destroySelf:function(){this.destroy()}})})},
"widgets/AttributeTable/_build-generate_module":function(){define(["dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:dijit/layout/templates/TabContainer.html":'\x3cdiv class\x3d"dijitTabContainer"\x3e\r\n\t\x3cdiv class\x3d"dijitTabListWrapper" data-dojo-attach-point\x3d"tablistNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"tablistSpacer" class\x3d"dijitTabSpacer ${baseClass}-spacer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTabPaneWrapper ${baseClass}-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/layout/templates/_TabButton.html":'\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"titleNode,innerDiv,tabContent" class\x3d"dijitTabInner dijitTabContent"\x3e\r\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTabButtonIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3cspan data-dojo-attach-point\x3d\'containerNode,focusNode\' class\x3d\'tabLabel\'\x3e\x3c/span\x3e\r\n\t\x3cspan class\x3d"dijitInline dijitTabCloseButton dijitTabCloseIcon" data-dojo-attach-point\x3d\'closeNode\'\r\n\t\t  role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d\'closeText\' class\x3d\'dijitTabCloseText\'\x3e[x]\x3c/span\r\n\t\t\t\t\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/layout/templates/ScrollingTabController.html":'\x3cdiv class\x3d"dijitTabListContainer-${tabPosition}" style\x3d"visibility:hidden"\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerMenuButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_menuBtn"\r\n\t\t data-dojo-props\x3d"containerId: \'${containerId}\', iconClass: \'dijitTabStripMenuIcon\',\r\n\t\t\t\t\tdropDownPosition: [\'below-alt\', \'above-alt\']"\r\n\t\t data-dojo-attach-point\x3d"_menuBtn" showLabel\x3d"false" title\x3d""\x3e\x26#9660;\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_leftBtn"\r\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideLeftIcon\', showLabel:false, title:\'\'"\r\n\t\t data-dojo-attach-point\x3d"_leftBtn" data-dojo-attach-event\x3d"onClick: doSlideLeft"\x3e\x26#9664;\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_rightBtn"\r\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideRightIcon\', showLabel:false, title:\'\'"\r\n\t\t data-dojo-attach-point\x3d"_rightBtn" data-dojo-attach-event\x3d"onClick: doSlideRight"\x3e\x26#9654;\x3c/div\x3e\r\n\t\x3cdiv class\x3d\'dijitTabListWrapper\' data-dojo-attach-point\x3d\'tablistWrapper\'\x3e\r\n\t\t\x3cdiv role\x3d\'tablist\' data-dojo-attach-event\x3d\'onkeydown:onkeydown\'\r\n\t\t\t data-dojo-attach-point\x3d\'containerNode\' class\x3d\'nowrapTabStrip\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/layout/templates/_ScrollingTabControllerButton.html":'\x3cdiv data-dojo-attach-event\x3d"ondijitclick:_onClick" class\x3d"dijitTabInnerDiv dijitTabContent dijitButtonContents"  data-dojo-attach-point\x3d"focusNode" role\x3d"button"\x3e\r\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitTabStripIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3cspan data-dojo-attach-point\x3d"containerNode,titleNode" class\x3d"dijitButtonText"\x3e\x3c/span\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/Filter.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"contentSection" class\x3d"content-section"\x3e\r\n\t\t\x3cdiv class\x3d"add-btn-section"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAddExp" data-dojo-attach-event\x3d"click:_onBtnAddExpClick"\r\n\t\t\t class\x3d"add-with-icon jimu-state-disabled add-expression jimu-float-leading"\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"iconAddExp" class\x3d"jimu-icon jimu-icon-add jimu-state-disabled"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addAnotherExpression}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAddSet" data-dojo-attach-event\x3d"click:_onBtnAddSetClick"\r\n\t\t\t class\x3d"add-with-icon jimu-state-disabled add-set jimu-float-leading"\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"iconAddSet" class\x3d"jimu-icon jimu-icon-add jimu-state-disabled"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addSet}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"matchMsg" style\x3d"margin-top:11px;margin-bottom:11px;display:none;"\x3e\r\n\t\t\t\x3cspan\x3e${nls.strMatchMsgPart1}\x3c/span\x3e\r\n\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.all}\x3c/option\x3e\r\n\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.any}\x3c/option\x3e\r\n\t\t\t\x3c/select\x3e\r\n\t\t\t\x3cspan\x3e${nls.strMatchMsgPart2}\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\t\x3cdiv class\x3d"allExpsBox" data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"errorSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"errorTip" class\x3d"error-tip"\x3e\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"noFilterTipSection" class\x3d"no-filter-tip" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_SingleFilter.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"setting-table" cellpadding\x3d"0" cellspacing\x3d"0" cellpadding\x3d"10px" style\x3d"table-layout:fixed;"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"fields-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fieldsSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-attach-event\x3d"change:_onFieldsSelectChange"  data-dojo-props\x3d\'searchAttr:"displayName",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"operators-td" nowrap\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"operatorsSelect" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-event\x3d"change:_onOperatorsSelectChange" style\x3d"width:100%;" class\x3d"dijit-form-Select"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"none"\x3e${nls.none}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"value-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"attributeValueContainer" class\x3d"value-container"\x3e\r\n\t\t\t\t\t\t\x3cdiv\x3e\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"allValueBoxContainer" style\x3d"width:100%;"\x3e\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"stringTextBoxContainer" style\x3d"width:100%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"stringTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"width:100%;" class\x3d"dijit-form-ValidationTextBox" /\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"stringCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"numberTextBoxContainer" style\x3d"display:none;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;table-layout:fixed;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"numberCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"dateTextBoxContainer" style\x3d"display:none;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;table-layout:fixed;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox1" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox2" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fieldsSelect2" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name"\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"uniqueValuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect"  data-dojo-props\x3d\'searchAttr:"label"\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\x3cdiv class\x3d"radio-table-container"\x3e\r\n\t\t\t\t\t\t\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"table-layout:fixed;"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"valueRadio" checked\x3d"true" disabled  title\x3d"${nls.valueTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"valueLabel" title\x3d"${nls.valueTooltip}"\x3e${nls.value}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"fieldRadio" disabled title\x3d"${nls.fieldTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"fieldLabel" title\x3d"${nls.fieldTooltip}"\x3e${nls.field}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"uniqueTd"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"uniqueRadio" disabled title\x3d"${nls.uniqueValueTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"uniqueLabel" title\x3d"${nls.uniqueValueTooltip}"\x3e${nls.unique}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"delete-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-icon jimu-icon-delete" data-dojo-attach-point\x3d"btnDelete"\r\n\t\t\t\t\t data-dojo-attach-event\x3d"click:_destroySelf"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"askvalues"\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxAskValues" label\x3d"${nls.askForValues}" class\x3d"jimu-trailing-margin6"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxCaseSensitive" label\x3d"${nls.caseSensitive}" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"promptSection" class\x3d"prompt"\x3e\r\n\t\t\x3ctable data-dojo-attach-point\x3d"promptTable" cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"prompt-table"\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.prompt}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"promptTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"width:100%;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.hint}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"hintTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"trim:true" style\x3d"width:100%;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Calendar.html":'\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" class\x3d"dijitCalendarContainer" role\x3d"grid" aria-labelledby\x3d"${id}_mddb ${id}_year" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\x3cthead\x3e\r\n\t\t\x3ctr class\x3d"dijitReset dijitCalendarMonthContainer" valign\x3d"top"\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset dijitCalendarArrow\' data-dojo-attach-point\x3d"decrementMonth" scope\x3d"col"\x3e\r\n\t\t\t\t\x3cspan class\x3d"dijitInline dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset\' colspan\x3d"5" scope\x3d"col"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode"\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset dijitCalendarArrow\' scope\x3d"col" data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\t\x3cspan class\x3d"dijitInline dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t${!dayCellsHtml}\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/thead\x3e\r\n\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t${!dateRowsHtml}\r\n\t\x3c/tbody\x3e\r\n\t\x3ctfoot class\x3d"dijitReset dijitCalendarYearContainer"\x3e\r\n\t\t\x3ctr\x3e\r\n\t\t\t\x3ctd class\x3d\'dijitReset\' valign\x3d"top" colspan\x3d"7" role\x3d"presentation"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/tfoot\x3e\r\n\x3c/table\x3e\r\n',
"url:jimu/dijit/templates/_FilterSet.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"header-table" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.strMatchMsgPart1}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.all}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.any}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.strMatchMsgPart2}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:15px;padding-right:10px;"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_destroySelf"\r\n\t\t\t\t\t class\x3d"jimu-icon jimu-icon-delete"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:15px;padding-right:14px;"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAdd" class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/AttributeTable/css/style.css":'.jimu-widget-attributetable-main .tabStripButton{height: 24px !important;}.jimu-widget-attributetable,.jimu-widget-attributetable-main{left: 0px; bottom: 0px; background-color: #efefef;}.jimu-widget-attributetable{height: auto;}.jimu-widget-attributetable-main{overflow: hidden; width: 100%; height: 100%;}.jimu-widget-attributetable .jimu-widget-attributetable-main .dijitToolbar {position: relative;}.jimu-widget-attributetable-move{width: 100%; height: 7px; top: 0px;}.jimu-widget-attributetable-move:hover{cursor: n-resize;}.jimu-widget-attributetable-move:hover .jimu-widget-attributetable-thumb{background-color: #fff;}.jimu-widget-attributetable .draging{background-color: gray;}.jimu-widget-attributetable-thumb{background: #B0B0B0 none; height: 1px; width: 19px; margin: 3px auto; position: absolute; left: 0; right: 0;}.jimu-widget-attributetable-indicate-vertical{width: 2px; height: 100%; background-color: black; position: absolute; z-index: 1; opacity: 0;}.jimu-widget-attributetable-indicate-horizontal{width: 100%; height: 2px; background-color: black; position: absolute; z-index: 1; opacity: 0;}.jimu-widget-attributetable-switch{width: 63px; height: 17px; left: 0; right: 0; top: -17px; margin: auto; position: absolute; cursor: pointer; border-radius: 2px 2px 0 0; background-position: center; background-repeat: no-repeat;}.jimu-widget-attributetable-switch.open{background-image: url(images/arrow_down.png); border: none; border-bottom-left-radius: 0; border-bottom-right-radius: 0;}.jimu-widget-attributetable-switch.open:hover{background-image: url(images/arrow_down_hover.png);}.jimu-widget-attributetable-switch.close{background-image: url(images/arrow_up.png)}.jimu-widget-attributetable-switch.close:hover{background-image: url(images/arrow_up_hover.png);}.jimu-widget-attributetable-arrowImage{width: 30px; height: 30px; left: 48%; top: -30px; position: absolute; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; background-position: center center; background-repeat: no-repeat; cursor: ns-resize; background-color: rgba(0, 0, 0, 0.8);}.dijitTabPaneWrapper .dijitTabContainerTop-container .dijitAlignCenter{height: 100%;}.jimu-widget-attributetable .dijitTabContainerTopChildWrapper,.jimu-widget-attributetable .dijitTabContainerTopChildWrapper .dijitContentPane{height: 100% !important; width: 100% !important;}.jimu-widget-attributetable .dijitToggleButton.dijitToggleButtonChecked .dijitButtonText{font-weight: bold; color: #518dca;}.jimu-widget-attributetable .esriAttributeTable{width: 100%; height: 100%; position: relative;}.jimu-widget-attributetable .dgrid-sortable {}.jimu-widget-attributetable .dgrid-cell {border-right: solid 1px #ccc; width: 100px;}.jimu-widget-attributetable .dgrid-row .dgrid-cell {border:medium none; padding: 7px 3px; border-right: 1px solid #CCCCCC;}.jimu-rtl .jimu-widget-attributetable .dgrid-rtl-swap .dgrid-header-row {right: 0; left: 17px;}.jimu-rtl .jimu-widget-attributetable .dgrid-cell {text-align: right; border-left: solid 1px #ccc;}.jimu-widget-attributetable .dgrid-header {overflow: hidden; background-color: #eee;}.jimu-widget-attributetable .dgrid-cell a{color: #21759B; text-decoration: none;}.jimu-widget-attributetable .dgrid-cell a:hover, a:active{text-decoration: underline;}.jimu-widget-attributetable .dgrid-row {border: medium none;}.jimu-widget-attributetable .dgrid-row:hover {background-color:#E1F0FB;}.jimu-widget-attributetable .dgrid-row-even{background-color: #FFF;}.jimu-widget-attributetable .dgrid-row-odd {background-color: #F7F8F8;}.jimu-widget-attributetable .ui-state-active {background-color: #AEC7E3;}.jimu-widget-attributetable .dgrid-status {white-space: pre;}.jimu-widget-attributetable .self-footer {display: inline-block;}.jimu-rtl .dgrid-hider-menu-check{right: 2px; left: auto;}.jimu-rtl .dgrid-hider-menu-label {padding-left: 0; padding-right: 20px;}.jimu-rtl .jimu-widget-attributetable .dgrid-pagination .dgrid-status{float: right !important;}.jimu-rtl .dgrid-pagination .dgrid-navigation,.jimu-rtl .dgrid-pagination .dgrid-page-size{float: left !important;}.esriAttributeTableExportImage{background-image: url("../images/export.png"); width: 13px; height: 13px;}.esriAttributeTableZoomImage{background-image: url("../images/zoom.png"); width: 13px; height: 13px;}.esriAttributeTableSelectAllImage{background-image: url("../images/select.png"); width: 13px; height: 13px;}.esriAttributeTableFilterImage{background-image: url("../images/filter.png"); width: 13px; height: 13px;}.esriAttributeTableSelectPageImage{background-image: url("../images/page.png"); width: 13px; height: 13px;}.esriAttributeTableClearImage{background-image: url("../images/clear.png"); width: 13px; height: 13px;}.esriAttributeTableOptionsImage{background-image: url("../images/more.png"); width: 13px; height: 13px;}.esriAttributeTableRefreshImage{background-image: url("../images/refresh.png"); width: 13px; height: 13px;}.esriAttributeTableSymbolImage{background-image: url("../images/symbol.png"); width: 13px; height: 13px;}.esriAttributeTableCloseImage{background-image: url("../images/close.png"); width: 13px; height: 13px;}.esriAttributeTableColumnsImage{background-image: url("../images/columns.png"); width: 13px; height: 13px;}.jimu-widget-attributetable .jimu-widget-attributetable-main .dijitToolbar .close-button {position: absolute; right: 0;}.jimu-rtl .jimu-widget-attributetable .jimu-widget-attributetable-main .dijitToolbar .close-button {right: auto; left: 0;}.jimu-widget-attributetable .jimu-loading-indicator {z-index: 100;}.jimu-widget-attributetable .jimu-widget-attributetable-feature-table{height: 100%; position: relative;}.jimu-widget-attributetable .jimu-widget-attributetable-relationship-table{height: 100%; position: relative;}',
"url:widgets/AttributeTable/config.json":'{\r\n  "layerInfos": [],\r\n  "table": {\r\n    "pageSizeOptions": [25, 50, 100, 1000]\r\n  },\r\n  "hideExportButton": false,\r\n  "initiallyExpand": false,\r\n  "filterByMapExtent": true\r\n}',"*now":function(k){k(['dojo/i18n!*preload*widgets/AttributeTable/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/html dijit/_WidgetsInTemplateMixin jimu/BaseWidget dijit/layout/TabContainer dijit/layout/ContentPane jimu/utils jimu/dijit/Message dojo/Deferred dojo/promise/all esri/layers/FeatureLayer dojo/_base/lang dojo/on dojo/touch dojo/topic dojo/aspect dojo/_base/array dojo/query jimu/dijit/LoadingIndicator ./_ResourceManager ./_TableFunctionController ./utils".split(" "),function(k,e,q,t,p,g,m,u,h,d,s,c,l,b,a,n,f,r,x,y,z,D){k=k([t,q],{name:"AttributeTable",baseClass:"jimu-widget-attributetable",
normalHeight:0,openHeight:0,arrowDivHeight:null,_relatedDef:null,_resourceManager:null,_tableFunctionController:null,_activeLayerInfoId:null,_activeRelationshipKey:null,_layerTypes:{FEATURELAYER:"FeatureLayer",RELATIONSHIPTABLE:"RelationshipTable"},postMixInProperties:function(){this.nls.features=this.nls.features||"features"},postCreate:function(){this.inherited(arguments);m.loadStyleLink("dgrid",apiUrl+"dgrid/css/dgrid.css");this.AttributeTableDiv=this._loadInfoDef=null;this._delayedLayerInfos=
[];this.layerTabPages=[];this.relationTabPagesSet={};this.tabContainer=this.toolbarDiv=null;this.moveMode=!1;this.bottomPosition=this.toolbarHeight=this.noGridHeight=this.previousDomHeight=this.moveY=0;this.layerTabPagesIndex=-1;this.showing=!1;this.openHeight=this.normalHeight=this._getNormalHeight();this.arrowDivHeight=0;this._dragingHandlers=[];this._createUtilitiesUI();this._resourceManager=new y({map:this.map,nls:this.nls});this._resourceManager.setConfig(this.config);this._tableFunctionController=
new z({map:this.map,nls:this.nls,hideExportButton:this.config.hideExportButton,filterByMapExtent:this.config.filterByMapExtent});this._tableFunctionController.setResourceManager(this._resourceManager);this.own(a.subscribe("changeMapPosition",c.hitch(this,this._onMapPositionChange)));D.readLayerInfosObj(this.map).then(c.hitch(this,function(a){this.own(l(a,"layerInfosIsShowInMapChanged",c.hitch(this,this.onLayerInfosIsShowInMapChanged)));this.own(a.on("layerInfosChanged",c.hitch(this,this.onLayerInfosChanged)))}))},
_createUtilitiesUI:function(){this._createArrowUI();this._createBarUI()},_createArrowUI:function(){this.arrowDiv=e.create("div");e.addClass(this.arrowDiv,"jimu-widget-attributetable-move");e.create("div",{"class":"jimu-widget-attributetable-thumb"},this.arrowDiv);e.place(this.arrowDiv,this.domNode);if(!this.arrowDivHeight){var a=e.getMarginBox(this.arrowDiv);this.arrowDivHeight=a&&a.h?a.h:7}this.own(l(this.arrowDiv,"mousedown",c.hitch(this,this._onDragStart)));this.own(l(this.arrowDiv,b.press,c.hitch(this,
this._onDragStart)))},_isOnlyTable:function(){return this.closeable||!this.isOnScreen},_createBarUI:function(){this._isOnlyTable()||(this.switchBtn=e.create("div"),e.addClass(this.switchBtn,"jimu-widget-attributetable-switch"),e.place(this.switchBtn,this.domNode),this.own(l(this.switchBtn,"click",c.hitch(this,this._switchTable))))},_processOpenBarUI:function(){this._isOnlyTable()||(e.removeClass(this.switchBtn,"close"),e.addClass(this.switchBtn,"open"),e.setAttr(this.switchBtn,"title",this.nls.closeTableTip))},
_processCloseBarUI:function(){this._isOnlyTable()||(e.removeClass(this.switchBtn,"open"),e.addClass(this.switchBtn,"close"),e.setAttr(this.switchBtn,"title",this.nls.openTableTip))},_switchTable:function(){this.showing?this._closeTable():this._openTable()},_openTable:function(){this._loadInfoDef?this._loadInfoDef&&this._loadInfoDef.isFulfilled()&&(this.showing=!0,this._processDelayedLayerInfos(),this._tableFunctionController.active()):(this._loadInfoDef=new h,this.own(this._loadInfoDef),this.loading||
(this.loading=new x),this.loading.placeAt(this.domNode),this.loading.show(),this._resourceManager.updateLayerInfoResources(!0).then(c.hitch(this,function(){this.domNode&&(this._init(),this.showRefreshing(!1),this.showing=!0,this._loadInfoDef.resolve())}),c.hitch(this,function(a){console.error(a);this._loadInfoDef.reject(a)})));this._changeHeight(this.openHeight);this._processOpenBarUI();return this._loadInfoDef},_onCloseBtnClicked:function(){this.showing&&this._isOnlyTable()?this.widgetManager.closeWidget(this):
this.showing&&this._closeTable();this._tableFunctionController.deactive()},_closeTable:function(){this._changeHeight(0);this.showRefreshing(!1);this._processCloseBarUI();this._tableFunctionController.deactive();this.showing=!1;e.setStyle(this.arrowDiv,"display","none");e.setStyle(this.domNode,"overflow","hidden");setTimeout(c.hitch(this,function(){e.setStyle(this.domNode,"overflow","visible");e.setStyle(this.arrowDiv,"display","block")}),10)},_init:function(){this.initDiv();this._changeHeight(this.openHeight);
this.resize();this.own(l(window.document,"mouseup",c.hitch(this,this._onDragEnd)));this.own(l(window.document,"mousemove",c.hitch(this,this._onDraging)));this.own(l(window.document,b.move,c.hitch(this,this._onDraging)));this.own(l(window.document,b.release,c.hitch(this,this._onDragEnd)))},_processDelayedLayerInfos:function(){0<this._delayedLayerInfos.length&&(f.forEach(this._delayedLayerInfos,c.hitch(this,function(a){this._resourceManager.addLayerInfo(a)})),this._delayedLayerInfos=[])},onLayerInfosIsShowInMapChanged:function(){this._tableFunctionController.checkMapInteractiveFeature()},
onLayerInfosChanged:function(a,b,d){d&&a&&("added"===b?d.getSupportTableInfo().then(c.hitch(this,function(a){a.isSupportedLayer&&this._resourceManager.addLayerInfo(d)})):"removed"===b&&(a=d.id,this.getExistLayerTabPage(a)&&this.layerTabPageClose(a,!0)))},destroy:function(){if(!this._destroyed){var a,b;if(this.layerTabPages&&0<this.layerTabPages.length){a=this.layerTabPages.length;for(b=0;b<a;b++)this.layerTabPages[b].destroy();this.layerTabPages=null}if(this.relationTabPagesSet){for(var c in this.relationTabPagesSet)this.relationTabPagesSet[c]&&
this.relationTabPagesSet[c].destroy();this.relationTabPagesSet=null}this.tabContainer&&(this.tabContainer.destroy(),this.tabContainer=null);this._tableFunctionController&&this._tableFunctionController.destroy();this._loadInfoDef=this.AttributeTableDiv=null;this._resourceManager&&this._resourceManager.empty();this.inherited(arguments)}},onOpen:function(){!this.showing&&this._isOnlyTable()&&this._openTable()},onClose:function(){this.showing&&this._closeTable()},_changeHeight:function(b){e.setStyle(this.domNode,
"height",b+"px");this.tabContainer&&(this.tabContainer.domNode&&0<=b-this.toolbarHeight-this.arrowDivHeight)&&e.setStyle(this.tabContainer.domNode,"height",b-this.toolbarHeight-this.arrowDivHeight+"px");this._tableFunctionController.changeHeight(b-this.noGridHeight);a.publish("changeMapPosition",{bottom:b+this.bottomPosition});0!==b&&(this.openHeight=b>=this.arrowDivHeight+this.toolbarHeight?b:this.normalHeight)},_onMapPositionChange:function(a){isFinite(a.left)&&"number"===typeof a.left&&(window.isRTL?
e.setStyle(this.domNode,"right",parseFloat(a.left)+"px"):e.setStyle(this.domNode,"left",parseFloat(a.left)+"px"));isFinite(a.right)&&"number"===typeof a.right&&(window.isRTL?e.setStyle(this.domNode,"left",parseFloat(a.right)+"px"):e.setStyle(this.domNode,"right",parseFloat(a.right)+"px"));this.tabContainer&&this.tabContainer.resize()},setPosition:function(a){this.position=a;this._isOnlyTable()?this.bottomPosition=0:this.bottomPosition="bottom"in a?parseInt(a.bottom,10):0;if(!this.domNode.parentNode||
this.domNode.parentNode.id!==window.jimuConfig.layoutId)e.place(this.domNode,window.jimuConfig.layoutId),this.setInitialPosition(a),this.showRefreshing(!1);e.setStyle(this.domNode,"bottom",this.bottomPosition+"px");!this._resourceManager.isEmpty()&&this.toolbarDiv&&setTimeout(c.hitch(this,function(){var a=e.getStyle(this.toolbarDiv,"height"),b=this._getGridTopSectionHeight(),c=e.getStyle(this.domNode,"height");0<a&&(this.toolbarHeight=a);0<b&&(this.noGridHeight=b);0<c&&this._changeHeight(c)}),20)},
_startQueryOnLayerTab:function(a){var b=this._resourceManager.getLayerInfoById(a),d=this.getExistLayerTabPage(a);b&&d&&(this.showRefreshing(!0),this._resourceManager.getQueryTable(a).then(c.hitch(this,function(b){this._activeLayerInfoId===a&&b&&(d=this.getExistLayerTabPage(a),b.isSupportQuery?(b=b.table,b.getParent()!==d&&b.placeAt(d),this._tableFunctionController.setActiveTable(b,{h:this.openHeight-this.noGridHeight})):(b=e.toDom("\x3cdiv\x3e"+this.nls.unsupportQueryWarning+"\x3c/div\x3e"),d.set("content",
b),this._tableFunctionController.resetButtonStatus()),this.showRefreshing(!1))}),c.hitch(this,function(a){new u({message:a.message||a});this.showRefreshing(!1)})))},_startQueryOnRelationTab:function(a,b,d){var e=this._resourceManager.getLayerInfoById(d),f=this.getExistRelationTabPage(a);e&&e.layerObject&&f&&this._resourceManager.getRelationTable(d,a).then(c.hitch(this,function(c){this._activeRelationshipKey===a&&c&&(c.getParent()!==f&&c.placeAt(f),this._tableFunctionController.setActiveTable(c,{h:this.openHeight-
this.noGridHeight,layer:e.layerObject,selectedIds:b}))}))},tabChanged:function(){if(this.tabContainer&&this.tabContainer.selectedChildWidget){0>=this.noGridHeight&&(this.noGridHeight=this._getGridTopSectionHeight()+5);var a=this.tabContainer.selectedChildWidget.params.layerType,b=this.tabContainer.selectedChildWidget.params.paneId;if(a===this._layerTypes.FEATURELAYER&&this._activeLayerInfoId!==b)this._tableFunctionController.setActiveTable(null),this._activeRelationshipKey=null,this._activeLayerInfoId=
b,this._startQueryOnLayerTab(b);else if(a===this._layerTypes.RELATIONSHIPTABLE){this._tableFunctionController.setActiveTable(null);var c=this.tabContainer.selectedChildWidget.params,a=c.oids,c=c.originalInfoId;this._activeRelationshipKey=b;this._activeLayerInfoId=null;this._startQueryOnRelationTab(b,a,c)}}},showRefreshing:function(a){this.loading&&(a?this.loading.show():this.loading.hide())},_onDragStart:function(a){this.moveMode=!0;this.moveY=a.clientY;this.previousDomHeight=e.getStyle(this.domNode,
"height");e.addClass(this.arrowDiv,"draging");this._dragingHandlers=this._dragingHandlers.concat([l(this.ownerDocument,"dragstart",function(a){a.stopPropagation();a.preventDefault()}),l(this.ownerDocumentBody,"selectstart",function(a){a.stopPropagation();a.preventDefault()})])},_onDraging:function(a){this.moveMode&&125<=a.clientY&&this._changeHeight(this.moveY-a.clientY+this.previousDomHeight)},_onDragEnd:function(){this.moveMode=!1;e.removeClass(this.arrowDiv,"draging");for(var a=this._dragingHandlers.pop();a;)a.remove(),
a=this._dragingHandlers.pop()},_getNormalHeight:function(){var a=document.body.clientHeight;return window.appInfo.isRunInMobile?a/2:a/3},setInitialPosition:function(){e.setStyle(this.domNode,"top","auto");e.setStyle(this.domNode,"left","0px");e.setStyle(this.domNode,"right","0px");e.setStyle(this.domNode,"position","absolute");this._isOnlyTable()||(this.config&&this.config.initiallyExpand?this._openTable():this._closeTable())},initDiv:function(){this.AttributeTableDiv=e.create("div",{},this.domNode);
e.addClass(this.AttributeTableDiv,"jimu-widget-attributetable-main");var a=e.create("div");this.toolbarDiv=a;e.place(a,this.AttributeTableDiv);e.place(this._tableFunctionController.domNode,a);this._tableFunctionController.startup();this.own(l(this._tableFunctionController,"show-related-records",c.hitch(this,"_showRelatedRecords")));this.own(l(this._tableFunctionController,"click-close",c.hitch(this,"_onCloseBtnClicked")));var b=e.create("div");e.place(b,this.AttributeTableDiv);this.toolbarHeight=
a=e.getStyle(a,"height");this.tabContainer=new p({style:"width: 100%;"},b);e.setStyle(this.tabContainer.domNode,"height",this.normalHeight-a+"px");for(var b=this._resourceManager.getConfigInfos(),a=b.length,d=0;d<a;d++){var f=b[d];if(f.show){var f=c.clone(f),h={};h.paneId=f.id;h.title=f.name;h.name=f.name;h.layerType=this._layerTypes.FEATURELAYER;h.style="height: 100%; width: 100%; overflow: visible;";f=new g(h);this.layerTabPages[d]=f;this.tabContainer.addChild(f)}}this.tabContainer.startup();0<
a&&(this.noGridHeight=this._getGridTopSectionHeight()+5);m.setVerticalCenter(this.tabContainer.domNode);this.tabChanged();this.own(n.after(this.tabContainer,"selectChild",c.hitch(this,this.tabChanged)))},getLayerInfoLabel:function(a){return a.name||a.title},getLayerInfoId:function(a){return a&&a.id||""},_getGridTopSectionHeight:function(){var a=r(".dijitTabPaneWrapper",this.domNode)[0];if(a){var b=e.position(this.domNode).y;return e.position(a).y-b}return 0},_getLayerInfoByIdFromConfigJSON:function(a){var b=
f.filter(this.config.layerInfos,function(b){return b.id===a});return b&&0<b.length&&b[0]},_showRelatedRecords:function(){var a=this._tableFunctionController.getActiveTable();if(a){var b=a.layerInfo;if(b&&b.layerObject)for(var c=b.layerObject.relationships,a=a.getSelectedRows(),d=0,e=c.length;d<e;d++)this.addNewRelationTab(a,c[d],b.id)}},addNewLayerTab:function(a){var b=this._resourceManager.getLayerInfoById(a);b&&((a=this.getExistLayerTabPage(a))?(this.onOpen(),this.tabContainer.selectChild(a)):(this._resourceManager.addConfigInfo(b),
this.onOpen(),a={},a.title=this.getLayerInfoLabel(b),a.name=a.title,a.paneId=this.getLayerInfoId(b),a.closable=!0,a.layerType=this._layerTypes.FEATURELAYER,a.style="height: 100%; width: 100%; overflow: visible",b=new g(a),this.layerTabPages.push(b),b.set("title",a.name),this.own(l(b,"close",c.hitch(this,this.layerTabPageClose,a.paneId,!0))),this.tabContainer.addChild(b),this.tabContainer.selectChild(b)))},addNewRelationTab:function(a,b,d){var e=this.getExistRelationTabPage(b._relKey);e?(e.params.oids=
a,this.tabContainer.selectChild(e)):(e={},e.oids=a,e.title=b.name,e.name=e.title,e.paneId=b._relKey,e.originalInfoId=d,e.closable=!0,e.layerType=this._layerTypes.RELATIONSHIPTABLE,e.style="height: 100%; width: 100%; overflow: visible",a=new g(e),this.relationTabPagesSet[b._relKey]=a,a.set("title",e.name),this.own(l(a,"close",c.hitch(this,this.relationTabPageClose,e.paneId))),this.tabContainer.addChild(a),this.tabContainer.selectChild(a))},onReceiveData:function(a,b,d){d&&"AttributeTable"===d.target&&
(this._isOnlyTable()&&"closed"===this.state?console.warn("Please open Attribute Table!"):this.showing?this._resourceManager.updateLayerInfoResources(!1).then(c.hitch(this,function(){this._addLayerToTable(d)})):this._openTable().then(c.hitch(this,function(){this._resourceManager.getLayerInfoById(d.layer.id)?this._addLayerToTable(d):this._resourceManager.updateLayerInfoResources(!1).then(c.hitch(this,function(){this._addLayerToTable(d)}))})))},_addLayerToTable:function(a){var b=null;if(c.getObject("layer.id",
!1,a)){var d=this._resourceManager.getLayerInfoById(a.layer.id);d.getLayerObject().then(c.hitch(this,function(e){e?(e.id=a.layer.id,e.loaded?this.addNewLayerTab(d.id):this.own(l(e,"load",c.hitch(this,this.addNewLayerTab,d.id)))):a.url&&(b=new s(a.url),this.own(l(b,"load",c.hitch(this,this.addNewLayerTab,d.id))))}),c.hitch(this,function(a){new u({message:a.message||a})}))}},getExistLayerTabPage:function(a){for(var b=this.layerTabPages.length,c=0;c<b;c++)if(this.layerTabPages[c]&&this.layerTabPages[c].get("paneId")===
a)return this.layerTabPages[c];return null},getExistRelationTabPage:function(a){return this.relationTabPagesSet[a]},layerTabPageClose:function(a,b){for(var c=this.layerTabPages.length,d=0;d<c;d++)if(this.layerTabPages[d]&&this.layerTabPages[d].paneId===a){!0===b&&this.tabContainer.removeChild(this.layerTabPages[d]);this.layerTabPages&&this.layerTabPages[d]&&(this.layerTabPages[d].destroyRecursive(),this.layerTabPages.splice(d,1));this._resourceManager.removeConfigInfo(a);this._resourceManager.removeLayerInfo(a);
if(1===c){this.onClose();break}else a===this._activeLayerInfoId&&this.tabContainer.selectChild(this.layerTabPages[c-2]);break}},relationTabPageClose:function(a){var b=this.getExistRelationTabPage(a);b&&(this.tabContainer.removeChild(b),this._resourceManager.removeRelationTable(a),b&&(b.destroyDescendants(),b.destroy(),this.relationTabPagesSet[a]=null),this._activeRelationshipKey=null)},_processRelatedRecordsFromPopup:function(a,b){if(a){var e=[];e.push(a.getLayerObject());e.push(a.getRelatedTableInfoArray());
d(e).then(c.hitch(this,function(c){if(c){var d=c[0];this._resourceManager.collectRelationShips(a,c[1]);c=d.relationships;for(var d=0,e=c.length;d<e;d++)this.addNewRelationTab(b,c[d],a.id)}}))}},showRelatedRecordsFromPopup:function(a,b){this.showing?this._resourceManager.updateLayerInfoResources(!1).then(c.hitch(this,function(){this._processRelatedRecordsFromPopup(a,b)})):this._openTable().then(c.hitch(this,function(){this._resourceManager.getLayerInfoById(a.id)?this._processRelatedRecordsFromPopup(a,
b):this._resourceManager.updateLayerInfoResources(!1).then(c.hitch(this,function(){this._processRelatedRecordsFromPopup(a,b)}))}))}});k.inPanel=!1;k.hasUIFile=!1;return k});