// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/_QueryableLayerSourcePopup":function(){define("dojo/_base/declare dojo/Evented dojo/on dojo/_base/lang dojo/_base/html jimu/dijit/Popup jimu/dijit/QueryableLayerSource jimu/dijit/LoadingIndicator esri/request".split(" "),function(l,q,t,s,g,c,d,e,b){return l([c,q],{width:830,height:560,titleLabel:"",dijitArgs:null,postCreate:function(){this.inherited(arguments);g.addClass(this.domNode,"jimu-queryable-layer-source-popup");this._initFls();this._initLoading()},getSelectedRadioType:function(){return this.sourceDijit.getSelectedRadioType()},
_initFls:function(){this.sourceDijit=new d(this.dijitArgs);this.sourceDijit.placeAt(this.contentContainerNode);this.sourceDijit.startup();this.own(t(this.sourceDijit,"ok",s.hitch(this,function(c){if(0!==c.length){var e=c[0];if(e.definition)try{e.definition.name=e.name,e.definition.url=e.url,this.emit("ok",e)}catch(d){console.error(d)}else this.loading.show(),b({url:e.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(s.hitch(this,function(b){if(this.domNode){this.loading.hide();
e.definition=b;try{e.definition.name=e.name,e.definition.url=e.url,this.emit("ok",e)}catch(a){console.error(a)}}}),s.hitch(this,function(b){console.error(b);this.domNode&&this.loading.hide()}))}})));this.own(t(this.sourceDijit,"cancel",s.hitch(this,function(){try{this.emit("cancel")}catch(b){console.error(b)}})))},_initLoading:function(){this.loading=new e({hidden:!0});this.loading.placeAt(this.domNode);this.loading.startup()}})})},"jimu/dijit/QueryableLayerSource":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/QueryableLayerSource.html dojo/_base/lang dojo/_base/html dojo/on dojo/Evented jimu/dijit/QueryableLayerChooserFromMap jimu/dijit/QueryableServiceChooserFromPortal jimu/dijit/_QueryableServiceChooserContent jimu/portalUrlUtils".split(" "),
function(l,q,t,s,g,c,d,e,b,h,n,r,u){var a=l([q,t,s,b],{baseClass:"jimu-layer-chooser-with-buttons jimu-queryable-layer-chooser-with-buttons",declaredClass:"jimu.dijit.QueryableLayerChooserWithButtons",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"chooser-container" data-dojo-attach-point\x3d"chooserContainer"\x3e\x3c/div\x3e\x3cdiv class\x3d"footer"\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.cancel}\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1 jimu-state-disabled" data-dojo-attach-point\x3d"btnOk"\x3e${nls.ok}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
queryableLayerChooserArgs:null,postMixInProperties:function(){this.nls=c.clone(window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.queryableLayerChooserFromMap=new h(this.queryableLayerChooserArgs);this.queryableLayerChooserFromMap.placeAt(this.chooserContainer);d.setStyle(this.queryableLayerChooserFromMap.domNode,{width:"100%",height:"100%"});this.own(e(this.queryableLayerChooserFromMap,"tree-click",c.hitch(this,function(){0<this.getSelectedItems().length?d.removeClass(this.btnOk,
"jimu-state-disabled"):d.addClass(this.btnOk,"jimu-state-disabled")})));this.own(e(this.btnOk,"click",c.hitch(this,function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)})));this.own(e(this.btnCancel,"click",c.hitch(this,function(){this.emit("cancel")})))},getSelectedItems:function(){return this.queryableLayerChooserFromMap.getSelectedItems()},startup:function(){this.inherited(arguments);this.queryableLayerChooserFromMap.startup()}});return l([q,t,s,b],{templateString:g,baseClass:"jimu-layer-source jimu-queryable-layer-source",
declaredClass:"jimu.dijit.QueryableLayerSource",nls:null,multiple:!1,createMapResponse:null,portalUrl:null,postMixInProperties:function(){this.nls=window.jimuNls.queryableLayerSource;this.portalUrl=u.getStandardPortalUrl(this.portalUrl)},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedRadioType:function(){if(this.mapRadio.checked)return"map";if(this.portalRadio.checked)return"portal";if(this.urlRadio.checked)return"url"},getSelectedItems:function(){var a=[];this.mapRadio.checked?
a=this.queryableLayerChooserFromMap.getSelectedItems():this.portalRadio.checked?a=this.queryableServiceChooserFromPortal.getSelectedItems():this.urlRadio.checked&&(a=this.queryableServiceChooserContent.getSelectedItems());return a},startup:function(){this.inherited(arguments);this.queryableLayerChooserFromMap.startup();this.queryableServiceChooserFromPortal.startup();this.queryableServiceChooserContent.startup()},_initSelf:function(){this._initRadios();this._createQueryableLayerChooserWithButtons();
this._createQueryableServiceChooserFromPortal();this._createQueryableServiceChooserContent();this._onRadioClicked()},_createQueryableLayerChooserWithButtons:function(){this.queryableLayerChooserFromMap=new a({style:{width:"100%",height:"100%"},queryableLayerChooserArgs:{multiple:this.multiple,createMapResponse:this.createMapResponse}});this.queryableLayerChooserFromMap.operationTip=this.nls.selectLayer;this.queryableLayerChooserFromMap.placeAt(this.mapDijitContainer);this.own(e(this.queryableLayerChooserFromMap,
"ok",c.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(e(this.queryableLayerChooserFromMap,"cancel",c.hitch(this,function(){this.emit("cancel")})))},_createQueryableServiceChooserFromPortal:function(){this.queryableServiceChooserFromPortal=new n({multiple:this.multiple,portalUrl:this.portalUrl,style:{width:"100%",height:"100%"}});this.queryableServiceChooserFromPortal.operationTip=this.nls.chooseItem;this.queryableServiceChooserFromPortal.placeAt(this.portalDijitContainer);this.own(e(this.queryableServiceChooserFromPortal,
"next",c.hitch(this,function(){this.queryableServiceChooserFromPortal.operationTip=this.nls.chooseItem+" -\x3e "+this.nls.chooseLayer;this._updateOperationTip()})));this.own(e(this.queryableServiceChooserFromPortal,"back",c.hitch(this,function(){this.queryableServiceChooserFromPortal.operationTip=this.nls.chooseItem;this._updateOperationTip()})));this.own(e(this.queryableServiceChooserFromPortal,"ok",c.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(e(this.queryableServiceChooserFromPortal,
"cancel",c.hitch(this,function(){this.emit("cancel")})));0<=(this.portalUrl||"").toLowerCase().indexOf(".arcgis.com")?this.portalLabel.innerHTML=this.nls.selectFromOnline:this.portalLabel.innerHTML=this.nls.selectFromPortal},_createQueryableServiceChooserContent:function(){this.queryableServiceChooserContent=new r({multiple:this.multiple,style:{width:"100%",height:"100%"}});this.queryableServiceChooserContent.operationTip=this.nls.setServiceUrl;this.queryableServiceChooserContent.placeAt(this.urlDijitContainer);
this.own(e(this.queryableServiceChooserContent,"ok",c.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(e(this.queryableServiceChooserContent,"cancel",c.hitch(this,function(){this.emit("cancel")})))},_initRadios:function(){var a="queryableLayerSourceRadios_"+this._getRandomString();this.mapRadio.name=a;d.setAttr(this.mapRadio,"id","mapRadio_"+this._getRandomString());d.setAttr(this.mapLabel,"for",this.mapRadio.id);this.portalRadio.name=a;d.setAttr(this.portalRadio,"id","portalRadio_"+
this._getRandomString());d.setAttr(this.portalLabel,"for",this.portalRadio.id);this.urlRadio.name=a;d.setAttr(this.urlRadio,"id","urlRadio_"+this._getRandomString());d.setAttr(this.urlLabel,"for",this.urlRadio.id)},_getRandomString:function(){var a=Math.random().toString();return a=a.slice(2,a.length)},_onRadioClicked:function(){d.setStyle(this.mapDijitContainer,"display","none");d.setStyle(this.portalDijitContainer,"display","none");d.setStyle(this.urlDijitContainer,"display","none");this.mapRadio.checked?
(d.setStyle(this.mapDijitContainer,"display","block"),this.operationTip.innerHTML=this.nls.selectLayer):this.portalRadio.checked?(d.setStyle(this.portalDijitContainer,"display","block"),this.operationTip.innerHTML=this.nls.chooseItem):this.urlRadio.checked&&(d.setStyle(this.urlDijitContainer,"display","block"),this.operationTip.innerHTML=this.nls.setServiceUrl);this._updateOperationTip()},_updateOperationTip:function(){this.mapRadio.checked?this.operationTip.innerHTML=this.queryableLayerChooserFromMap.operationTip:
this.portalRadio.checked?this.operationTip.innerHTML=this.queryableServiceChooserFromPortal.operationTip:this.urlRadio.checked&&(this.operationTip.innerHTML=this.queryableServiceChooserContent.operationTip)}})})},"jimu/dijit/QueryableLayerChooserFromMap":function(){define(["dojo/_base/declare","./LayerChooserFromMap","dojo/_base/html"],function(l,q,t){return l([q],{baseClass:"jimu-queryable-layer-chooser-from-map",declaredClass:"jimu.dijit.QueryableLayerChooserFromMap",postMixInProperties:function(){this.inherited(arguments);
this.filter=q.createQueryableLayerFilter()},postCreate:function(){this.inherited(arguments);t.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},getHandledItem:function(l){var g=this.inherited(arguments),c=l&&l.layerInfo,c=c&&c.layerObject;g.url=c&&c.url||"";return g}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/on dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(l,q,t,s,g,c,d,e,b,h,n,r,u,a,v,k,f,p){var m=l([q,t,s,g],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,postMixInProperties:function(){this.nls=
window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);u.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new p({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},filter:function(a){a=new e;a.resolve(!0);return a},getSelectedItems:function(){var f=this.tree.getSelectedItems();return a.map(f,r.hitch(this,
function(a){return this.getHandledItem(a)}))},getAllItems:function(){var f=this.tree.getAllItems(),m=[];a.forEach(f,r.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),m.push(a))}));return m},getHandledItem:function(a){return{name:a.name,layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(a){this.createMapResponse=a;f.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(r.hitch(this,function(a){this.layerInfosObj=a;this.own(c(this.layerInfosObj,
"layerInfosChanged",r.hitch(this,this._onLayerInfosChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(a,f){this._buildTree(this.layerInfosObj)},_buildTree:function(f){this._clear();u.setStyle(this.errorTipSection,"display","block");var m=f.getLayerInfoArray(),m=m.concat(f.getTableInfoArray());0!==m.length&&(u.setStyle(this.errorTipSection,"display","none"),a.forEach(m,r.hitch(this,function(a){this._addDirectLayerInfo(a)})))},_addDirectLayerInfo:function(a){a&&a.getLayerObject().then(r.hitch(this,
function(){this._addItem("root",a)}),r.hitch(this,function(a){console.error(a)}))},_clear:function(){var f=this._store.query({parent:"root"});a.forEach(f,r.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_addItem:function(f,m){var p=null,b=m.getLayerType(),k=this.filter(m);n({layerType:b,valid:k}).then(r.hitch(this,function(b){if(b.valid){var k=r.hitch(this,function(a,k){this._id++;p={name:m.title||"",parent:f,layerInfo:m,type:b.layerType,layerClass:m.layerObject.declaredClass,
id:this._id.toString(),isLeaf:a,hasChildren:k};this._store.add(p)}),c=m.getSubLayers(),e=0===c.length;e?k(e,!1):(c=a.map(c,r.hitch(this,function(a){return this.filter(a)})),n(c).then(r.hitch(this,function(f){(f=a.some(f,function(a){return a}))&&k(e,f)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var a=this._getRootItem(),a=new d({data:[a],getChildren:function(a){return this.query({parent:a.id})}});this._store=new b(a);
a=new h({store:this._store,query:{id:"root"},mayHaveChildren:r.hitch(this,this._mayHaveChildren)});this.tree=new k({multiple:this.multiple,model:a,showRoot:!1,isLeafItem:r.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:r.hitch(this,function(a,f){"root"!==a.id&&this._onTreeOpen(a,f)}),onClick:r.hitch(this,function(a,f,m){this._onTreeClick(a,f,m);this.emit("tree-click",a,f,m)}),getIconStyle:r.hitch(this,function(a,f){var m=null;if(!a||"root"===a.id)return null;var p={width:"20px",height:"20px",
backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},b=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),k=this._getIconImageName(a,f);k&&(p.backgroundImage="url("+b+"/css/images/"+k+")",m=p);return m})});u.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},_getIconImageName:function(a,f){var m="";if("ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===
a.type)m=f?"mapserver_open.png":"mapserver_close.png";else if("GroupLayer"===a.type)m=f?"group_layer2.png":"group_layer1.png";else if("FeatureLayer"===a.type){var p=v.getTypeByGeometryType(a.layerInfo.layerObject.geometryType);"point"===p?m="point_layer1.png":"polyline"===p?m="line_layer1.png":"polygon"===p&&(m="polygon_layer1.png")}else m="Table"===a.type?"table.png":"ArcGISImageServiceLayer"===a.type||"ArcGISImageServiceVectorLayer"===a.type?"image_layer.png":f?"mapserver_open.png":"mapserver_close.png";
return m},_onTreeOpen:function(f,m){if("root"!==f.id){var p=[],b=[],p=f.layerInfo.getSubLayers();f.checked||(this.shelter.show(),b=a.map(p,r.hitch(this,function(a){return a.getLayerObject()})),n(b).then(r.hitch(this,function(){this.domNode&&(a.forEach(p,r.hitch(this,function(a){this._addItem(f.id,a)})),f.checked=!0,this.shelter.hide())}),r.hitch(this,function(a){console.error(a);this.shelter.hide()})))}},_onTreeClick:function(a,f,m){},destroy:function(){this.shelter&&this.shelter.destroy();this.tree&&
this.tree.destroy();this.shelter=null;this.tree.destroy();this.inherited(arguments)}});m.createFilterByLayerType=function(a){r.isArrayLike(a)||(a=[]);return function(f){var m=new e;if(0===a.length)m.resolve(!0);else{var p=[];f.traversal(function(a){p.push(a.getLayerType())});n(p).then(function(f){for(var p=0;p<f.length;p++)for(var b=0;b<a.length;b++)if(f[p]===a[b]){m.resolve(!0);return}m.resolve(!1)},function(a){console.error(a);m.reject(a)})}return m}};m.createFeaturelayerFilter=function(f,m,p){var b=
["point","polyline","polygon"];f&&0<f.length?(f=a.filter(f,function(a){return 0<=b.indexOf(a)}),0===f.length&&(f=b)):f=b;return function(b){var k=new e,c=b.getLayerType();b=b.getLayerObject();n({layerType:c,layerObject:b}).then(function(b){var c=b.layerType;b=b.layerObject;"ArcGISDynamicMapServiceLayer"===c?k.resolve(!0):"ArcGISTiledMapServiceLayer"===c?k.resolve(!0):"GroupLayer"===c?k.resolve(!0):"FeatureCollection"===c?k.resolve(!0):"FeatureLayer"===c?(c=v.getTypeByGeometryType(b.geometryType),
c=0<=a.indexOf(f,c),b.url?(b=v.isFeaturelayerUrlSupportQuery(b.url,b.capabilities),k.resolve(c&&b)):k.resolve(m&&c)):"Table"===c?(b=v.isFeaturelayerUrlSupportQuery(b.url,b.capabilities),k.resolve(p&&b)):k.resolve(!1)},function(a){console.log(a);k.reject(a)});return k}};m.createImageServiceLayerFilter=function(a){return function(f){var m=new e,b=f.getLayerType();f=f.getLayerObject();n({layerType:b,layerObject:f}).then(function(f){var b=f.layerType;"ArcGISImageServiceLayer"===b||"ArcGISImageServiceVectorLayer"===
b?a?v.isImageServiceSupportQuery(f.layerObject.capabilities)?m.resolve(!0):m.resolve(!1):m.resolve(!0):m.resolve(!1)},function(a){console.log(a);m.reject(a)});return m}};m.createQueryableLayerFilter=function(){var a=m.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0),f=m.createImageServiceLayerFilter(!0);return m.orCombineFilters([a,f])};m.andCombineFilters=function(a){return m._combineFilters(a,!0)};m.orCombineFilters=function(a){return m._combineFilters(a,!1)};m._combineFilters=function(f,
m){return function(b){var p=new e,k=a.map(f,function(a){return a(b)});n(k).then(function(f){var b=!1,b=m?a.every(f,function(a){return a}):a.some(f,function(a){return a});p.resolve(b)},function(a){console.error(a);p.reject(a)});return p}};return m})},"dojo/store/Observable":function(){define(["../_base/kernel","../_base/lang","../when","../_base/array"],function(l,q,t,s){l=function(g){function c(b,c){var e=g[b];e&&(g[b]=function(a){var d;"put"===b&&(d=g.getIdentity(a));if(h)return e.apply(this,arguments);
h=!0;try{var k=e.apply(this,arguments);t(k,function(f){c("object"==typeof f&&f||a,d)});return k}finally{h=!1}})}var d=[],e=0;g=q.delegate(g);g.notify=function(b,c){e++;for(var h=d.slice(),a=0,v=h.length;a<v;a++)h[a](b,c)};var b=g.query;g.query=function(c,h){h=h||{};var u=b.apply(this,arguments);if(u&&u.forEach){var a=q.mixin({},h);delete a.start;delete a.count;var v=g.queryEngine&&g.queryEngine(c,a),k=e,f=[],p;u.observe=function(a,b){1==f.push(a)&&d.push(p=function(a,m){t(u,function(p){var c=p.length!=
h.count,d,n;if(++k!=e)throw Error("Query is out of date, you must observe() the query prior to any data modifications");var u,l=-1,w=-1;if(void 0!==m){d=0;for(n=p.length;d<n;d++){var q=p[d];if(g.getIdentity(q)==m){u=q;l=d;(v||!a)&&p.splice(d,1);break}}}if(v){if(a&&(v.matches?v.matches(a):v([a]).length))d=-1<l?l:p.length,p.splice(d,0,a),w=s.indexOf(v(p),a),p.splice(d,1),h.start&&0==w||!c&&w==p.length?w=-1:p.splice(w,0,a)}else a&&(void 0!==m?w=l:h.start||(w=g.defaultIndex||0,p.splice(w,0,a)));if((-1<
l||-1<w)&&(b||!v||l!=w)){c=f.slice();for(d=0;p=c[d];d++)p(a||u,l,w)}})});var c={};c.remove=c.cancel=function(){var b=s.indexOf(f,a);-1<b&&(f.splice(b,1),f.length||d.splice(s.indexOf(d,p),1))};return c}}return u};var h;c("put",function(b,c){g.notify(b,c)});c("add",function(b){g.notify(b)});c("remove",function(b){g.notify(void 0,b)});return g};q.setObject("dojo.store.Observable",l);return l})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),
function(l,q,t,s,g,c,d){return t("dijit.tree.ObjectStoreModel",d,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(c){g.mixin(this,c);this.childrenCache={}},getRoot:function(e,b){if(this.root)e(this.root);else{var d=this.store.query(this.query);d.then&&this.own(d);c(d,g.hitch(this,function(b){if(1!=b.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+b.length+" items, but must return exactly one");this.root=b[0];e(this.root);d.observe&&d.observe(g.hitch(this,
function(b){this.onChange(b)}),!0)}),b)}},mayHaveChildren:function(){return!0},getChildren:function(e,b,d){var n=this.store.getIdentity(e);if(this.childrenCache[n])c(this.childrenCache[n],b,d);else{var r=this.childrenCache[n]=this.store.getChildren(e);r.then&&this.own(r);r.observe&&this.own(r.observe(g.hitch(this,function(b,a,d){this.onChange(b);a!=d&&c(r,g.hitch(this,"onChildrenChange",e))}),!0));c(r,b,d)}},isItem:function(){return!0},getIdentity:function(c){return this.store.getIdentity(c)},getLabel:function(c){return c[this.labelAttr]},
newItem:function(c,b,d,n){return this.store.put(c,{parent:b,before:n})},pasteItem:function(c,b,d,n,r,u){var a=new s;if(b===d&&!n&&!u)return a.resolve(!0),a;b&&!n?this.getChildren(b,g.hitch(this,function(v){v=[].concat(v);var k=l.indexOf(v,c);v.splice(k,1);this.onChildrenChange(b,v);a.resolve(this.store.put(c,{overwrite:!0,parent:d,oldParent:b,before:u}))})):a.resolve(this.store.put(c,{overwrite:!0,parent:d,oldParent:b,before:u}));return a},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},
"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),function(l,q,t,s,g,c,d,e,b,h,n,r,u,a,v){var k=l([a._TreeNode,r],{templateString:s,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);c.addClass(this.domNode,"jimu-tree-node");
this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=c.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=c.toDom('\x3cinput type\x3d"checkbox" /\x3e');c.addClass(this.checkNode,"jimu-tree-check-node");c.place(this.checkNode,this.contentNode,"first");this.own(n(this.checkNode,"click",g.hitch(this,this._onClick)));this.isLeaf?this.groupId?c.setStyle(this.checkNode,"display","none"):c.setStyle(this.checkNode,"display","inline"):c.setStyle(this.checkNode,"display",
"none");this.isLeaf?c.addClass(this.domNode,"jimu-tree-leaf-node"):c.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&(this.checkNode.checked=!0,c.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,c.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?
this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(g.hitch(this,function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return l([a,r],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+v.getRandomString()},
postCreate:function(){this.inherited(arguments);c.addClass(this.domNode,"jimu-tree");this.own(h.before(this,"onClick",g.hitch(this,this._jimuBeforeClick)));this.rootLoadingIndicator&&c.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0},removeItem:function(a){this.model.store.remove(a)},getAllItems:function(){var a=this.getAllTreeNodeWidgets();return d.map(a,g.hitch(this,function(a){var f=a.item;f.selected=a.checkNode.checked;return f}))},getSelectedItems:function(){var a=
this.getAllTreeNodeWidgets(),a=d.filter(a,g.hitch(this,function(a){return a.checkNode.checked}));return d.map(a,g.hitch(this,function(a){return a.item}))},getFilteredItems:function(a){var b=this.getAllTreeNodeWidgets(),b=d.map(b,g.hitch(this,function(a){var f=a.item;f.selected=a.checkNode.checked;return f}));return d.filter(b,g.hitch(this,function(b){return a(b)}))},getTreeNodeByItemId:function(a){for(var b=this._getAllTreeNodeDoms(),m=0;m<b.length;m++){var c=u.byNode(b[m]);if(c.item.id.toString()===
a.toString())return c}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var a=this.getAllTreeNodeWidgets();return d.filter(a,g.hitch(this,function(a){return a.isLeaf}))},getAllTreeNodeWidgets:function(){var a=this._getAllTreeNodeDoms();return d.map(a,g.hitch(this,function(a){return u.byNode(a)}))},isLeafItem:function(a){return a&&
a.isLeaf},_getAllTreeNodeDoms:function(){return b(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);this.multiple||(a.groupId=this.uniqueId);return new k(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,b,m){b.isLeaf&&(c.hasClass(m.target||
m.srcElement,"jimu-tree-check-node")||(this.multiple?b.toggleSelect():this.selectNodeWidget(b)));return arguments},_onCheckNodeClick:function(a,b,m){!this.multiple&&b&&this.unselectAllLeafNodeWidgets();e.stop(m);this.focusNode(a);setTimeout(g.hitch(this,function(){b?this.selectNodeWidget(a):a.unselect();this.onClick(a.item,a,m)}),0)},unselectAllLeafNodeWidgets:function(){var a=this.getAllLeafTreeNodeWidgets();d.forEach(a,g.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(l,q,t,s,g,c,d,e,b,h,n,r,u,a,v,k,f,p,m,C,w,A,y,D,E,G,H,J,F,I,K,L,O,M,N){function x(a){return k.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var B=s("dijit._TreeNode",[E,G,H,J,F],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a)},labelType:"text",isExpandable:null,isExpanded:!1,state:"NotLoaded",
templateString:K,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";h.set(this.domNode,"backgroundPosition",b+" 0px");h.set(this.rowNode,
this.isLeftToRight()?"paddingLeft":"paddingRight",b);l.forEach(this.getChildren(),function(b){b.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,f=b.model;b._v10Compat&&a===f.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,"row","Row");this.tree._startPaint(!0)},
_applyClassAndStyle:function(a,b,f){var m="_"+b+"Class";b+="Node";var p=this[m];this[m]=this.tree["get"+f+"Class"](a,this.isExpanded);e.replace(this[b],this[m]||"",p||"");h.set(this[b],this.tree["get"+f+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent(),a=!a||!a.rowNode||"none"==a.rowNode.style.display;e.toggle(this.domNode,"dijitTreeIsRoot",a);e.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var b=["dijitTreeExpandoLoading",
"dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;e.replace(this.expandoNode,b[a],b);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return x(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&this.containerNode.setAttribute("role",
"group");e.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var a=r.wipeIn({node:this.containerNode,duration:D.defaultDuration}),b=this._expandDeferred=new g(function(){a.stop()});q.after(a,"onEnd",function(){b.resolve(!0)},!0);a.play();return x(b)},collapse:function(){if(this._collapseDeferred)return x(this._collapseDeferred);this._expandDeferred&&
(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");e.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var a=r.wipeOut({node:this.containerNode,duration:D.defaultDuration}),b=this._collapseDeferred=new g(function(){a.stop()});q.after(a,"onEnd",function(){b.resolve(!0)},
!0);a.play();return x(b)},indent:0,setChildItems:function(a){var b=this.tree,f=b.model,m=[],p=b.focusedChild,k=this.getChildren();l.forEach(k,function(a){H.prototype.removeChild.call(this,a)},this);this.defer(function(){l.forEach(k,function(a){if(!a._destroyed&&!a.getParent()){b.dndController.removeTreeNode(a);var m=function(a){var p=f.getIdentity(a.item),c=b._itemNodesMap[p];1==c.length?delete b._itemNodesMap[p]:(p=l.indexOf(c,a),-1!=p&&c.splice(p,1));l.forEach(a.getChildren(),m)};m(a);if(b.persist){var c=
l.map(a.getTreePath(),function(a){return b.model.getIdentity(a)}).join("/"),k;for(k in b._openedNodes)k.substr(0,c.length)==c&&delete b._openedNodes[k];b._saveExpandedNodes()}b.lastFocusedChild&&!d.isDescendant(b.lastFocusedChild,b.domNode)&&delete b.lastFocusedChild;p&&!d.isDescendant(p,b.domNode)&&b.focus();a.destroyRecursive()}})});this.state="Loaded";a&&0<a.length?(this.isExpandable=!0,l.forEach(a,function(a){var p=f.getIdentity(a),c=b._itemNodesMap[p],k;if(c)for(var d=0;d<c.length;d++)if(c[d]&&
!c[d].getParent()){k=c[d];k.set("indent",this.indent+1);break}k||(k=this.tree._createTreeNode({item:a,tree:b,isExpandable:f.mayHaveChildren(a),label:b.getLabel(a),labelType:b.model&&b.model.labelType||"text",tooltip:b.getTooltip(a),ownerDocument:b.ownerDocument,dir:b.dir,lang:b.lang,textDir:b.textDir,indent:this.indent+1}),c?c.push(k):b._itemNodesMap[p]=[k]);this.addChild(k);(this.tree.autoExpand||this.tree._state(k))&&m.push(b._expandNode(k))},this),l.forEach(this.getChildren(),function(a){a._updateLayout()})):
this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);a=c(m);this.tree._startPaint(a);return x(a)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,this.collapse());l.forEach(b,function(a){a._updateLayout()})},
makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");e.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){A.focus(this.focusNode)}});u("dojo-bidi")&&B.extend({_setTextDirAttr:function(a){if(a&&(this.textDir!=a||!this._created))this._set("textDir",a),this.applyTextDir(this.labelNode),l.forEach(this.getChildren(),function(b){b.set("textDir",a)},this)}});var z=s("dijit.Tree",[E,I,G,F],{baseClass:"dijitTree",
store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:L,persist:!1,autoExpand:!1,dndController:N,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,
b){p.publish(this.id,k.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new g;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(f(this.containerNode,f.selector(".dijitTreeNode",m.enter),function(b){a._onNodeMouseEnter(y.byNode(this),
b)}),f(this.containerNode,f.selector(".dijitTreeNode",m.leave),function(b){a._onNodeMouseLeave(y.byNode(this),b)}),f(this.containerNode,f.selector(".dijitTreeRow",w.press),function(b){a._onNodePress(y.getEnclosingWidget(this),b)}),f(this.containerNode,f.selector(".dijitTreeRow",w),function(b){a._onClick(y.getEnclosingWidget(this),b)}),f(this.containerNode,f.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(y.getEnclosingWidget(this),b)}));this.model||this._store2model();this.own(q.after(this.model,
"onChange",k.hitch(this,"_onItemChange"),!0),q.after(this.model,"onChildrenChange",k.hitch(this,"_onItemChildrenChange"),!0),q.after(this.model,"onDelete",k.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){k.isString(this.dndController)&&(this.dndController=k.getObject(this.dndController));for(var b={},p=0;p<this.dndParams.length;p++)this[this.dndParams[p]]&&(b[this.dndParams[p]]=this[this.dndParams[p]]);this.dndController=new this.dndController(this,b)}this._load();
this.onLoadDeferred=x(this.pendingCommandsPromise);this.onLoadDeferred.then(k.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;a.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var b={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(b.mayHaveChildren=k.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&(b.getChildren=k.hitch(this,function(a,b,f){this.getItemChildren(this._v10Compat&&
a===this.model.root?null:a,b,f)}));this.model=new M(b);this.showRoot=Boolean(this.label)},onLoad:function(){},_load:function(){this.model.getRoot(k.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",!this.dndController.singular),this.rootLoadingIndicator.style.display=
"none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),b.labelNode.setAttribute("role","presentation"),
b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(k.hitch(this,function(){this._destroyed||(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),
k.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=k.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(k.hitch(this,function(){var f=l.map(a,function(a){return!a||k.isString(a)?a:b.model.getIdentity(a)}),m=[];l.forEach(f,function(a){m=
m.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",m)}))},_setPathAttr:function(a){return a.length?x(this.set("paths",[a]).then(function(a){return a[0]})):x(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(a){function b(a,m){var p=a.shift(),c=l.filter(m,function(a){return a.getIdentity()==p})[0];if(c)return a.length?f._expandNode(c).then(function(){return b(a,c.getChildren())}):c;throw new z.PathError("Could not expand path at "+p);}var f=this;return x(this.pendingCommandsPromise=
this.pendingCommandsPromise.always(function(){return c(l.map(a,function(a){a=l.map(a,function(a){return k.isString(a)?a:f.model.getIdentity(a)});if(a.length)return b(a,[f.rootNode]);throw new z.PathError("Empty path");}))}).then(function(a){f.set("selectedNodes",a);return f.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},expandAll:function(){function a(f){return b._expandNode(f).then(function(){var b=l.filter(f.getChildren()||
[],function(a){return a.isExpandable});return c(l.map(b,a))})}var b=this;return x(a(this.rootNode))},collapseAll:function(){function a(f){var m=l.filter(f.getChildren()||[],function(a){return a.isExpandable}),m=c(l.map(m,a));return!f.isExpanded||f==b.rootNode&&!b.showRoot?m:m.then(function(){return b._collapseNode(f)})}var b=this;return x(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||
this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){var f=this._getNext(b);f&&f.isTreeNode&&this.focusNode(f)},_onUpArrow:function(a,b){var f=b.getPreviousSibling();if(f)for(b=f;b.isExpandable&&b.isExpanded&&b.hasChildren();)f=b.getChildren(),b=f[f.length-1];else if(f=b.getParent(),
this.showRoot||f!==this.rootNode)b=f;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){if(b.isExpandable&&b.isExpanded)this._collapseNode(b);else{var f=b.getParent();f&&(f.isTreeNode&&(this.showRoot||f!==this.rootNode))&&this.focusNode(f)}},focusLastChild:function(){var a=this._getLast();a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?
this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,b){return d.isDescendant(a,b.expandoNode)||d.isDescendant(a,b.expandoNodeText)},_onNodePress:function(a,
b){this.focusNode(a)},__click:function(a,b,f,m){var p=this.isExpandoNode(b.target,a);a.isExpandable&&(f||p)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[m](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(a){a=a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):
this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(b){a.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(b)},_getRootOrFirstNode:function(){a.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&delete a._expandNodeDeferred;
if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var b=this.model,f=a.item,m=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new g,b.getChildren(f,function(b){a.unmarkProcessing();a.setChildItems(b).then(function(){a._loadDeferred.resolve(b)})},function(b){console.error(m,": error loading "+a.label+" children: ",b);a._loadDeferred.reject(b)}));
b=a._loadDeferred.then(k.hitch(this,function(){var b=a.expand();this.onOpen(a.item,a);this._state(a,!0);return b}));this._startPaint(b);return b},focusNode:function(a){var b=this.domNode.scrollLeft;this.focusChild(a);this.domNode.scrollLeft=b},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var f=this.getLabel(a),m=this.getTooltip(a);l.forEach(b,function(b){b.set({item:a,label:f,tooltip:m});b._updateItemClasses(a)})}},
_onItemChildrenChange:function(a,b){var f=this.model.getIdentity(a);(f=this._itemNodesMap[f])&&l.forEach(f,function(a){a.setChildItems(b)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var b=this._itemNodesMap[a];b&&(l.forEach(b,function(a){this.dndController.removeTreeNode(a);var b=a.getParent();b&&b.removeChild(a);this.lastFocusedChild&&!d.isDescendant(this.lastFocusedChild,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!d.isDescendant(this.focusedChild,this.domNode)&&
this.focus();a.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=t(this.cookieName);a&&l.forEach(a.split(","),function(a){this._openedNodes[a]=!0},this)}},_state:function(a,b){if(!this.persist)return!1;var f=l.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");if(1===arguments.length)return this._openedNodes[f];b?this._openedNodes[f]=!0:delete this._openedNodes[f];this._saveExpandedNodes()},
_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],b;for(b in this._openedNodes)a.push(b);t(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!k.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&b.setMarginBox(this.domNode,
a);this._nodePixelIndent=b.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(k.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var b=k.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&(!this._adjustWidthsTimer&&
this._started)&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});C(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new B(a)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});u("dojo-bidi")&&z.extend({_setTextDirAttr:function(a){a&&
this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});z.PathError=n("TreePathError");z._TreeNode=B;return z})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(l,q,t,s){return t("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(g){s.mixin(this,g);this.connects=[];g=this.store;
if(!g.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");g.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([q.after(g,"onNew",s.hitch(this,"onNewItem"),!0),q.after(g,"onDelete",s.hitch(this,"onDeleteItem"),!0),q.after(g,"onSet",s.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var g;g=this.connects.pop();)g.remove()},getRoot:function(g,c){this.root?g(this.root):this.store.fetch({query:this.query,
onComplete:s.hitch(this,function(c){if(1!=c.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+c.length+" items, but must return exactly one");this.root=c[0];g(this.root)}),onError:c})},mayHaveChildren:function(g){return l.some(this.childrenAttrs,function(c){return this.store.hasAttribute(g,c)},this)},getChildren:function(g,c,d){var e=this.store;if(e.isItemLoaded(g)){for(var b=[],h=0;h<this.childrenAttrs.length;h++)var n=e.getValues(g,this.childrenAttrs[h]),b=b.concat(n);var r=0;
this.deferItemLoadingUntilExpand||l.forEach(b,function(a){e.isItemLoaded(a)||r++});0==r?c(b):l.forEach(b,function(a,v){e.isItemLoaded(a)||e.loadItem({item:a,onItem:function(a){b[v]=a;0==--r&&c(b)},onError:d})})}else{var u=s.hitch(this,arguments.callee);e.loadItem({item:g,onItem:function(a){u(a,c,d)},onError:d})}},isItem:function(g){return this.store.isItem(g)},fetchItemByIdentity:function(g){this.store.fetchItemByIdentity(g)},getIdentity:function(g){return this.store.getIdentity(g)},getLabel:function(g){return this.labelAttr?
this.store.getValue(g,this.labelAttr):this.store.getLabel(g)},newItem:function(g,c,d){var e={parent:c,attribute:this.childrenAttrs[0]},b;this.newItemIdAttr&&g[this.newItemIdAttr]?this.fetchItemByIdentity({identity:g[this.newItemIdAttr],scope:this,onItem:function(h){h?this.pasteItem(h,null,c,!0,d):(b=this.store.newItem(g,e))&&void 0!=d&&this.pasteItem(b,c,c,!1,d)}}):(b=this.store.newItem(g,e))&&void 0!=d&&this.pasteItem(b,c,c,!1,d)},pasteItem:function(g,c,d,e,b){var h=this.store,n=this.childrenAttrs[0];
c&&l.forEach(this.childrenAttrs,function(b){if(h.containsValue(c,b,g)){if(!e){var a=l.filter(h.getValues(c,b),function(a){return a!=g});h.setValues(c,b,a)}n=b}});if(d)if("number"==typeof b){var r=h.getValues(d,n).slice();r.splice(b,0,g);h.setValues(d,n,r)}else h.setValues(d,n,h.getValues(d,n).concat(g))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(g,c){c&&this.getChildren(c.item,s.hitch(this,function(d){this.onChildrenChange(c.item,d)}))},onDeleteItem:function(g){this.onDelete(g)},
onSetItem:function(g,c){if(-1!=l.indexOf(this.childrenAttrs,c))this.getChildren(g,s.hitch(this,function(c){this.onChildrenChange(g,c)}));else this.onChange(g)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(l,q,t,s,g){return q("dijit.tree.ForestStoreModel",g,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(c){this.root={store:this,root:!0,id:c.rootId,label:c.rootLabel,
children:c.rootChildren}},mayHaveChildren:function(c){return c===this.root||this.inherited(arguments)},getChildren:function(c,d,e){c===this.root?this.root.children?d(this.root.children):this.store.fetch({query:this.query,onComplete:s.hitch(this,function(b){this.root.children=b;d(b)}),onError:e}):this.inherited(arguments)},isItem:function(c){return c===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(c){if(c.identity==this.root.id){var d=c.scope||t.global;c.onItem&&c.onItem.call(d,
this.root)}else this.inherited(arguments)},getIdentity:function(c){return c===this.root?this.root.id:this.inherited(arguments)},getLabel:function(c){return c===this.root?this.root.label:this.inherited(arguments)},newItem:function(c,d,e){return d===this.root?(this.onNewRootItem(c),this.store.newItem(c)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(c,d,e,b,h){if(d===this.root&&!b)this.onLeaveRoot(c);this.inherited(arguments,[c,d===this.root?null:d,e===this.root?null:e,b,
h]);if(e===this.root)this.onAddToRoot(c)},onAddToRoot:function(c){console.log(this,": item ",c," added to root")},onLeaveRoot:function(c){console.log(this,": item ",c," removed from root")},_requeryTop:function(){var c=this.root.children||[];this.store.fetch({query:this.query,onComplete:s.hitch(this,function(d){this.root.children=d;if(c.length!=d.length||l.some(c,function(c,b){return d[b]!=c}))this.onChildrenChange(this.root,d)})})},onNewItem:function(c,d){this._requeryTop();this.inherited(arguments)},
onDeleteItem:function(c){-1!=l.indexOf(this.root.children,c)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(c,d,e,b){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),function(l,q,t,s,g,c,d,e,b,h,n){return q("dijit.tree._dndSelector",n,{constructor:function(){this.selection=
{};this.anchor=null;this.events.push(e(this.tree.domNode,b.press,s.hitch(this,"onMouseDown")),e(this.tree.domNode,b.release,s.hitch(this,"onMouseUp")),e(this.tree.domNode,b.move,s.hitch(this,"onMouseMove")),e(this.tree.domNode,h.press,s.hitch(this,"onClickPress")),e(this.tree.domNode,h.release,s.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var b=[],c=this.selection,a;for(a in c)b.push(c[a]);return b},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);
this.selection=this.anchor=null},addTreeNode:function(b,c){this.setSelection(this.getSelectedTreeNodes().concat([b]));c&&(this.anchor=b);return b},removeTreeNode:function(b){var d=l.filter(this.getSelectedTreeNodes(),function(a){return!c.isDescendant(a.domNode,b.domNode)});this.setSelection(d);return b},isTreeNodeSelected:function(b){return b.id&&!!this.selection[b.id]},setSelection:function(b){var c=this.getSelectedTreeNodes();l.forEach(this._setDifference(c,b),s.hitch(this,function(a){a.setSelected(!1);
this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));l.forEach(this._setDifference(b,c),s.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(b,c){l.forEach(c,function(a){a.__exclude__=!0});var a=l.filter(b,function(a){return!a.__exclude__});l.forEach(c,function(a){delete a.__exclude__});return a},_updateSelectionProperties:function(){var b=this.getSelectedTreeNodes(),c=[],a=[];l.forEach(b,function(b){var k=b.getTreePath();
a.push(b);c.push(k)},this);b=l.map(a,function(a){return a.item});this.tree._set("paths",c);this.tree._set("path",c[0]||[]);this.tree._set("selectedNodes",a);this.tree._set("selectedNode",a[0]||null);this.tree._set("selectedItems",b);this.tree._set("selectedItem",b[0]||null)},onClickPress:function(b){if(!this.current||!this.current.isExpandable||!this.tree.isExpandoNode(b.target,this.current)){"mousedown"==b.type&&d.isLeft(b)&&b.preventDefault();var c="keydown"==b.type?this.tree.focusedChild:this.current;
if(c){var a=g.getCopyKeyState(b),e=c.id;!this.singular&&!b.shiftKey&&this.selection[e]?this._doDeselect=!0:(this._doDeselect=!1,this.userSelect(c,a,b.shiftKey))}}},onClickRelease:function(b){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==b.type?this.tree.focusedChild:this.current,g.getCopyKeyState(b),b.shiftKey))},onMouseMove:function(){this._doDeselect=!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(b,c){if(b===c)return 0;if("sourceIndex"in document.documentElement)return b.sourceIndex-
c.sourceIndex;if("compareDocumentPosition"in document.documentElement)return b.compareDocumentPosition(c)&2?1:-1;if(document.createRange){var a=doc.createRange();a.setStartBefore(b);var d=doc.createRange();d.setStartBefore(c);return a.compareBoundaryPoints(a.END_TO_END,d)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");},userSelect:function(b,c,a){if(this.singular)this.anchor==b&&c?this.selectNone():(this.setSelection([b]),this.anchor=b);else if(a&&
this.anchor){c=this._compareNodes(this.anchor.rowNode,b.rowNode);a=this.anchor;0>c?c=a:(c=b,b=a);for(a=[];c!=b;)a.push(c),c=this.tree._getNext(c);a.push(b);this.setSelection(a)}else this.selection[b.id]&&c?this.removeTreeNode(b):c?this.addTreeNode(b,!0):(this.setSelection([b]),this.anchor=b)},getItem:function(b){return{data:this.selection[b],type:["treeNode"]}},forInSelectedItems:function(b,c){c=c||t.global;for(var a in this.selection)b.call(c,this.getItem(a),a,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),
function(l,q,t,s,g,c){return q("dijit.tree._dndContainer",null,{constructor:function(d,e){this.tree=d;this.node=d.domNode;s.mixin(this,e);this.containerState="";t.add(this.node,"dojoDndContainer");this.events=[g(this.node,c.enter,s.hitch(this,"onOverEvent")),g(this.node,c.leave,s.hitch(this,"onOutEvent")),l.after(this.tree,"_onNodeMouseEnter",s.hitch(this,"onMouseOver"),!0),l.after(this.tree,"_onNodeMouseLeave",s.hitch(this,"onMouseOut"),!0),g(this.node,"dragstart, selectstart",function(b){b.preventDefault()})]},
destroy:function(){for(var c;c=this.events.pop();)c.remove();this.node=this.parent=null},onMouseOver:function(c){this.current=c},onMouseOut:function(){this.current=null},_changeState:function(c,e){var b="dojoDnd"+c,h=c.toLowerCase()+"State";t.replace(this.node,b+e,b+this[h]);this[h]=e},_addItemClass:function(c,e){t.add(c,"dojoDndItem"+e)},_removeItemClass:function(c,e){t.remove(c,"dojoDndItem"+e)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container",
"")}})})},"jimu/dijit/QueryableServiceChooserFromPortal":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/QueryableServiceChooserFromPortal.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/Deferred dojo/Evented dojo/promise/all jimu/dijit/ItemSelector jimu/dijit/QueryableServiceBrowser jimu/portalUrlUtils esri/request".split(" "),function(l,q,t,s,g,c,d,e,b,h,n,r,u,a,v,k,f){return l([q,t,s,
r],{templateString:g,declaredClass:"jimu.dijit.QueryableServiceChooserFromPortal",baseClass:"jimu-service-chooser-from-portal jimu-queryable-service-chooser-from-portal",_serviceBrowserDef:null,portalUrl:null,multiple:!1,postMixInProperties:function(){this.nls=c.mixin({},window.jimuNls.common);this.nls=c.mixin(this.nls,window.jimuNls.featureLayerChooserFromPortal);this.portalUrl=k.getStandardPortalUrl(this.portalUrl);this.multiple=!0===this.multiple?!0:!1},postCreate:function(){this.inherited(arguments);
this._initSelf()},getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},_initSelf:function(){this.selector=new a({portalUrl:this.portalUrl,itemTypes:["Feature Service","Map Service","Image Service"],onlyShowOnlineFeaturedItems:!1});this.own(b(this.selector,"item-selected",c.hitch(this,this._onItemSelected)));this.own(b(this.selector,"none-item-selected",c.hitch(this,this._onNoneItemSelected)));this.selector.placeAt(this.selectorContainer);this.selector.startup();this.serviceBrowser=
new v({multiple:this.multiple});this.own(b(this.serviceBrowser,"tree-click",c.hitch(this,this._onServiceBrowserClicked)));this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup()},_onItemSelected:function(){d.removeClass(this.btnNext,"jimu-state-disabled")},_onNoneItemSelected:function(){d.addClass(this.btnNext,"jimu-state-disabled")},_onBtnBackClicked:function(){this._serviceBrowserDef&&!this._serviceBrowserDef.isFulfilled()&&this._serviceBrowserDef.cancel();d.setStyle(this.btnOk,
"display","none");d.setStyle(this.btnNext,"display","block");d.setStyle(this.btnBack,"display","none");d.addClass(this.btnOk,"jimu-state-disabled");d.setStyle(this.selectorContainer,"display","block");d.setStyle(this.serviceBrowserContainer,"display","none");this.serviceBrowser.reset();this.emit("back")},_onBtnOkClicked:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnNextClicked:function(){var a=this.selector.getSelectedItem();a&&(d.setStyle(this.btnNext,"display","none"),
d.setStyle(this.btnBack,"display","block"),d.setStyle(this.btnOk,"display","block"),d.addClass(this.btnOk,"jimu-state-disabled"),d.setStyle(this.selectorContainer,"display","none"),d.setStyle(this.serviceBrowserContainer,"display","block"),this.serviceBrowser.reset(),this._serviceBrowserDef=this.serviceBrowser.setUrl(a.url||a.item),this._serviceBrowserDef.then(c.hitch(this,function(){this._serviceBrowserDef=null;this._setOkStateBySelectedItems()}),c.hitch(this,function(){this._serviceBrowserDef=null})),
this.emit("next"))},_setOkStateBySelectedItems:function(){0<this.serviceBrowser.getSelectedItems().length?d.removeClass(this.btnOk,"jimu-state-disabled"):d.addClass(this.btnOk,"jimu-state-disabled")},_onServiceBrowserClicked:function(){this._setOkStateBySelectedItems()},_onBtnCancelClicked:function(){this.emit("cancel")}})})},"jimu/dijit/ItemSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemSelector.html dojo/Evented dojo/_base/lang dojo/_base/config dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/promise/all dojo/query dojo/on jimu/utils jimu/portalUtils jimu/tokenUtils jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/Search jimu/dijit/TabContainer3 jimu/dijit/_ItemTable".split(" "),
function(l,q,t,s,g,c,d,e,b,h,n,r,u,a,v,k,f,p,m,C,w,A,y){return l([t,s,g,d],{templateString:c,declaredClass:"jimu.dijit.ItemSelector",baseClass:"jimu-item-selector",tab:null,_user:null,_group:null,_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_isPublicTabShow:!1,_signIn:!1,_itemTypeQueryString:"",
_typeKeywordQueryString:"",portalUrl:null,itemTypes:"",typeKeywords:"",showOnlineItems:!0,onlyShowOnlineFeaturedItems:!1,postMixInProperties:function(){this.portalUrl=m.getStandardPortalUrl(this.portalUrl);this.showOnlineItems=!1===this.showOnlineItems?!1:!0;this.itemTypes&&0<this.itemTypes.length||(this.itemTypes=[]);this._itemTypes="";h.forEach(this.itemTypes,e.hitch(this,function(a,b){this._itemTypes+='"'+a+'"';b!==this.itemTypes.length-1&&(this._itemTypes+=",")}));this._itemTypes="["+this._itemTypes+
"]";this.typeKeywords&&0<this.typeKeywords.length||(this.typeKeywords=[]);this._typeKeywords="";h.forEach(this.typeKeywords,e.hitch(this,function(a,b){this._typeKeywords+='"'+a+'"';b!==this.typeKeywords.length-1&&(this._typeKeywords+=",")}));this._typeKeywords="["+this._typeKeywords+"]";this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);var a=this._getPortalUrl();this.portal=f.getPortal(a);this._initOptions();this._initSearchQuery();this._initTabs();this._initPortalRadio();
this._initItemTables();this._initPublic();this._initPrivate();this._updateUIbySignIn()},_initOptions:function(){this._itemTypeQueryString=k.getItemQueryStringByTypes(this.itemTypes);this._typeKeywordQueryString=k.getItemQueryStringByTypeKeywords(this.typeKeywords)},_initTabs:function(){this.tab=new A({tabs:[{title:this.nls.myContent,content:this.mycontentTabNode},{title:this.nls.myOrganization,content:this.organizationTabNode},{title:this.nls.myGroup,content:this.groupTabNode},{title:this.nls.publicMap,
content:this.publicTabNode}]},this.tabNode);this.own(v(this.tab,"tabChanged",e.hitch(this,function(a){n.setStyle(this.signinSection,"display","none");a!==this.nls.publicMap?(this._isPublicTabShow=!1,this._updateUIbySignIn()):this._isPublicTabShow=!0})))},_updateUIbySignIn:function(){n.setStyle(this.signinSection,"display","none");var b=a(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",this.domNode);p.userHaveSignInPortal(this._getPortalUrl())?b.style("display",
"block"):(b.style("display","none"),this._isPublicTabShow||n.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){k.combineRadioCheckBoxWithLabel(this.portalPublicRaido,this.portalPublicLabel);k.combineRadioCheckBoxWithLabel(this.onlinePublicRaido,this.onlinePublicLabel);var a=this._getPortalUrl(),a=m.getServerByUrl(a);this.portalPublicRaido.disabled=!1;this.onlinePublicRaido.disabled=!1;this.portalPublicRaido.checked=!0;var b=!1;m.isArcGIScom(a)?(b=!0,this.portalPublicLabel.innerHTML=
"ArcGIS.com"):(this.portalPublicLabel.innerHTML=a,b=this.showOnlineItems?!1:!0);b&&(this.onlinePublicRaido.disabled=!0,n.setStyle(this.onlinePublicRaido,"display","none"),n.setStyle(this.onlinePublicLabel,"display","none"))},_initSearchQuery:function(){var a="esri_"+(b.locale&&b.locale.slice(0,2)||"en").toLowerCase(),f=h.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
e.hitch(this,function(b){return b!==a})),c="";h.forEach(f,e.hitch(this,function(a){c+=" -owner:"+a+" "}));f=" ";this.portal&&(this.portal.user&&this.portal.user.orgId)&&(f=" orgid:"+this.portal.user.orgId+" ");f=f+this._itemTypeQueryString+" AND access:public "+c+" "+this._typeKeywordQueryString;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:f});this._filterPublicPortalQuery=this._getQuery({q:f,basicQ:f});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",
sortOrder:"desc",q:(this.onlyShowOnlineFeaturedItems?' (group:"c755678be14e4a0984af36a15f5b643e"  OR group:"b8787a74b4d74f7fb9b8fac918735153") ':" ")+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._filterPublicOnlineQuery=this._getQuery({q:this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=
this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return e.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return m.getStandardPortalUrl(this.portalUrl)},_initItemTables:function(){"function"===typeof this.onCreateItemContent&&(this.mycontentItemTable.onCreateItemContent=this.onCreateItemContent,this.organizationItemTable.onCreateItemContent=this.onCreateItemContent,this.groupItemTable.onCreateItemContent=this.onCreateItemContent,
this.publicPortalItemTable.onCreateItemContent=this.onCreateItemContent,this.publicOnlineItemTable.onCreateItemContent=this.onCreateItemContent);this.own(v(this.publicPortalItemTable,"item-dom-clicked",e.hitch(this,this._onItemDomClicked)));this.own(v(this.publicOnlineItemTable,"item-dom-clicked",e.hitch(this,this._onItemDomClicked)));this.own(v(this.organizationItemTable,"item-dom-clicked",e.hitch(this,this._onItemDomClicked)));this.own(v(this.groupItemTable,"item-dom-clicked",e.hitch(this,this._onItemDomClicked)));
this.own(v(this.mycontentItemTable,"item-dom-clicked",e.hitch(this,this._onItemDomClicked)));this.own(v(this.publicPortalItemTable,"update",e.hitch(this,this._onItemTableUpdate)));this.own(v(this.publicOnlineItemTable,"update",e.hitch(this,this._onItemTableUpdate)));this.own(v(this.organizationItemTable,"update",e.hitch(this,this._onItemTableUpdate)));this.own(v(this.groupItemTable,"update",e.hitch(this,this._onItemTableUpdate)));this.own(v(this.mycontentItemTable,"update",e.hitch(this,this._onItemTableUpdate)));
var a=this._getPortalUrl();this.portalPublicRaido.disabled||(this.publicPortalItemTable.set("portalUrl",a),this.publicPortalItemTable.searchAllItems(this._allPublicPortalQuery),this.publicPortalItemTable.set("filteredQuery",this._filterPublicPortalQuery));this.onlinePublicRaido.disabled||(this.publicOnlineItemTable.set("portalUrl",window.location.protocol+"//www.arcgis.com"),this.publicOnlineItemTable.searchAllItems(this._allPublicOnlineQuery),this.publicOnlineItemTable.set("filteredQuery",this._filterPublicOnlineQuery))},
_initPublic:function(){this.own(v(this.portalPublicRaido,"click",e.hitch(this,this._onPublicRaidoClicked)));this.own(v(this.onlinePublicRaido,"click",e.hitch(this,this._onPublicRaidoClicked)));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.checked?(this.publicPortalItemTable.show(),this.publicOnlineItemTable.hide()):this.onlinePublicRaido.checked&&(this.publicPortalItemTable.hide(),this.publicOnlineItemTable.show())},_onPublicSearch:function(a){(a=a&&e.trim(a))?
(this.publicPortalItemTable.showFilterItemsSection(),this.publicOnlineItemTable.showFilterItemsSection(),this.portalPublicRaido.checked?(this._filterPublicPortalQuery.q=a+" "+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalItemTable.searchFilteredItems(this._filterPublicPortalQuery)):this.onlinePublicRaido.checked&&(this._filterPublicOnlineQuery.q=a+" "+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString,this._filterPublicOnlineQuery.start=
1,this.publicOnlineItemTable.searchFilteredItems(this._filterPublicOnlineQuery))):(this.publicPortalItemTable.showAllItemsSection(),this.publicOnlineItemTable.showAllItemsSection())},_initPrivate:function(){this._resetPortalMaps();this.own(v(this.groupsSelect,"change",e.hitch(this,this._onGroupsSelectChange)));var a=m.getServerByUrl(this._getPortalUrl());m.isArcGIScom(a);p.userHaveSignInPortal(this._getPortalUrl())&&this._onSignIn()},_onOrganizationSearch:function(a){if(a=a&&e.trim(a)){if(this._allOrganizationQuery){var b=
this._allOrganizationQuery.q;b&&(this._filterOrganizationQuery.q=a+" "+b,this._filterOrganizationQuery.start=1,this.organizationItemTable.searchFilteredItems(this._filterOrganizationQuery))}}else this.organizationItemTable.showAllItemsSection()},_onMyContentSearch:function(a){if(a=a&&e.trim(a)){if(this._allMyContentQuery){var b=this._allMyContentQuery.q;b&&(this._filterMyContentQuery.q=a+" "+b,this._filterMyContentQuery.start=1,this.mycontentItemTable.searchFilteredItems(this._filterMyContentQuery))}}else this.mycontentItemTable.showAllItemsSection()},
_onGroupSearch:function(a){if(a=a&&e.trim(a)){if(this._allGroupQuery){var b=this._allGroupQuery.q;b&&(this._filterGroupQuery.q=a+" "+b,this._filterGroupQuery.start=1,this.groupItemTable.searchFilteredItems(this._filterGroupQuery))}}else this.groupItemTable.showAllItemsSection()},_onSignIn:function(){this._updateUIbySignIn();if(!this._signIn){this._signIn=!0;var a=this._getPortalUrl();f.getPortal(a).getUser().then(e.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),
this._searchMyContent(a),this._searchGroups(a))}))}},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationItemTable.clear();this.mycontentItemTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){this.organizationItemTable.clear();a=" orgid:"+a.orgId+" AND "+this._itemTypeQueryString+" AND (access:org OR access:public) "+this._typeKeywordQueryString;var b=this._getPortalUrl();this._allOrganizationQuery=
this._getQuery({q:a});this._filterOrganizationQuery=this._getQuery({q:a});this.organizationItemTable.set("portalUrl",b);this.organizationItemTable.searchAllItems(this._allOrganizationQuery)},_searchMyContent:function(a){this.mycontentItemTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentItemTable.set("portalUrl",
b);this.mycontentItemTable.searchAllItems(this._allMyContentQuery)},_searchGroups:function(a){this._resetGroupsSection();n.setStyle(this.groupsSection,"display","block");a=a.getGroups();if(0<a.length){n.setStyle(this.groupSearch.domNode,"display","block");this.groupItemTable.show();n.empty(this.groupsSelect);for(var b=0;b<a.length;b++){var f=a[b];n.create("option",{value:f.id,innerHTML:f.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length)},_resetGroupsSection:function(){n.setStyle(this.groupsSection,
"display","none");n.empty(this.groupsSelect);n.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupItemTable.clear();n.setStyle(this.groupSearch.domNode,"display","none");this.groupItemTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?n.setStyle(this.groupsSection,"top","15px"):n.setStyle(this.groupsSection,"top","50px")},_onGroupsSelectChange:function(){var a=this.groupsSelect.value;this.groupItemTable.clear();if("nodata"===a)n.setStyle(this.groupSearch,
"display","none"),this.groupItemTable.hide();else{n.setStyle(this.groupSearch,"display","block");this.groupItemTable.show();var b=this._getPortalUrl(),a="group:"+a+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});this.groupItemTable.set("portalUrl",b);this.groupItemTable.searchAllItems(this._allGroupQuery)}},_onItemTableUpdate:function(){this.emit("update")},_onItemDomClicked:function(b){var f=
n.hasClass(b,"jimu-state-active");a(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active");f&&n.addClass(b,"jimu-state-active");(b=this.getSelectedItem())?this.emit("item-selected",b):this.emit("none-item-selected")},getSelectedItem:function(){var b=null,f=a(".item.jimu-state-active",this.domNode);0<f.length&&(b=e.mixin({},f[0].item));return b}})})},"jimu/dijit/_ItemTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),
function(l,q,t,s,g,c,d,e,b,h,n,r,u,a,v,k){return l([q,t,s,c],{templateString:g,declaredClass:"jimu.dijit.ItemTable",baseClass:"jimu-item-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"webapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&0<this.types.length||
(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=v.getStandardPortalUrl(this.portalUrl));this.showAllItemsSection();this.searchAllItems()},show:function(){b.setStyle(this.domNode,"display","block")},hide:function(){b.setStyle(this.domNode,"display","none")},searchAllItems:function(b){this.showAllItemsSection();b&&(this.query=d.mixin({},b),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),
a.getPortal(this.portalUrl).queryItems(this.query).then(d.hitch(this,function(a){this.domNode&&(this.allItemsShelter.hide(),this.query.start=a.nextStart,this._createItems(a,this.allItemTbody))}),d.hitch(this,function(a){console.error(a);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(b){this.showFilterItemsSection();b&&(this.filteredQuery=d.clone(b),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&
(this.filteredItemShelter.show(),a.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(d.hitch(this,function(a){this.domNode&&(this.showFilterItemsSection(),b&&this.clearFilteredItemsSection(),this.filteredQuery.start=a.nextStart,this._createItems(a,this.filteredItemsTbody),this._filterItemCallback())}),d.hitch(this,function(a){console.error(a);this.domNode&&this._filterItemCallback()})))},_filterItemCallback:function(){this.filteredItemShelter.hide();0<this._getItemCount(this.filteredItemsTbody)?
(b.setStyle(this.filteredItemsTableDiv,"display","block"),b.setStyle(this.searchNoneTipSection,"display","none")):(b.setStyle(this.filteredItemsTableDiv,"display","none"),b.setStyle(this.searchNoneTipSection,"display","block"))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){b.empty(this.allItemTbody)},clearFilteredItemsSection:function(){b.empty(this.filteredItemsTbody)},showAllItemsSection:function(){b.setStyle(this.allItemsSection,
"display","block");b.setStyle(this.filteredItemsSection,"display","none")},showFilterItemsSection:function(){b.setStyle(this.allItemsSection,"display","none");b.setStyle(this.filteredItemsSection,"display","block");b.setStyle(this.filteredItemsTableDiv,"display","block");b.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&
this.searchFilteredItems()},_isScrollToBottom:function(a){return u.isScrollToBottom(a)},_createItems:function(a,c){var m=a.results,k=e.map(this.types,d.hitch(this,function(a){return a.toLowerCase()})),m=e.filter(m,d.hitch(this,function(a){a=a.type&&a.type.toLowerCase()||"";return 0<=e.indexOf(k,a)}));if(0!==m.length){var h,v=n("td.empty",c),g;if(0<v.length){var r=Math.min(m.length,v.length),l=m.splice(0,r);for(g=0;g<r;g++){var u=v[g];h=this._createItem(l[g]);b.place(h,u);b.removeClass(u,"empty")}}if(0!==
m.length){v=Math.ceil(m.length/2);for(g=0;g<v;g++){h=b.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");b.place(h,c);r=n("td",h);for(l=0;l<r.length;l++)u=r[l],(h=m[2*g+l])?(h=this._createItem(h),b.place(h,u)):b.addClass(u,"empty")}this.emit("update")}}},_getItemCount:function(a){return n(".item",a).length},_createItem:function(a){var c=b.toDom('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
c.item=a;var m=n(".item-thumbnail",c)[0],k=n(".item-name",c)[0],d=n(".item-type-owner",c)[0],e=n(".item-date",c)[0],h=n(".item-details",c)[0],v=n(".none-thumbnail-tip",c)[0];if(!a.thumbnailUrl){var g=this._defaultThumbnail[a.type];g&&(a.thumbnailUrl=require.toUrl("jimu")+"/images/"+g)}a.thumbnailUrl?b.setStyle(m,"backgroundImage","url("+a.thumbnailUrl+")"):v.innerHTML=this.nls.noneThumbnail;"function"===typeof this.onCreateItemContent?(e=n(".item-info",c)[0],this.onCreateItemContent(a,e)):(k.innerHTML=
a.title,k.title=k.innerHTML,d.innerHTML=a.type+" by "+a.owner,d.title=d.innerHTML,m=new Date,m.setTime(a.modified),e.innerHTML=m.toLocaleString(),e.title=e.innerHTML,h.innerHTML=this.nls.moreDetails,h.href=a.detailsPageUrl||"#");return c},_onItemsTableClicked:function(a){var c=a.target||a.srcElement;a=null;b.hasClass(c,"item-thumbnail")?a=c.parentNode:b.hasClass(c,"none-thumbnail-tip")&&(a=c.parentNode.parentNode);a&&(c=b.hasClass(a,"jimu-state-active"),n(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active"),
c?b.removeClass(a,"jimu-state-active"):b.addClass(a,"jimu-state-active"),this.emit("item-dom-clicked",a))},getSelectedItem:function(){var a=null,b=n(".item.jimu-state-active",this.domNode);0<b.length&&(a=d.mixin({},b[0].item));return a}})})},"jimu/dijit/QueryableServiceBrowser":function(){define(["dojo/_base/declare","./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array","jimu/serviceBrowserRuleUtils"],function(l,q,t,s,g){return l([q],{baseClass:"jimu-queryable-service-browser",declaredClass:"jimu-service-chooser-from-portal jimu.dijit.QueryableServiceBrowser",
url:"",multiple:!1,postMixInProperties:function(){this.inherited(arguments);this.rule=g.getQueryableServiceBrowserRule()},getSelectedItems:function(){var c=this.inherited(arguments);return c=s.map(c,t.hitch(this,function(c){return{name:c.name,url:c.url,definition:c.definition}}))}})})},"jimu/dijit/_BasicServiceBrowser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/store/Memory dojo/store/Observable dijit/tree/ObjectStoreModel jimu/utils jimu/dijit/_Tree jimu/dijit/LoadingShelter".split(" "),
function(l,q,t,s,g,c,d,e,b,h,n,r,u,a,v){return l([q,t,s,g],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"shelter"  data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_currentUrl:"",_treeClass:"service-browser-tree",_def:null,url:"",multiple:!1,rule:null,postMixInProperties:function(){this.nls=window.jimuNls.basicServiceBrowser},postCreate:function(){this.inherited(arguments);d.addClass(this.domNode,
"jimu-basic-service-browser");this.multiple=!!this.multiple;this._createTree();this.url&&"string"===typeof this.url&&this.setUrl(this.url)},reset:function(){this.url="";this._clear()},getSelectedItems:function(){return this.tree.getSelectedItems()},setUrl:function(k){this._def&&(this._def.isFulfilled()||this._def.cancel(),this._def=null);this._def=new b;(!k||!("string"===typeof k&&k.replace(/\/*$/g,"")))&&this._def.reject();k=k.replace(/\/*$/g,"");k=c.trim(k);var f=k.match(/^http(s?):\/\//gi);f&&
0<f.length||(k="http://"+k);if(!(0>=k.search(/\/rest\/services/i))&&(this._clear(),this._currentUrl=k))return k=this._getRootItem(),k=a.isStringEndWith(this._currentUrl,"rest/services")?this._searchBaseServiceUrl(this._currentUrl,k):this._isUrlContainsServiceType(this._currentUrl)?this._searchServiceUrl(this._currentUrl,k):this._searchFolderServiceUrl(this._currentUrl,k),this.shelter.show(),k.then(c.hitch(this,function(a){this.domNode&&this.shelter.hide();var b=this.tree.getAllLeafTreeNodeWidgets();
1===b.length&&b[0].select();this._def.resolve(a)}),c.hitch(this,function(a){this.domNode&&this.shelter.hide();this._showRequestError();this._def.reject(a)})),this._def;this._def.reject()},_getItem:function(a){return this.rule.getItem(a)},_getSubItemUrls:function(a){return this.rule.getSubItemUrls(a)},_getSubItems:function(a){var f=new b;this._getSubItemUrls(a).then(c.hitch(this,function(a){a=e.map(a,c.hitch(this,function(a){return this._getItem(a)}));h(a).then(c.hitch(this,function(a){a=e.filter(a,
c.hitch(this,function(a){return a&&"object"===typeof a}));f.resolve(a)}),c.hitch(this,function(a){f.reject(a)}))}),c.hitch(this,function(a){f.reject(a)}));return f},_selectFirstLeafTreeNodeWidget:function(){var a=this.tree.getAllLeafTreeNodeWidgets();1===a.length&&a[0].select()},isLeafItem:function(a){return 0<=this.rule.leafTypes.indexOf(a.type)},isServiceTypeSupported:function(a){return this.rule.isServiceTypeSupported(a)},_getStringEndWith:function(a,b){var c="",m=a.indexOf(b);0<=m&&(c=a.slice(0,
m+b.length));return c},_isUrlContainsServiceType:function(a){return this.rule.isUrlContainsServiceType(a)},_getBaseServiceUrl:function(){return this._getStringEndWith(this._currentUrl,"rest/services")},_getServiceName:function(a){var b="";a=a.split("/");return b=a[a.length-1]},_searchBaseServiceUrl:function(a,f){var p=new b;this._getRestInfo(a).then(c.hitch(this,function(m){if(this.domNode){var d=[];e.map(m.folders,c.hitch(this,function(m){var p={name:m,type:"folder",url:a+"/"+m,parent:f.id};this._addItem(p);
var h=new b;this._doSearchFolderServiceUrl(p.url,p.id).then(c.hitch(this,function(a){0<a.length?e.forEach(a,c.hitch(this,function(a){a.parent=p.id;this._addItem(a)})):this._removeItem(p.id);h.resolve()}),c.hitch(this,function(a){h.reject(a)}));d.push(h);return h}));e.forEach(m.services,c.hitch(this,function(m){if(this.isServiceTypeSupported(m.type)){m=a+"/"+m.name+"/"+m.type;var p=new b;this.rule.getItem(m).then(c.hitch(this,function(a){a&&(a.parent=f.id,this._addItem(a));p.resolve()}),c.hitch(this,
function(a){console.error(a);p.reject(a)}));d.push(p)}}));h(d).then(c.hitch(this,function(){this.domNode&&p.resolve()}),c.hitch(this,function(a){console.error(a);this.domNode&&p.reject(a)}))}}),c.hitch(this,function(a){console.error(a);this.domNode&&p.reject({errorCode:"NETWORK_ERROR",error:a})}));return p},_searchFolderServiceUrl:function(a,f){var p=new b;this._doSearchFolderServiceUrl(a,f).then(c.hitch(this,function(a){this.domNode&&(e.forEach(a,c.hitch(this,function(a){a.parent=f.id;this._addItem(a)})),
p.resolve())}),c.hitch(this,function(a){console.error(a);this.domNode&&p.reject({errorCode:"NETWORK_ERROR",error:a})}));return p},_doSearchFolderServiceUrl:function(a){var f=new b,p=this._getBaseServiceUrl();this._getRestInfo(a).then(c.hitch(this,function(a){a=a.services;var b=[];a&&0<a.length&&e.forEach(a,c.hitch(this,function(a){this.isServiceTypeSupported(a.type)&&(a=this.rule.getItem(p+"/"+a.name+"/"+a.type),b.push(a))}));h(b).then(c.hitch(this,function(a){a=e.filter(a,c.hitch(this,function(a){return a}));
f.resolve(a)}),c.hitch(this,function(a){console.error(a);f.reject(a)}))}),c.hitch(this,function(a){console.error(a);f.reject(a)}));return f},_searchServiceUrl:function(a,f){var p=new b;this._getSubItems(a).then(c.hitch(this,function(b){b&&0<b.length?(e.forEach(b,c.hitch(this,function(a){a.parent=f.id;this._addItem(a)})),p.resolve()):this._getItem(a).then(c.hitch(this,function(a){a&&(a.parent=f.id,this._addItem(a));p.resolve()}),c.hitch(this,function(a){p.reject(a)}))}),c.hitch(this,function(a){p.reject(a)}));
return p},_getRestInfo:function(a){var f=new b;this.rule.getRestInfo(a).then(c.hitch(this,function(a){this.domNode&&f.resolve(a)}),c.hitch(this,function(a){this.domNode&&f.reject(a)}));return f},_clear:function(){var a=this._store.query({parent:"root"});e.forEach(a,c.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_showRequestError:function(){this.emit("error",this.nls.invalidUrlTip)},_addItem:function(a){this._id++;a.id=this._id.toString();this._store.add(a);return a},_removeItem:function(a){this._store.remove(a)},
_getRootItem:function(){return{id:"root",name:"Services Root",type:"root"}},_createTree:function(){var a=this._getRootItem(),a=new n({data:[a],getChildren:function(a){return this.query({parent:a.id})}});this._store=new r(a);a=new u({store:this._store,query:{id:"root"},mayHaveChildren:c.hitch(this,this._mayHaveChildren)});this.tree=new v({multiple:this.multiple,model:a,showRoot:!1,style:{width:"100%"},isLeafItem:c.hitch(this,this.isLeafItem),onOpen:c.hitch(this,function(a,b){this._onTreeOpen(a,b);
this.emit("tree-open",a,b)}),onClick:c.hitch(this,function(a,b,c){this._onTreeClick(a,b,c);this.emit("tree-click",a,b,c)}),getIconStyle:c.hitch(this,function(a,b){var c=null;if(!a)return null;var k={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},d=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),e=this._getIconImageName(a,b);e||("folder"===a.type?e=b?"folder_open_default.png":"folder_close_default.png":this.isServiceTypeSupported(a.type)&&
(e=b?"folder_open_default.png":"folder_close_default.png"));e&&(k.backgroundImage="url("+d+"/css/images/"+e+")",c=k);return c})});d.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.domNode)},_getIconImageName:function(a,b){var c="";"function"===typeof this.rule.getIconImageName&&(c=this.rule.getIconImageName(a,b));return c},_mayHaveChildren:function(a){return"root"===a.type?!0:!this.isLeafItem(a)},_onTreeOpen:function(a,b){"root"!==a.id&&(!(0<this._store.query({parent:a.id}).length)&&
!a.checking&&!a.checked)&&(a.checking=!0,this._getSubItems(a.url).then(c.hitch(this,function(b){e.forEach(b,c.hitch(this,function(b){b.parent=a.id;this._addItem(b)}));a.checking=!1;a.checked=!0}),c.hitch(this,function(b){console.error(b);a.checking=!1;a.checked=!0})))},_onTreeClick:function(a,b,c){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)}})})},"jimu/serviceBrowserRuleUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/Deferred",
"jimu/utils","jimu/ServiceBrowserRule"],function(l,q,t,s,g){var c={combineRules:function(c){var e=new g;q.forEach(c,function(b){q.forEach(b.leafTypes,function(b){0>e.leafTypes.indexOf(b)&&e.leafTypes.push(b)});q.forEach(b.serviceTypes,function(b){0>e.serviceTypes.indexOf(b)&&e.serviceTypes.push(b)})});e.getMatchedRule=function(b){var e=null;q.some(c,function(c){return c.isUrlContainsServiceType(b)?(e=c,!0):!1});return e};e.getItem=function(b){var c=null;return c=(c=e.getMatchedRule(b))?c.getItem(b):
e.defaultGetItem(b)};e.getSubItemUrls=function(b){var c=null;return c=(c=e.getMatchedRule(b))?c.getSubItemUrls(b):e.defaultGetSubItemUrls(b)};e.getIconImageName=function(b,c){var d="";if(b.url){var g=e.getMatchedRule(b.url);g&&"function"===typeof g.getIconImageName&&(d=g.getIconImageName(b,c))}return d};return e},getFeaturelayerServiceBrowserRule:function(d,e){var b=l.clone(d),h=["point","polyline","polygon"];l.isArrayLike(b)&&0<b.length?(b=q.filter(b,function(b){return 0<=h.indexOf(b)}),0===b.length&&
(b=h)):b=h;return c._getFeaturelayerServiceBrowserRule(b,e)},_getFeaturelayerServiceBrowserRule:function(c,e){return new g({types:c,leafTypes:["Feature Layer","Table"],serviceTypes:["MapServer","FeatureServer"],_groupLayerType:"Group Layer",_featureLayerType:"Feature Layer",_tableType:"Table",getItem:function(b){var c=new t;this.isUrlEndWithServiceType(b,this.serviceTypes)?c=this.defaultGetItem(b):this.getRestInfo(b).then(l.hitch(this,function(e){e=this._getItemByLayerDefinition(b,e);c.resolve(e)}),
l.hitch(this,function(b){c.reject(b)}));return c},getSubItemUrls:function(b){var c=new t;return c=this.isUrlEndWithServiceType(b)?this._getSubUrlsByServiceUrl(b):this._getSubUrlsByGroupUrl(b)},getIconImageName:function(b,c){var e="";if("MapServer"===b.type||"FeatureServer"===b.type)e=c?"mapserver_open.png":"mapserver_close.png";else if(b.type===this._groupLayerType)e=c?"group_layer2.png":"group_layer1.png";else if(b.type===this._featureLayerType){var d=s.getTypeByGeometryType(b.definition&&b.definition.geometryType);
"point"===d?e="point_layer1.png":"polyline"===d?e="line_layer1.png":"polygon"===d&&(e="polygon_layer1.png")}else b.type===this._tableType?e="table.png":"root"===b.type&&this._currentUrl&&q.some(this.serviceTypes,l.hitch(this,function(b){return s.isStringEndWith(this._currentUrl,"/"+b)}))&&(e=c?"mapserver_open.png":"mapserver_close.png");return e},_getSubUrlsByServiceUrl:function(b){var c=new t;this.getRestInfo(b).then(l.hitch(this,function(e){var d=[];q.forEach(e.layers,l.hitch(this,function(c){0<=
c.parentLayerId||d.push(b+"/"+c.id)}));c.resolve(d)}),l.hitch(this,function(b){c.reject(b)}));return c},_getSubUrlsByGroupUrl:function(b){var c=new t;this.getRestInfo(b).then(l.hitch(this,function(e){var d=[];if(e.type===this._groupLayerType)var g=this._getServiceUrlByLayerUrl(b),d=q.map(e.subLayers||[],l.hitch(this,function(a){return g+"/"+a.id}));c.resolve(d)}),l.hitch(this,function(b){c.reject(b)}));return c},_getItemByLayerDefinition:function(b,c){var d=null,g=c.type;if(g===this._groupLayerType)d=
{name:c.name,type:g,url:b,definition:c};else if(g===this._featureLayerType||g===this._tableType){var l=!1;g===this._featureLayerType?l=this._validateEsriGeometryType(c.geometryType):g===this._tableType&&(l=!0);l&&(l=!1,(l=e?s.isFeaturelayerUrlSupportQuery(b,c.capabilities):!0)&&(d={name:c.name,type:g,url:b,definition:c}))}return d},_validateEsriGeometryType:function(b){b=s.getTypeByGeometryType(b);return 0<=this.types.indexOf(b)},_getServiceUrlByLayerUrl:function(b){for(var c="",e=0;e<this.serviceTypes.length;e++){var d=
this.serviceTypes[e].toLowerCase(),g=b.toLowerCase().lastIndexOf("/"+d+"/");if(0<=g){c=b.slice(0,g+d.length+1);break}}return c}})},getGeocodeServiceBrowserRule:function(){return new g({leafTypes:["GeocodeServer"],serviceTypes:["GeocodeServer"]})},getGpServiceBrowserRule:function(){return new g({leafTypes:["GPTask"],serviceTypes:["GPServer"],getItem:function(c){var e=new t;this.isUrlEndWithServiceType(c)?e=this.defaultGetItem(c):this.getRestInfo(c).then(l.hitch(this,function(b){e.resolve({name:b.displayName||
b.name,type:"GPTask",url:c,definition:b})}),l.hitch(this,function(b){e.reject(b)}));return e},getSubItemUrls:function(c){var e=new t;this.isUrlEndWithServiceType(c)?this.getRestInfo(c).then(l.hitch(this,function(b){b=q.map(b.tasks||[],l.hitch(this,function(b){return c+"/"+b}));e.resolve(b)}),l.hitch(this,function(b){e.reject(b)})):e.resolve([]);return e},getIconImageName:function(c,e){var b="";"GPServer"===c.type?b="toolbox.png":"GPTask"===c.type&&(b="tool.png");return b}})},getImageServiceBrowserRule:function(c){return new g({leafTypes:["ImageServer"],
serviceTypes:["ImageServer"],getItem:function(e){var b=new t;this.isUrlEndWithServiceType(e)?this.defaultGetItem(e).then(l.hitch(this,function(e){c?s.isImageServiceSupportQuery(e.definition.capabilities)?b.resolve(e):b.resolve(null):b.resolve(e)}),l.hitch(this,function(c){b.reject(c)})):b.resolve(null);return b},getIconImageName:function(c,b){var d="";"ImageServer"===c.type&&(d="image_layer.png");return d}})},getQueryableServiceBrowserRule:function(){var d=c.getFeaturelayerServiceBrowserRule(["point",
"polyline","polygon"],!0),e=c.getImageServiceBrowserRule(!0);return c.combineRules([d,e])}};return c})},"jimu/ServiceBrowserRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred jimu/utils esri/request esri/IdentityManager".split(" "),function(l,q,t,s,g,c,d){return l([],{leafTypes:null,serviceTypes:null,_restInfoCache:{},constructor:function(c){q.mixin(this,c);q.isArrayLike(this.leafTypes)||(this.leafTypes=[]);q.isArrayLike(this.serviceTypes)||(this.serviceTypes=
[])},getItem:function(c){return this.defaultGetItem(c)},getSubItemUrls:function(c){return this.defaultGetSubItemUrls(c)},getIconImageName:function(c,b){return""},defaultGetItem:function(c){var b=new s;c=c.replace(/\/*$/g,"");if(this.isUrlEndWithServiceType(c)){var d=c.split("/"),n=d[d.length-1],g=d[d.length-2];this.getRestInfo(c).then(q.hitch(this,function(d){b.resolve({name:g,type:n,url:c,definition:d})}),q.hitch(this,function(c){console.error(c);b.reject({errorCode:"NETWORK_ERROR",error:c})}))}else b.resolve(null);
return b},defaultGetSubItemUrls:function(c){c=new s;c.resolve([]);return c},getRestInfo:function(e){var b=new s;e=e.replace(/\/*$/g,"");var h=this._restInfoCache[e];if(h)b.resolve(h);else{var h={url:e,content:{f:"json"},handleAs:"json",callbackParamName:"callback",timeout:2E4},n=d.findCredential(e);n&&n.token&&(h.content.token=n.token);c(h).then(q.hitch(this,function(c){this._restInfoCache[e]=c;b.resolve(c)}),function(c){b.reject(c)})}return b},isServiceTypeSupported:function(c){c=c.toLowerCase();
return t.some(this.serviceTypes,q.hitch(this,function(b){return b.toLowerCase()===c}))},isUrlEndWithServiceType:function(c){return t.some(this.serviceTypes,q.hitch(this,function(b){return g.isStringEndWith(c,"/"+b)}))},isUrlContainsServiceType:function(c){c=c.toLowerCase();return t.some(this.serviceTypes,q.hitch(this,function(b){b=b.toLowerCase();return 0<=c.indexOf("/"+b)}))}})})},"jimu/dijit/_QueryableServiceChooserContent":function(){define(["dojo/_base/declare","./_BasicServiceChooserContent",
"./QueryableServiceBrowser"],function(l,q,t){return l([q],{baseClass:"jimu-queryable-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/myservice/MapServer","http://myserver/arcgis/rest/services/myservice/FeatureServer","http://myserver/arcgis/rest/services/myservice/ImageServer"],_createServiceBrowser:function(l){return new t(l)}})})},"jimu/dijit/_BasicServiceChooserContent":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_BasicServiceChooserContent.html dojo/Evented dojo/Deferred dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/promise/all jimu/dijit/URLInput jimu/dijit/LoadingIndicator".split(" "),
function(l,q,t,s,g,c,d,e,b,h,n,r,u,a,v){return l([q,t,s,c],{templateString:g,_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/servicetype"],multiple:!1,url:"",getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},postMixInProperties:function(){this.nls=h.mixin({},window.jimuNls.common);this.nls=h.mixin(this.nls,window.jimuNls.basicServiceChooser)},postCreate:function(){this.inherited(arguments);
e.addClass(this.domNode,"jimu-basic-service-chooser-content");this.multiple=!!this.multiple;this._initSelf();this.exampleTd.innerHTML=this.exampleTd.innerHTML},setUrl:function(a){var b=new d;(this.url=a)&&"string"===typeof this.url?(this.urlInput.set("value",this.url),b=this._onBtnValidateClick()):b.reject();return b},focusInput:function(){this.urlInput.focus()},_initSelf:function(){this._examples&&0<this._examples.length?b.forEach(this._examples,h.hitch(this,function(a){e.create("div",{innerHTML:a,
"class":"example-url"},this.exampleTd)})):e.setStyle(this.exampleTr,"display","none");var a={multiple:this.multiple,_onTreeClick:h.hitch(this,this._onTreeClick)};this.serviceBrowser=this._createServiceBrowser(a);this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup();this.own(r.after(this.urlInput,"validator",h.hitch(this,this._afterUrlValidate)));this.url&&"string"===typeof this.url&&this.urlInput.set("value",this.url);this.own(n(this.serviceBrowser,"error",h.hitch(this,
this._onServiceBrowserError)))},_createServiceBrowser:function(a){},_validateUrl:function(a){a=a.replace(/\/*$/g,"");if((a=a.match(/\/rest\/services\/*(.*)/gi))&&0<a.length)if(a=a[0].replace(/\/rest\/services\/*/,"")){var b=a.split("/");if(1===b.length)return!0;if(2===b.length)return this.serviceBrowser.isServiceTypeSupported(b[1]);if(3<=b.length)return a=this.serviceBrowser.isServiceTypeSupported(b[1]),b=this.serviceBrowser.isServiceTypeSupported(b[2]),a||b}else return!0;else return!1},_afterUrlValidate:function(a){a&&
(a=this.urlInput.get("value"),a=this._validateUrl(a));a?e.removeClass(this.btnValidate,"jimu-state-disabled"):e.addClass(this.btnValidate,"jimu-state-disabled");return a},_onServiceBrowserError:function(a){this._showErrorMessage(a)},_showErrorMessage:function(a){a&&"string"===typeof a?(this.errorNode.innerHTML=a,e.addClass(this.errorSection,"visible")):e.removeClass(this.errorSection,"visible")},_clearErrorMessage:function(){this.errorNode.innerHTML="";e.removeClass(this.errorSection,"visible")},
_onBtnValidateClick:function(){this._clearErrorMessage();var a=new d;if(this.urlInput.validate()){var b=this.urlInput.get("value");this.serviceBrowser.setUrl(b).then(h.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.resolve()}),h.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.reject()}));this.emit("validate-click")}else a.reject();return a},_checkSelectedItemsNumber:function(){0<this.getSelectedItems().length?e.removeClass(this.btnOk,"jimu-state-disabled"):
e.addClass(this.btnOk,"jimu-state-disabled")},_onTreeClick:function(){this._checkSelectedItemsNumber()},_onBtnOkClick:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnCancelClick:function(){this.emit("cancel")}})})},"widgets/Query/setting/SingleQuerySetting":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./SingleQuerySetting.html dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented jimu/utils jimu/dijit/TabContainer3 jimu/dijit/Message jimu/dijit/_QueryableLayerSourcePopup ./PopupConfig esri/request esri/symbols/jsonUtils jimu/dijit/Filter jimu/dijit/SymbolPicker jimu/dijit/LoadingShelter dijit/form/ValidationTextBox".split(" "),
function(l,q,t,s,g,c,d,e,b,h,n,r,u,a,v,k,f,p){return l([q,t,s,h],{baseClass:"jimu-widget-single-query-setting",templateString:g,map:null,nls:null,tr:null,appConfig:null,_layerDefinition:null,postCreate:function(){this.inherited(arguments);this._initSelf()},destroy:function(){this.tr=null;delete this.tr;this.inherited(arguments)},setConfig:function(a){this.config=a;if(this._isObject(this.config)){var b=a.url||"";b&&"string"===typeof b&&(this._layerDefinition&&this._layerDefinition.url===b?(this.tab.hideShelter(),
this._resetByConfig(this.config,this._layerDefinition)):(this._layerDefinition=null,this.showBigShelter(),k({url:b,handAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(c.hitch(this,function(a){this.domNode&&(this.hideBigShelter(),this.tab.hideShelter(),this._layerDefinition=a,this._layerDefinition.url=b,this._resetByConfig(this.config,this._layerDefinition))}),c.hitch(this,function(a){console.error(a);this.domNode&&this.hideBigShelter()}))))}},getConfig:function(){var a={name:"",url:"",
filter:{useFilter:"",filterInfo:""},popup:"",resultsSymbol:"",objectIdField:"",orderByFields:[]};if(!this._layerDefinition)return this.scrollToDom(this.generalTable),new u({message:this.nls.setSourceTip}),null;a.url=this._layerDefinition.url;var b=n.stripHTML(this.queryNameTextBox.get("value"));if(!b)return this.showValidationErrorTip(this.queryNameTextBox),null;a.name=b;b=this.filter.toJson();if(!b)return new u({message:this.nls.setFilterTip}),null;a.filter=b;b=this.popupConfig.getConfig();if(!b)return null;
a.orderByFields=b.orderByFields;delete b.orderByFields;a.popup=b;if(this._isTable(this._layerDefinition))a.resultsSymbol=null;else if(b=this.layerSymbolPicker.getSymbol())a.resultsSymbol=b.toJson();else return null;this._layerDefinition.objectIdField?a.objectIdField=this._layerDefinition.objectIdField:(b=d.filter(this._layerDefinition.fields,c.hitch(this,function(a){return"esriFieldTypeOID"===a.type})),0<b.length&&(a.objectIdField=b[0].name));this.tr._layerDefinition=this._layerDefinition;return a},
scrollToDom:function(a){a=e.coords(a).y;var b=e.coords(this.domNode).y;this.domNode.parentNode.scrollTop=a-b},showValidationErrorTip:function(a){!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),setTimeout(c.hitch(this,function(){a.focusNode.blur()}),100))},showBigShelter:function(){this.emit("show-shelter")},hideBigShelter:function(){this.emit("hide-shelter")},showQueryDefinition:function(){this.tab.selectTab(this.nls.queryDefinition)},showResultsSetting:function(){this.tab.selectTab(this.nls.resultsSetting)},
_initSelf:function(){this._initFilter();this._initPopupConfig();this._initTabs()},_initFilter:function(){this.filter=new p({enableAskForValues:!0,noFilterTip:this.nls.noFilterTip,style:"width:100%;margin-top:22px;"});this.filter.placeAt(this.filterDiv)},_initTabs:function(){this.tab=new r({tabs:[{title:this.nls.queryDefinition,content:this.definitionTabNode},{title:this.nls.resultsSetting,content:this.resultsTabNode}]});this.tab.placeAt(this.detailSection);this.tab.showShelter()},_initPopupConfig:function(){this.popupConfig=
new v({nls:this.nls,sqs:this});this.popupConfig.placeAt(this.popupContainer)},_getRandomString:function(){var a=Math.random().toString();return a=a.slice(2,a.length)},_onQueryNameChanged:function(){this.emit("name-change",this.queryNameTextBox.get("value"))},_onQueryNameBlurred:function(){var a=n.stripHTML(this.queryNameTextBox.get("value"));this.queryNameTextBox.set("value",a)},_clear:function(){this.urlTextBox.set("value","");this._layerDefinition=null;this.queryNameTextBox.set("value","");this.filter.reset();
this.tab.showShelter();this.popupConfig.clear();this.layerSymbolPicker.reset()},_onBtnSetSourceClicked:function(){var f=new a({titleLabel:this.nls.setDataSource,dijitArgs:{multiple:!1,createMapResponse:this.map.webMapResponse,portalUrl:this.appConfig.portalUrl,style:{height:"100%"}}});this.own(b(f,"ok",c.hitch(this,function(a){var b=f.getSelectedRadioType();f.close();var c=f=null;"map"===b&&(b=a.layerInfo&&a.layerInfo.layerObject)&&"function"===typeof b.getDefinitionExpression&&(c=b.getDefinitionExpression());
this.setNewLayerDefinition(a.name,a.url,a.definition,null,c)})));this.own(b(f,"cancel",c.hitch(this,function(){f.close();f=null})));f.startup()},setNewLayerDefinition:function(a,b,c,f,p){c.name=a;c.url=b;b!==(this._layerDefinition&&this._layerDefinition.url)&&this._resetByNewLayerDefinition(c,f,p)},_isImageServiceLayer:function(a){return-1<a.url.indexOf("/ImageServer")},_isTable:function(a){return"Table"===a.type},_showSymbolSection:function(){e.setStyle(this.symbolSection,"display","block")},_hideSymbolSection:function(){e.setStyle(this.symbolSection,
"display","none")},_resetByNewLayerDefinition:function(a,b,c){this._clear();if(a){this._layerDefinition=a;var f=a.url;this.urlTextBox.set("value",f);this.queryNameTextBox.set("value",b||a.name);this.tab.hideShelter();this.filter.reset();this._layerDefinition&&this.filter.buildByExpr(f,c||"1\x3d1",this._layerDefinition);b="";a.displayField&&(b="${"+a.displayField+"}");this.popupConfig.setConfig({title:b,fields:[],orderByFields:[]});this.popupConfig.updateSortingIcon(this._layerDefinition);b="";this._isImageServiceLayer(a)?
b="fill":this._isTable(a)?b="":a.geometryType&&(a=n.getTypeByGeometryType(a.geometryType),"point"===a?b="marker":"polyline"===a?b="line":"polygon"===a&&(b="fill"));b?(this._showSymbolSection(),this.layerSymbolPicker.showByType(b)):(this._hideSymbolSection(),this.layerSymbolPicker.reset())}},_resetByConfig:function(a,b){var p=c.clone(a);this.urlTextBox.set("value",p.url);this.queryNameTextBox.set("value",p.name||"");var d=p.filter;this._isObject(d)&&(this.filter.reset(),this._isObject(d)?this.filter.buildByFilterObj(b.url,
d,b):this.filter.buildByExpr(b.url,"1\x3d1",b),this.popupConfig.clear(),this._isObject(p.popup)||(p.popup={title:"",fields:[]}),p.popup.fields&&0<=p.popup.fields.length||(p.popup.fields=[]),p.popup.title||(p.popup.title=""),this.popupConfig.setConfig({title:p.popup.title,fields:p.popup.fields,orderByFields:p.orderByFields}),this.popupConfig.updateSortingIcon(b),this._isTable(b)?(this._hideSymbolSection(),this.layerSymbolPicker.reset()):(this._showSymbolSection(),p.resultsSymbol&&(p=f.fromJson(p.resultsSymbol),
this.layerSymbolPicker.showBySymbol(p))))},_isObject:function(a){return a&&"object"===typeof a}})})},"widgets/Query/setting/PopupConfig":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./PopupConfig.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query jimu/dijit/SimpleTable jimu/dijit/Popup dijit/TooltipDialog dijit/Menu dijit/MenuItem dijit/popup ./SortFields".split(" "),function(l,q,t,s,g,c,d,e,b,h,n,r,u,a,
v,k,f){return l([q,t,s],{baseClass:"jimu-query-setting-popup-config",templateString:g,_currentOrderByFields:null,_validSortFieldTypes:"esriFieldTypeOID esriFieldTypeString esriFieldTypeDate esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble".split(" "),nls:null,sqs:null,config:null,postCreate:function(){this.inherited(arguments);this._currentOrderByFields=[];this._initFieldsTable();this._initAddFields();this.clear();this.config&&this.setConfig(this.config)},setConfig:function(a){this.clear();
this.config=c.clone(a);this.config.title&&"string"===typeof this.config.title?this.titleTextBox.set("value",this.config.title||""):this.titleTextBox.set("value","");var b=this._getLayerDefinition();if(b){var f={};a=e.map(this.config.fields,c.hitch(this,function(a){var b=a.name;f[b]=a;return b}));b=c.clone(b.fields);b=this._getSortedFieldInfos(a,b);e.forEach(b,c.hitch(this,function(a){a.visibility=!1;a.specialType="none";var b=f[a.name];b&&(a=c.mixin(a,b),a.visibility=!0)}));this._setFields(b)}else this._setFields([]);
this._setOrderByFields(this.config.orderByFields)},_getSortedFieldInfos:function(a,b){var f=[],d={};e.forEach(b,c.hitch(this,function(a){d[a.name]=a}));var k=[],k=k.concat(a);e.forEach(b,c.hitch(this,function(a){a=a.name;0>k.indexOf(a)&&k.push(a)}));return f=e.map(k,c.hitch(this,function(a){return d[a]}))},getConfig:function(){var a={title:"",fields:[],orderByFields:[]};if(!this.titleTextBox.validate())return this.sqs.showResultsSetting(),this.sqs.scrollToDom(this.titleTextBox.domNode),this.sqs.showValidationErrorTip(this.titleTextBox),
null;a.title=this.titleTextBox.get("value");var b=this.fieldsTable.getRows(),f=[];e.forEach(b,c.hitch(this,function(a){a=this.fieldsTable.getRowData(a);a.visibility&&f.push({name:a.name,alias:a.alias||a.name,specialType:a.specialType})}));a.fields=f;b=this._getLayerDefinition();this._shouldEnableSorting(b)&&(a.orderByFields=this._getOrderByFields());return a},clear:function(){d.removeClass(this.btnSortFields,"enabled");this._currentOrderByFields=[];this.titleTextBox.set("value","");this.fieldsTable.clear();
this._resetMenu();this._addEmptyMenuItem()},destroy:function(){this.sqs=null;this.titleTextBox.focusNode.blur();this.inherited(arguments)},updateSortingIcon:function(a){this._shouldEnableSorting(a)?d.addClass(this.btnSortFields,"enabled"):d.removeClass(this.btnSortFields,"enabled")},_getLayerDefinition:function(){return this.sqs._layerDefinition},_initFieldsTable:function(){var a={autoHeight:!1,style:"height:187px",fields:[{name:"visibility",title:this.nls.visibility,type:"checkbox"},{name:"name",
title:this.nls.name,type:"text",editable:!1},{name:"alias",title:this.nls.alias,type:"text",editable:!0},{name:"specialType",title:this.nls.specialType,type:"extension",create:c.hitch(this,this._createSpecialType),setValue:c.hitch(this,this._setValue4SpecialType),getValue:c.hitch(this,this._getValueOfSpecialType)},{name:"actions",title:this.nls.actions,type:"actions",actions:["up","down"]}]};this.fieldsTable=new n(a);this.fieldsTable.placeAt(this.fieldsContainer);this.fieldsTable.startup()},_createSpecialType:function(a){a=
d.create("select",{},a);d.create("option",{value:"none",label:this.nls.none,selected:!0,innerHTML:this.nls.none},a);d.create("option",{value:"link",label:this.nls.link,innerHTML:this.nls.link},a);d.create("option",{value:"image",label:this.nls.image,innerHTML:this.nls.image},a)},_setValue4SpecialType:function(a,b){h("select",a)[0].value=b},_getValueOfSpecialType:function(a){return h("select",a)[0].value},_initAddFields:function(){var f=d.create("div");this.tooltipDialog=new u({style:"cursor:pointer",
content:f});this.menu=new a;this.menu.placeAt(f);this.own(b(document.body,"click",c.hitch(this,function(){k.close(this.tooltipDialog)})))},_onAddClicked:function(a){a.stopPropagation();a.preventDefault();k.close(this.tooltipDialog);k.open({popup:this.tooltipDialog,around:this.btnAddFields})},_resetMenu:function(){var a=this.menu.getChildren();e.forEach(a,c.hitch(this,function(a){this.menu.removeChild(a)}))},_addEmptyMenuItem:function(){var a=new v({label:this.nls.noField,onClick:c.hitch(this,function(){var a=
this.menu.getParent();d.setStyle(a.domNode.parentNode,"display","none")})});this.menu.addChild(a)},_setFields:function(a){this._resetMenu();a=e.filter(a,function(a){return"esriFieldTypeGeometry"!==a.type});0<a.length?e.forEach(a,c.hitch(this,function(a){this._addMenuItem(a);this._addRow(a)})):this._addEmptyMenuItem()},_addMenuItem:function(a){var b=new v({label:a.name+" {"+a.name+"}",onClick:c.hitch(this,function(){var b=this.titleTextBox.get("value")+"${"+a.name+"}";this.titleTextBox.set("value",
b);b=this.menu.getParent();d.setStyle(b.domNode.parentNode,"display","none")})});this.menu.addChild(b)},_addRow:function(a){a=c.clone(a);var b=this.fieldsTable.addRow(a);b.success&&(b.tr.fieldInfo=a)},_onBtnSortFieldsClicked:function(){var a=this._getLayerDefinition();if(a&&this._shouldEnableSorting(a))var b=new f({nls:this.nls,layerDefinition:a,orderByFields:c.clone(this._currentOrderByFields),validSortFieldTypes:this._validSortFieldTypes}),d=new r({width:640,height:380,titleLabel:this.nls.setSortingFields,
content:b,onClose:c.hitch(this,function(){b.destroy()}),buttons:[{label:this.nls.ok,onClick:c.hitch(this,function(){var a=b.getOrderByFields();this._setOrderByFields(a);d.close()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:c.hitch(this,function(){d.close()})}]})},_shouldEnableSorting:function(a){return this._isServiceSupportsPagination(a)&&this._isServiceSupportsOrderBy(a)},_isServiceSupportsPagination:function(a){var b=!1;a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsPagination&&
(b=!0);return b},_isServiceSupportsOrderBy:function(a){var b=!1;a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsOrderBy&&(b=!0);return b},_getOrderByFields:function(){return this._currentOrderByFields},_setOrderByFields:function(a){a=a||[];var b=this.sortFieldsDiv.innerHTML="";a=e.map(a,c.hitch(this,function(c,f){var d=c.split(" "),e=d[0],k="ASC";d[1]&&"string"===typeof d[1]&&(d[1]=d[1].toUpperCase(),"DESC"===d[1]&&(k="DESC"));d=k.toLowerCase();d="\x3cspan\x3e"+e+'\x3c/span\x3e\x3cspan class\x3d"sort-arrow '+
d+'"\x3e\x3c/span\x3e';f!==a.length-1&&(d+="\x3cspan\x3e,\x26nbsp;\x3c/span\x3e");b+=d;return e+" "+k}));b&&(b="\x3cspan\x3e\x26nbsp;\x26nbsp;\x3c/span\x3e"+b);this.sortFieldsDiv.innerHTML=b;this._currentOrderByFields=a}})})},"widgets/Query/setting/SortFields":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/registry dijit/form/Select dojo/text!./SortFields.html dojo/on dojo/query dojo/_base/lang dojo/_base/array dojo/_base/html jimu/dijit/SimpleTable".split(" "),
function(l,q,t,s,g,c,d,e,b,h,n,r,u){return l([q,t,s],{baseClass:"jimu-query-setting-sort-fields",templateString:d,_allFieldNames:null,_sortTipClassName:"sort-tip",_fieldNameSelectClassName:"field-name-select",_sortTypeSelectClassName:"sort-type-select",nls:null,layerDefinition:null,orderByFields:null,validSortFieldTypes:[],postCreate:function(){this.inherited(arguments);var a=n.filter(this.layerDefinition.fields,h.hitch(this,function(a){return 0<=this.validSortFieldTypes.indexOf(a.type)}));this._allFieldNames=
n.map(a,function(a){return a.name});this._initTable();this.orderByFields?this._setOrderByFields(this.orderByFields):this.orderByFields=[]},_initTable:function(){var a={autoHeight:!1,style:"height:187px",fields:[{name:"sortTip",title:this.nls.field,type:"text",width:"100px"},{name:"fieldName",title:"",type:"extension",create:h.hitch(this,this._create4FieldName),setValue:h.hitch(this,this._setValue4FieldName),getValue:h.hitch(this,this._getValue4FieldName)},{name:"sortType",title:this.nls.sortingOrder,
type:"extension",create:h.hitch(this,this._create4SortType),setValue:h.hitch(this,this._setValue4SortType),getValue:h.hitch(this,this._getValue4SortType)},{name:"actions",title:this.nls.actions,type:"actions",actions:["up","down","delete"],width:"120px"}]};this.table=new u(a);this.own(e(this.table,"row-up",h.hitch(this,this._onTableRowUp)));this.own(e(this.table,"row-down",h.hitch(this,this._onTableRowDown)));this.table.placeAt(this.tableDiv);this.table.startup()},getOrderByFields:function(){var a=
this.table.getData();return n.map(a,h.hitch(this,function(a){return a.fieldName+" "+a.sortType}))},_getFieldAlias:function(a){for(var b=a,c=this.layerDefinition.fields,f=0;f<c.length;f++)if(c[f].name===a){b=c[f].alias||a;break}return b},_getRestFields:function(){var a=this._getAllFieldSelects(),b=n.map(a,h.hitch(this,function(a){return a.get("value")}));return n.filter(this._allFieldNames,h.hitch(this,function(a){return 0>b.indexOf(a)}))},_onAddNewClicked:function(){var a=this._getRestFields();if(0!==
a.length){var b="",b=0===this.table.getRows().length?this.nls.sortBy:this.nls.thenBy;this.table.addRow({sortTip:b,fieldName:a[0],sortType:"ASC"})}},_setOrderByFields:function(a){this.table.clear();a=a||[];n.forEach(a,h.hitch(this,function(a,b){var c=a.split(" "),d=c[0],e="ASC";c[1]&&"string"===typeof c[1]&&(c[1]=c[1].toUpperCase(),"DESC"===c[1]&&(e="DESC"));c="";c=0===b?this.nls.sortBy:this.nls.thenBy;this.table.addRow({sortTip:c,fieldName:d,sortType:e})}))},_getAllFieldSelects:function(){var a=b("."+
this._fieldNameSelectClassName,this.table.tbody);return n.map(a,h.hitch(this,function(a){return g.byNode(a)}))},_getSelectFromTd:function(a,c){var d=b("."+c,a)[0];return g.byNode(d)},_onTableRowUp:function(){this._resetSortTips()},_onTableRowDown:function(){this._resetSortTips()},_getAllSortTipDivs:function(){return b(".sortTip .normal-text-div",this.table.tbody)},_resetSortTips:function(){var a=this.table.getRows();n.forEach(a,h.hitch(this,function(a,b){var c="",c=0===b?this.nls.sortBy:this.nls.thenBy;
this.table.editRow(a,{sortTip:c})}));a=this._getAllSortTipDivs();n.forEach(a,h.hitch(this,function(a,b){a.innerHTML=0===b?this.nls.sortBy:this.nls.thenBy}))},_create4FieldName:function(a){var b=this._getRestFields(),d=new c({style:"width:120px;height:20px;"});r.addClass(d.domNode,this._fieldNameSelectClassName);r.addClass(d.domNode,"restrict-select-width");d.placeAt(a);n.forEach(b,h.hitch(this,function(a){var b=this._getFieldAlias(a);d.addOption({value:a,label:b})}));this.own(e(d,"change",h.hitch(this,
this._onFieldNameSelectChanged)))},_setValue4FieldName:function(a,b){this._getSelectFromTd(a,this._fieldNameSelectClassName).set("value",b)},_getValue4FieldName:function(a){return this._getSelectFromTd(a,this._fieldNameSelectClassName).get("value")},_onFieldNameSelectChanged:function(){var a=this._getAllFieldSelects();n.forEach(a,h.hitch(this,function(a){var b=a.get("value");a.domNode.title="";var c=a.getOptions(b);c&&c.label&&(a.domNode.title=c.label);c=a.getOptions();c=n.filter(c,h.hitch(this,function(a){return a.value!==
b}));a.removeOption(c);c=this._getRestFields();n.forEach(c,h.hitch(this,function(c){if(c!==b){var f=this._getFieldAlias(c);a.addOption({value:c,label:f})}}))}))},_create4SortType:function(a){var b=new c({style:"width:120px;height:20px;"});r.addClass(b.domNode,this._sortTypeSelectClassName);b.placeAt(a);b.addOption({value:"ASC",label:this.nls.ascending,selected:!0});b.addOption({value:"DESC",label:this.nls.descending})},_setValue4SortType:function(a,b){var c=this._getSelectFromTd(a,this._sortTypeSelectClassName);
("ASC"===b||"DESC"===b)&&c.set("value",b)},_getValue4SortType:function(a){return this._getSelectFromTd(a,this._sortTypeSelectClassName).get("value")}})})},"jimu/dijit/Filter":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/Filter.html jimu/filterUtils jimu/utils dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/aspect dojo/query dojo/Deferred esri/request ./_SingleFilter ./_FilterSet ./LoadingIndicator".split(" "),
function(l,q,t,s,g,c,d,e,b,h,n,r,u,a,v,k,f){return l([q,t,s,c],{templateString:g,baseClass:"jimu-filter",declaredClass:"jimu.dijit.Filter",nls:null,_validOptions:!1,_layerDefinition:null,_def:null,noFilterTip:"",enableAskForValues:!1,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;var a=this.nls.matchMsg.split("${any_or_all}");this.nls.strMatchMsgPart1=a[0]||"";this.nls.strMatchMsgPart2=a[1]||"";this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.noFilterTip&&
"string"===typeof this.noFilterTip&&(this.noFilterTipSection.innerHTML=this.noFilterTip)},reset:function(){this.isBuilding()||(this.removeAllFilters(),this.url=null,this.isHosted=!1,this.partsObj=this.expr=this._layerDefinition=null)},isBuilding:function(){return this._def&&!this._def.isFulfilled()},buildByExpr:function(b,c,f){var e=new a;this.isBuilding()?e.reject("Filter is already building."):(this._def=null,this.reset(),this.url=b,this.isHosted=d.isHostedService(this.url),this.expr=c||"1\x3d1",
this._layerDefinition=f,e=this._def=this._init("expr"));return e},buildByFilterObj:function(b,c,f){var e=new a;this.isBuilding()?e.reject("Filter is already building."):(this._def=null,this.reset(),this.url=b,this.isHosted=d.isHostedService(this.url),this.partsObj=c,this._layerDefinition=f,e=this._def=this._init("partsObj"));return e},removeAllFilters:function(){this._destroyAllFilters()},_validateLayerDefinition:function(a){return this._isObject(a)},_init:function(c){var f=new a;if(!this._isString(this.url))return f.reject(),
f;var d=b.hitch(this,function(){setTimeout(b.hitch(this,function(){f.resolve()}),1500)}),e=b.hitch(this,function(){h.setStyle(this.contentSection,"display","block");h.setStyle(this.errorSection,"display","none");this.removeAllFilters();var a=this._layerDefinition.fields;a&&0<a.length?(a=n.filter(a,b.hitch(this,function(a){return 0<=this._supportFieldTypes.indexOf(a.type)})))&&0<a.length?(this._validOptions=!0,h.removeClass(this.btnAddSet,"jimu-state-disabled"),h.removeClass(this.btnAddExp,"jimu-state-disabled"),
h.removeClass(this.iconAddExp,"jimu-state-disabled"),h.removeClass(this.iconAddSet,"jimu-state-disabled"),this.createFieldsStore(),"expr"===c?this._isString(this.expr)?("1\x3d1"===this.expr.replace(/\s/gi,"")&&this.removeAllFilters(),this._parseExpr(this.expr)?d():f.reject()):f.reject():"partsObj"===c?this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),d()):f.reject():this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),d()):this._isString(this.expr)?this._parseExpr(this.expr)?
d():f.reject():(this.removeAllFilters(),d())):(this._showErrorOptions(this.nls.error.noFilterFields),f.reject()):f.reject()});this._validateLayerDefinition(this._layerDefinition)?e():(this.loading.show(),v({url:this.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(b.hitch(this,function(a){this.domNode?(this.loading.hide(),this._layerDefinition=a,e()):f.reject()}),b.hitch(this,function(a){console.error(a);f.reject();this.domNode&&this.loading.hide()})));return f},toJson:function(){var a=
{logicalOperator:this.allAnySelect.value,parts:[]},c=this._getAllSingleFiltersAndFilterSets();if(0===c.length)return a.expr="1\x3d1",a;n.forEach(c,b.hitch(this,function(b){b=b.toJson();a.parts.push(b)}));return n.every(a.parts,b.hitch(this,function(a){return!!a}))&&0<a.parts.length?(a.expr=this.getExprByFilterObj(a),a):null},createFieldsStore:function(){if(!this._layerDefinition.fields||0===this._layerDefinition.fields.length)this._showErrorOptions(this.nls.error.noFilterFields);else{var a=b.clone(this._layerDefinition).fields;
0===this.setFieldsStoreByFieldInfos(a)&&this._showErrorOptions(this.nls.error.noFilterFields)}},_parsePartsObj:function(a){this._validatePartsObj(a)&&(this.removeAllFilters(),this._buildEditUIByPartsObj(a))},_parseExpr:function(a){this._destroyAllFilters();var b=null;if(!this._validateLayerDefinition(this._layerDefinition))return b;if(!a||"string"!==typeof a)return this._showErrorOptions(this.nls.error.invalidSQL),b;if("1\x3d1"===this.expr.replace(/\s/gi,""))return b={expr:"1\x3d1",parts:[],logicalOperator:"AND"};
try{b=this.getFilterObjByExpr(a)}catch(c){b=null,console.error(c)}b?this._buildEditUIByPartsObj(b):this._showErrorOptions(this.nls.error.cantParseSQL);return b},_buildEditUIByPartsObj:function(a){a&&(this._destroyAllFilters(),this.allAnySelect.value=a.logicalOperator,n.forEach(a.parts,b.hitch(this,function(a){a.parts?this._addFilterSet(a):a.fieldObj&&(a.operator&&a.valueObj)&&this._addSingleFilter(a)})))},_addSingleFilter:function(a){a={url:this.url,layerInfo:this._layerDefinition,stringFieldType:this._stringFieldType,
dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,part:a,OPERATORS:b.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,isHosted:this.isHosted};a=new k(a);a.placeAt(this.allExpsBox);a.startup();this.own(r.after(a,"_destroySelf",b.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_addFilterSet:function(a){a={url:this.url,layerInfo:this._layerDefinition,stringFieldType:this._stringFieldType,dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,
partsObj:a,OPERATORS:b.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,isHosted:this.isHosted};a=new f(a);a.placeAt(this.allExpsBox);a.startup();this.own(r.after(a,"_destroySelf",b.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_destroyAllFilters:function(){for(var a=this._getAllSingleFiltersAndFilterSets();0<a.length;)a[0].destroy(),a.splice(0,1);this._checkFilterNumbers()},_getAllSingleFiltersAndFilterSetsDoms:function(){return u(".allExpsBox\x3e.jimu-single-filter,.allExpsBox\x3e.jimu-filter-set",
this.contentSection)},_getAllSingleFiltersAndFilterSets:function(){var a=this._getAllSingleFiltersAndFilterSetsDoms();return n.map(a,b.hitch(this,function(a){return e.byNode(a)}))},_checkFilterNumbers:function(){var a=this._getAllSingleFiltersAndFilterSetsDoms();1<a.length?h.setStyle(this.matchMsg,"display","block"):h.setStyle(this.matchMsg,"display","none");0<a.length?h.setStyle(this.noFilterTipSection,"display","none"):h.setStyle(this.noFilterTipSection,"display","block");n.forEach(a,b.hitch(this,
function(a,b){h.removeClass(a,"even-filter");h.removeClass(a,"odd-filter");h.addClass(a,0===(b+1)%2?"even-filter":"odd-filter")}))},_showErrorOptions:function(a){console.error(a);h.setStyle(this.contentSection,"display","none");h.setStyle(this.errorSection,"display","none");this.errorTip.innerHTML=a;this.loading.hide()},_onBtnAddSetClick:function(){this._layerDefinition&&this._validOptions&&this._addFilterSet()},_onBtnAddExpClick:function(){this._layerDefinition&&this._validOptions&&this._addSingleFilter()}})})},
"jimu/dijit/_SingleFilter":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilter.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/json dojo/on dojo/store/Memory esri/request jimu/utils jimu/dijit/CheckBox dijit/form/Select dijit/form/FilteringSelect dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/NumberTextBox".split(" "),function(l,q,t,s,g,c,d,e,b,h,n,r,u){return l([q,t,s],{templateString:g,
baseClass:"jimu-single-filter",declaredClass:"jimu.dijit._SingleFilter",nls:null,url:null,layerInfo:null,stringFieldType:"",dateFieldType:"",numberFieldTypes:[],supportFieldTypes:[],part:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,postMixInProperties:function(){this.supportFieldTypes=[];this.supportFieldTypes.push(this.stringFieldType);this.supportFieldTypes.push(this.dateFieldType);this.supportFieldTypes=this.supportFieldTypes.concat(this.numberFieldTypes);this.nls=window.jimuNls.filterBuilder;
this.nls.caseSensitive||(this.nls.caseSensitive="Case Sensitive")},postCreate:function(){this.inherited(arguments);this._initSelf()},toJson:function(){var a=null,b=this._isUseAskForValues(),c=this._getSelectedFilteringItem(this.fieldsSelect);if(!c)return null;a={fieldObj:"",operator:"",valueObj:"",interactiveObj:"",caseSensitive:!1};if(b){if(!this.promptTB.validate())return this._showValidationErrorTip(this.promptTB),null;a.interactiveObj={prompt:this.promptTB.get("value"),hint:this.hintTB.get("value")}}a.fieldObj=
{name:c.name,label:c.name,shortType:c.shortType,type:c.type};if("none"===this.operatorsSelect.get("value"))return null;a.operator=this.operatorsSelect.get("value");a.valueObj={isValid:!0,type:""};var f=c.shortType;if(this.valueRadio.checked)if(a.valueObj.type="value","string"===f)if(a.operator===this.OPERATORS.stringOperatorIsBlank||a.operator===this.OPERATORS.stringOperatorIsNotBlank)a.valueObj.value=null;else if(this._isFieldCoded(c)&&a.operator===this.OPERATORS.stringOperatorIs){if(!this.stringCodedValuesFS.validate())return this._showValidationErrorTip(this.stringCodedValuesFS),
null;b=this._getSelectedFilteringItem(this.stringCodedValuesFS);a.valueObj.value=b?b.code:""}else{if(!this.stringTextBox.validate())return this._showValidationErrorTip(this.stringTextBox),null;a.valueObj.value=this.stringTextBox.get("value")}else if("number"===f)if(a.operator===this.OPERATORS.numberOperatorIsBlank||a.operator===this.OPERATORS.numberOperatorIsNotBlank)a.valueObj.value=null;else if(a.operator===this.OPERATORS.numberOperatorIsBetween||a.operator===this.OPERATORS.numberOperatorIsNotBetween){if(!this.numberTextBox1.validate())return this._showValidationErrorTip(this.numberTextBox1),
null;if(!this.numberTextBox2.validate())return this._showValidationErrorTip(this.numberTextBox2),null;a.valueObj.value1=this._getValueForNumberTextBox(this.numberTextBox1);a.valueObj.value2=this._getValueForNumberTextBox(this.numberTextBox2);a.valueObj.isValid=u.isValidNumber(a.valueObj.value1)&&u.isValidNumber(a.valueObj.value2)}else{if(this._isFieldCoded(c)&&a.operator===this.OPERATORS.numberOperatorIs){if(!this.numberCodedValuesFS.validate())return this._showValidationErrorTip(this.numberCodedValuesFS),
null;b=this._getSelectedFilteringItem(this.numberCodedValuesFS);a.valueObj.value=b?parseFloat(b.code):null}else{if(!this.numberTextBox.validate())return this._showValidationErrorTip(this.numberTextBox),null;a.valueObj.value=this._getValueForNumberTextBox(this.numberTextBox)}a.valueObj.isValid=u.isValidNumber(a.valueObj.value)}else{if("date"===f)if(a.operator===this.OPERATORS.dateOperatorIsBlank||a.operator===this.OPERATORS.dateOperatorIsNotBlank)a.valueObj.value=null;else if(a.operator===this.OPERATORS.dateOperatorIsBetween||
a.operator===this.OPERATORS.dateOperatorIsNotBetween){if(!this.dateTextBox1.validate())return this._showValidationErrorTip(this.dateTextBox1),null;if(!this.dateTextBox2.validate())return this._showValidationErrorTip(this.dateTextBox2),null;a.valueObj.value1=this.dateTextBox1.get("value").toDateString();a.valueObj.value2=this.dateTextBox2.get("value").toDateString()}else{if(!this.dateTextBox.validate())return this._showValidationErrorTip(this.dateTextBox),null;a.valueObj.value=this.dateTextBox.get("value").toDateString()}}else if(this.fieldRadio.checked){b=
this._getSelectedFilteringItem(this.fieldsSelect2);if(!b)return this._showValidationErrorTip(this.fieldsSelect2),null;a.valueObj.value=b.name;a.valueObj.label=b.name;a.valueObj.type="field"}else if(this.uniqueRadio&&this.uniqueRadio.checked)if(a.valueObj.type="unique",c=this._getSelectedFilteringItem(this.uniqueValuesSelect))"string"===f?a.valueObj.value=c.value:"number"===f&&(a.valueObj.value=parseFloat(c.value));else if(b)"string"===f?a.valueObj.value="":"number"===f&&(a.valueObj.value=null,a.valueObj.isValid=
!1);else return this._showValidationErrorTip(this.uniqueValuesSelect),null;if("string"===f)switch(a.operator){case this.OPERATORS.stringOperatorStartsWith:case this.OPERATORS.stringOperatorEndsWith:case this.OPERATORS.stringOperatorContains:case this.OPERATORS.stringOperatorDoesNotContain:a.caseSensitive=this.cbxCaseSensitive.getValue()}return a},showDelteIcon:function(){d.setStyle(this.btnDelete,"display","inline-block")},hideDeleteIcon:function(){d.setStyle(this.btnDelete,"display","none")},_showCaseSensitive:function(){d.setStyle(this.cbxCaseSensitive.domNode,
"display","inline-block")},_hideCaseSensitive:function(){d.setStyle(this.cbxCaseSensitive.domNode,"display","none")},_getProcessedString:function(a){return u.isNotEmptyString(a,!0)?a:""},_getProcessedNumber:function(a){return u.isValidNumber(a)?a:null},_setValueForStringTextBox:function(a,b){b=this._getProcessedString(b);a.set("value",b)},_setValueForNumberTextBox:function(a,b){u.isValidNumber(b)&&a.set("value",b)},_getValueForNumberTextBox:function(a){a=a.get("value");return this._getProcessedNumber(a)},
_initSelf:function(){this.isHosted&&(this.cbxCaseSensitive.setValue(!1),this.cbxCaseSensitive.setStatus(!1),this.cbxCaseSensitive.domNode.title=this.nls.notSupportCaseSensitiveTip);this.own(h(this.cbxAskValues,"status-change",c.hitch(this,this._onCbxAskValuesStatusChanged)));this.cbxAskValues.onChange=c.hitch(this,this._onCbxAskValuesClicked);this.own(h(this.fieldsSelect,"MouseEnter",c.hitch(this,this._updateFieldsSelectTitle)));this.own(h(this.operatorsSelect,"MouseEnter",c.hitch(this,this._updateOperatorsSelectTitle)));
this.own(h(this.dateTextBox1,"MouseEnter",c.hitch(this,this._updateDateTextBox1Title)));this.own(h(this.dateTextBox2,"MouseEnter",c.hitch(this,this._updateDateTextBox2Title)));var a=new n({idProperty:"id",data:[]});this.uniqueValuesSelect.set("store",a);this.enableAskForValues?(d.setStyle(this.cbxAskValues.domNode,"display","inline-block"),d.setStyle(this.promptSection,"display","block")):(d.setStyle(this.cbxAskValues.domNode,"display","none"),d.setStyle(this.promptSection,"display","none"));this.layerInfo=
c.mixin({},this.layerInfo);this._initRadios();a=0;this.layerInfo.currentVersion&&(a=parseFloat(this.layerInfo.currentVersion));if(10.1>a||this._isStreamServer(this.url))d.destroy(this.uniqueTd),this.uniqueRadio=null;if((a=this.layerInfo.fields)&&0<a.length)a=e.filter(a,c.hitch(this,function(a){return 0<=this.supportFieldTypes.indexOf(a.type)})),this._enableRadios(),this._initFieldsSelect(a)},_isStreamServer:function(a){a=(a||"").replace(/\/*$/g,"");return/\/StreamServer$/gi.test(a)},_updateFieldsSelectTitle:function(){this.fieldsSelect.domNode.title=
"";var a=this._getSelectedFilteringItem(this.fieldsSelect);a&&(this.fieldsSelect.domNode.title=a.displayName||a.alias||a.name)},_updateOperatorsSelectTitle:function(){this.operatorsSelect.domNode.title="";var a=this.operatorsSelect.get("value");a&&(a=this.operatorsSelect.getOptions(a),this.operatorsSelect.domNode.title=a.label)},_updateDateTextBox1Title:function(){var a=this.dateTextBox1.get("displayedValue")||"";this.dateTextBox1.domNode.title=a},_updateDateTextBox2Title:function(){var a=this.dateTextBox2.get("displayedValue")||
"";this.dateTextBox2.domNode.title=a},_showValidationErrorTip:function(a){try{!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),a.focusNode.blur())}catch(b){console.error(b)}},_focusValidationTextBox:function(a){try{a&&a.focusNode&&a.focusNode.focus()}catch(b){console.error(b)}},_isFieldCoded:function(a){return(a=a.domain)&&"codedValue"===a.type&&a.codedValues&&0<a.codedValues.length},_getSelectedFilteringItem:function(a){if(a.validate()){var b=a.get("item");if(b)return b}this._showValidationErrorTip(a);
return null},_getShortTypeByFieldType:function(a){return a===this.stringFieldType?"string":a===this.dateFieldType?"date":0<=this.numberFieldTypes.indexOf(a)?"number":null},_getOperatorsByShortType:function(a){var b=[];"string"===a?b=[this.OPERATORS.stringOperatorIs,this.OPERATORS.stringOperatorIsNot,this.OPERATORS.stringOperatorStartsWith,this.OPERATORS.stringOperatorEndsWith,this.OPERATORS.stringOperatorContains,this.OPERATORS.stringOperatorDoesNotContain,this.OPERATORS.stringOperatorIsBlank,this.OPERATORS.stringOperatorIsNotBlank]:
"number"===a?b=[this.OPERATORS.numberOperatorIs,this.OPERATORS.numberOperatorIsNot,this.OPERATORS.numberOperatorIsAtLeast,this.OPERATORS.numberOperatorIsLessThan,this.OPERATORS.numberOperatorIsAtMost,this.OPERATORS.numberOperatorIsGreaterThan,this.OPERATORS.numberOperatorIsBetween,this.OPERATORS.numberOperatorIsNotBetween,this.OPERATORS.numberOperatorIsBlank,this.OPERATORS.numberOperatorIsNotBlank]:"date"===a&&(b=[this.OPERATORS.dateOperatorIsOn,this.OPERATORS.dateOperatorIsNotOn,this.OPERATORS.dateOperatorIsBefore,
this.OPERATORS.dateOperatorIsAfter,this.OPERATORS.dateOperatorIsBetween,this.OPERATORS.dateOperatorIsNotBetween,this.OPERATORS.dateOperatorIsBlank,this.OPERATORS.dateOperatorIsNotBlank]);return b},_initFieldsSelect:function(a){a=e.map(a,c.hitch(this,function(a,b){var d=c.mixin({},a);d.id=b;d.shortType=this._getShortTypeByFieldType(a.type);d.alias||(d.alias=d.name);var e="";"string"===d.shortType?e=this.nls.string:"number"===d.shortType?e=this.nls.number:"date"===d.shortType&&(e=this.nls.date);d.displayName=
d.alias+" ("+e+")";return d}));if(0<a.length){var b=new n({data:a});this.fieldsSelect.set("store",b);this.fieldsSelect.set("value",a[0].id)}this.fieldsSelect.focusNode.focus();this.fieldsSelect.focusNode.blur();this._onFieldsSelectChange();this.part&&this._showPart(this.part)},_showPart:function(a){if((this.part=a)&&this.part.fieldObj&&this.part.operator&&this.part.valueObj){a=this.part.fieldObj.name;var b=this.part.operator;this.part.caseSensitive=!!this.part.caseSensitive;a=this.fieldsSelect.store.query({name:a});
if(0!==a.length&&(a=a[0]))this.fieldsSelect.set("value",a.id),setTimeout(c.hitch(this,function(){this.domNode&&(this._onFieldsSelectChange(),this.operatorsSelect.set("value",b),setTimeout(c.hitch(this,function(){this.domNode&&this._resetByFieldAndOperation(this.part)}),50),setTimeout(c.hitch(this,function(){if(this.domNode){var a=this.part.interactiveObj;a&&(this.cbxAskValues.check(),this._updatePrompt(),this.promptTB.set("value",a.prompt||""),this.hintTB.set("value",a.hint||""))}}),100))}),0)}},
_onFieldsSelectChange:function(){this._updateFieldsSelectTitle();this.operatorsSelect.removeOption(this.operatorsSelect.getOptions());this.operatorsSelect.addOption({value:"none",label:this.nls.none});this.valueRadio.checked=!0;var a=this._getSelectedFilteringItem(this.fieldsSelect);a&&(this.operatorsSelect.shortType=a.shortType,a=this._getOperatorsByShortType(a.shortType),this.operatorsSelect.removeOption(this.operatorsSelect.getOptions()),e.forEach(a,c.hitch(this,function(a){this.operatorsSelect.addOption({value:a,
label:this.nls[a]})})));this._onOperatorsSelectChange()},_onOperatorsSelectChange:function(){this._updateOperatorsSelectTitle();this.valueRadio.checked=!0;this._resetByFieldAndOperation()},_onRangeNumberBlur:function(){if(this.numberTextBox1.validate()&&this.numberTextBox2.validate()){var a=this._getValueForNumberTextBox(this.numberTextBox1),b=this._getValueForNumberTextBox(this.numberTextBox2);u.isValidNumber(a)&&u.isValidNumber(b)&&a>b&&(this._setValueForNumberTextBox(this.numberTextBox1,b),this._setValueForNumberTextBox(this.numberTextBox2,
a))}},_onRangeDateBlur:function(){if(this.dateTextBox1.validate()&&this.dateTextBox2.validate()){var a=this.dateTextBox1.get("value"),b=a.getTime(),c=this.dateTextBox2.get("value"),f=c.getTime();b>f&&(this.dateTextBox1.set("value",c),this.dateTextBox2.set("value",a))}},_initRadios:function(){var a="radio_"+u.getRandomString();this.valueRadio.name=a;this.fieldRadio.name=a;u.combineRadioCheckBoxWithLabel(this.valueRadio,this.valueLabel);u.combineRadioCheckBoxWithLabel(this.fieldRadio,this.fieldLabel);
this.own(h(this.valueRadio,"click",c.hitch(this,function(){this._resetByFieldAndOperation()})));this.own(h(this.fieldRadio,"click",c.hitch(this,function(){this._resetByFieldAndOperation()})));this.uniqueRadio&&(this.uniqueRadio.name=a,u.combineRadioCheckBoxWithLabel(this.uniqueRadio,this.uniqueLabel),this.own(h(this.uniqueRadio,"click",c.hitch(this,function(){this._resetByFieldAndOperation()}))));this._resetByFieldAndOperation()},_enableRadios:function(){this.valueRadio.disabled=!1;this.fieldRadio.disabled=
!1;this.uniqueRadio&&(this.uniqueRadio.disabled=!1)},_disableRadios:function(){this.valueRadio.disabled=!0;this.fieldRadio.disabled=!0;this.uniqueRadio&&(this.uniqueRadio.disabled=!0)},_resetByFieldAndOperation:function(a){var b=a&&a.valueObj;d.setStyle(this.attributeValueContainer,"display","block");this._enableRadios();this._hideCaseSensitive();b&&("value"===b.type?this.valueRadio.checked=!0:"field"===b.type?this.fieldRadio.checked=!0:"unique"===b.type&&this.uniqueRadio&&(this.uniqueRadio.checked=
!0));var c=this._getSelectedFilteringItem(this.fieldsSelect),f=c&&c.shortType,e=this.operatorsSelect.get("value");if(c)if("string"===f)switch(e){case this.OPERATORS.stringOperatorStartsWith:case this.OPERATORS.stringOperatorEndsWith:case this.OPERATORS.stringOperatorContains:case this.OPERATORS.stringOperatorDoesNotContain:this.valueRadio.checked=!0,this._disableRadios(),this._showCaseSensitive(),a&&this.cbxCaseSensitive.setValue(a.caseSensitive)}else if("number"===f)switch(e){case this.OPERATORS.numberOperatorIsBetween:case this.OPERATORS.numberOperatorIsNotBetween:this.valueRadio.checked=
!0,this._disableRadios()}else if("date"===f){switch(e){case this.OPERATORS.dateOperatorIsBetween:case this.OPERATORS.dateOperatorIsNotBetween:this.valueRadio.checked=!0,this._disableRadios()}this.uniqueRadio&&(this.uniqueRadio.disabled=!0,this.uniqueRadio.checked&&(this.valueRadio.checked=!0))}this._updateUIOfAttrValueContainer(c,e,b)},_updateUIOfAttrValueContainer:function(a,b,k){this._updatePrompt();var f=a&&a.shortType;if("string"===f||"number"===f||"date"===f)if(d.setStyle(this.attributeValueContainer,
"display","block"),this.valueRadio.checked)if(d.setStyle(this.fieldsSelect2.domNode,"display","none"),d.setStyle(this.uniqueValuesSelect.domNode,"display","none"),this._showAllValueBoxContainer(),this._resetValueTextBox(),"string"===f)d.setStyle(this.stringTextBoxContainer,"display","block"),d.setStyle(this.numberTextBoxContainer,"display","none"),d.setStyle(this.dateTextBoxContainer,"display","none"),this._isFieldCoded(a)&&b===this.OPERATORS.stringOperatorIs?(d.setStyle(this.stringCodedValuesFS.domNode,
"display","inline-block"),d.setStyle(this.stringTextBox.domNode,"display","none"),a=e.map(a.domain.codedValues,c.hitch(this,function(a,b){var f=c.mixin({},a);f.id=b;return f})),f=new n({data:a}),this.stringCodedValuesFS.set("store",f),k?(f=e.filter(a,c.hitch(this,function(a){return a.code===k.value})),0<f.length?this.stringCodedValuesFS.set("value",f[0].id):this.stringCodedValuesFS.set("value",a[0].id)):this.stringCodedValuesFS.set("value",a[0].id)):(d.setStyle(this.stringTextBox.domNode,"display",
"inline-block"),d.setStyle(this.stringCodedValuesFS.domNode,"display","none"),k&&this._setValueForStringTextBox(this.stringTextBox,k.value)),(b===this.OPERATORS.stringOperatorIsBlank||b===this.OPERATORS.stringOperatorIsNotBlank)&&d.setStyle(this.attributeValueContainer,"display","none");else if("number"===f){d.setStyle(this.stringTextBoxContainer,"display","none");d.setStyle(this.numberTextBoxContainer,"display","block");d.setStyle(this.dateTextBoxContainer,"display","none");if(b===this.OPERATORS.numberOperatorIsBetween||
b===this.OPERATORS.numberOperatorIsNotBetween){if(d.setStyle(this.numberTextBox.domNode,"display","none"),d.setStyle(this.numberRangeTable,"display","table"),d.setStyle(this.numberCodedValuesFS.domNode,"display","none"),k){var h;a=u.isValidNumber(k.value1);f=u.isValidNumber(k.value2);a&&f?(f=parseFloat(k.value1),h=parseFloat(k.value2),a=Math.min(f,h),f=Math.max(f,h),this.numberTextBox1.set("value",a),this.numberTextBox2.set("value",f)):a&&!f?(f=parseFloat(k.value1),this.numberTextBox1.set("value",
f)):!a&&f&&(h=parseFloat(k.value2),this.numberTextBox2.set("value",h))}}else if(d.setStyle(this.numberRangeTable,"display","none"),this._isFieldCoded(a)&&b===this.OPERATORS.numberOperatorIs)if(d.setStyle(this.numberTextBox.domNode,"display","none"),d.setStyle(this.numberCodedValuesFS.domNode,"display","inline-block"),a=e.map(a.domain.codedValues,c.hitch(this,function(a,b){var f=c.mixin({},a);f.id=b;return f})),f=new n({data:a}),this.numberCodedValuesFS.set("store",f),k&&!isNaN(k.value)){var m=parseFloat(k.value),
f=e.filter(a,c.hitch(this,function(a){return parseFloat(a.code)===m}));0<f.length?this.numberCodedValuesFS.set("value",f[0].id):this.numberCodedValuesFS.set("value",a[0].id)}else this.numberCodedValuesFS.set("value",a[0].id);else d.setStyle(this.numberTextBox.domNode,"display","inline-block"),d.setStyle(this.numberCodedValuesFS.domNode,"display","none"),k&&this._setValueForNumberTextBox(this.numberTextBox,k.value);(b===this.OPERATORS.numberOperatorIsBlank||b===this.OPERATORS.numberOperatorIsNotBlank)&&
d.setStyle(this.attributeValueContainer,"display","none")}else"date"===f&&(d.setStyle(this.stringTextBoxContainer,"display","none"),d.setStyle(this.numberTextBoxContainer,"display","none"),d.setStyle(this.dateTextBoxContainer,"display","block"),b===this.OPERATORS.dateOperatorIsBetween||b===this.OPERATORS.dateOperatorIsNotBetween?(d.setStyle(this.dateTextBox.domNode,"display","none"),d.setStyle(this.dateRangeTable,"display","table"),k&&(k.value1&&k.value2)&&(this.dateTextBox1.set("value",new Date(k.value1)),
this.dateTextBox2.set("value",new Date(k.value2)))):(d.setStyle(this.dateTextBox.domNode,"display","inline-block"),d.setStyle(this.dateRangeTable,"display","none"),k&&k.value&&this.dateTextBox.set("value",new Date(k.value))),(b===this.OPERATORS.dateOperatorIsBlank||b===this.OPERATORS.dateOperatorIsNotBlank)&&d.setStyle(this.attributeValueContainer,"display","none"));else this.fieldRadio.checked?(this._hideAllValueBoxContainer(),d.setStyle(this.uniqueValuesSelect.domNode,"display","none"),d.setStyle(this.fieldsSelect2.domNode,
"display","inline-block"),this._resetFieldsSelect2(),k&&k.value&&(b=this.fieldsSelect2.store.query({name:k.value}),0<b.length&&(b=b[0])&&this.fieldsSelect2.set("value",b.id))):this.uniqueRadio&&this.uniqueRadio.checked&&(this._hideAllValueBoxContainer(),d.setStyle(this.fieldsSelect2.domNode,"display","none"),d.setStyle(this.uniqueValuesSelect.domNode,"display","inline-block"),this._resetUniqueValuesSelect(k));else d.setStyle(this.attributeValueContainer,"display","none")},_showAllValueBoxContainer:function(){d.setStyle(this.allValueBoxContainer,
"display","block")},_hideAllValueBoxContainer:function(){d.setStyle(this.allValueBoxContainer,"display","none")},_resetValueTextBox:function(){this.stringTextBox.set("value","");this.numberTextBox.set("value","");this.dateTextBox.set("value",new Date)},_resetFieldsSelect2:function(){this.fieldsSelect2.set("displayedValue","");var a=new n({data:[]});this.fieldsSelect2.set("store",a);if(this.fieldsSelect.validate()){var b=this._getSelectedFilteringItem(this.fieldsSelect);if(b){var a=this.fieldsSelect.store.query({shortType:b.shortType}),
d=e.filter(a,c.hitch(this,function(a){return a.id!==b.id})),a=new n({data:d});this.fieldsSelect2.set("store",a);0<d.length&&this.fieldsSelect2.set("value",d[0].id)}}},_tryLocaleNumber:function(a){var b=u.localizeNumber(a);if(null===b||void 0===b)b=a;return b},_resetUniqueValuesSelect:function(a){this.uniqueValuesSelect.reset();this.uniqueValuesSelect.store.setData([]);if(this.layerInfo&&10.1<=parseFloat(this.layerInfo.currentVersion)){var d=this._getSelectedFilteringItem(this.fieldsSelect);if(d){var k=
this.url+"/generateRenderer",f=b.stringify({type:"uniqueValueDef",uniqueValueFields:[d.name]});r({url:k,content:{classificationDef:f,f:"json"},handleAs:"json",callbackParamName:"callback",timeout:15E3}).then(c.hitch(this,function(b){b=b&&b.uniqueValueInfos;var f=this._getSelectedFilteringItem(this.fieldsSelect);if(b&&f&&d.id===f.id){this.uniqueValuesSelect.store.setData([]);var k=-1,h=this._hasCodedValues(f);b=e.map(b,c.hitch(this,function(b,c){var d=b.value,e=d;"number"===f.shortType&&(d=parseFloat(d),
e=this._tryLocaleNumber(d));h&&(e=this._getDisplayNameOfCodedValues(d,f));e={id:c,value:d,label:e};a&&a.value===d&&(k=e.id);return e}));this.uniqueValuesSelect.store.setData(b);0<b.length&&0<=k&&(b=this.uniqueValuesSelect.store.get(k))&&this.uniqueValuesSelect.set("item",b)}}),c.hitch(this,function(a){console.error(a)}))}}},_hasCodedValues:function(a){var b=!1;a.domain&&(a=a.domain.codedValues)&&0<a.length&&(b=!0);return b},_getDisplayNameOfCodedValues:function(a,b){var c=a;e.some(b.domain.codedValues,
function(b){return b.code===a?(c=b.name,!0):!1});return c},_onCbxAskValuesClicked:function(){this._updateRequiredProperty();this._updatePrompt()},_onCbxAskValuesStatusChanged:function(){this._updateRequiredProperty()},_isUseAskForValues:function(){return this.cbxAskValues.status&&this.cbxAskValues.checked},_isValueRequired:function(){return!this._isUseAskForValues()},_updateRequiredProperty:function(){var a=this._isValueRequired();this.stringTextBox.set("required",a);this.stringCodedValuesFS.set("required",
a);this.numberTextBox.set("required",a);this.numberTextBox1.set("required",a);this.numberTextBox2.set("required",a);this.numberCodedValuesFS.set("required",a);this.uniqueValuesSelect.set("required",a)},_updatePrompt:function(){this.promptTB.set("value","");this.hintTB.set("value","");this.cbxAskValues.setStatus(!0);d.setStyle(this.promptTable,"display","table");var a=this.operatorsSelect.get("value"),b=this.nls[a];this.fieldRadio.checked&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.stringOperatorIsBlank&&
this.cbxAskValues.setStatus(!1);a===this.OPERATORS.stringOperatorIsNotBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.numberOperatorIsBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.numberOperatorIsNotBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.dateOperatorIsBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.dateOperatorIsNotBlank&&this.cbxAskValues.setStatus(!1);if(this.cbxAskValues.status&&this.cbxAskValues.checked){d.setStyle(this.promptTable,"display",
"table");var c=this._getSelectedFilteringItem(this.fieldsSelect);c&&"none"!==a&&this.promptTB.set("value",(c.alias||c.name)+" "+b)}else d.setStyle(this.promptTable,"display","none")},_destroySelf:function(){this.destroy()}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(l,q,t,s,g){return l("dijit.form.FilteringSelect",[s,g],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},
isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(c,d,e,b){d&&d[this.searchAttr]!==this._lastQuery||!d&&c.length&&this.store.getIdentity(c[0])!=this._lastQuery||(c.length?this.set("item",c[0],b):this.set("value","",b||void 0===b&&!this.focused,this.textbox.value,null))},_openResultList:function(c,d,e){d[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),
void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(c,d,e,b){this._onChangeActive||(d=null);if(void 0===b){if(null===c||""===c)if(c="",!q.isString(e)){this._setDisplayedValueAttr(e||"",d);return}var h=this;this._lastQuery=c;t(this.store.get(c),function(b){h._callbackSetLabel(b?[b]:[],void 0,void 0,d)})}else this.valueNode.value=c,this.inherited(arguments,[c,d,e,b])},_setItemAttr:function(c,d,
e){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(c){return c.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(c,d){null==c&&(c="");if(!this._created){if(!("displayedValue"in this.params))return;d=!1}if(this.store){this.closeDropDown();var e=q.clone(this.query),b=this._getDisplayQueryString(c),h;this.store._oldAPI?h=b:(h=this._patternToRegExp(b),h.toString=function(){return b});this._lastQuery=e[this.searchAttr]=h;this._lastDisplayedValue=
this.textbox.value=c;this._set("displayedValue",c);var g=this,l={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};q.mixin(l,this.fetchProperties);this._fetchHandle=this.store.query(e,l);t(this._fetchHandle,function(b){g._fetchHandle=null;g._callbackSetLabel(b||[],e,l,d)},function(b){g._fetchHandle=null;g._cancelingQuery||console.error("dijit.form.FilteringSelect: "+b.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare",
"../Calendar","./_DateTimeTextBox"],function(l,q,t){return l("dijit.form.DateTextBox",t,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:q,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
function(l,q,t,s,g,c,d,e,b,h,n,r,u,a,v,k,f){var p=s("dijit.Calendar",[u,a,v],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){e.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new p._MonthDropDownButton({id:this.id+"_mddb",
tabIndex:-1,onMonthSelect:h.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(n(this.domNode,"keydown",h.hitch(this,"_onKeyDown")),n(this.dateRowsNode,"mouseover",h.hitch(this,"_onDayMouseOver")),n(this.dateRowsNode,"mouseout",h.hitch(this,"_onDayMouseOut")),n(this.dateRowsNode,"mousedown",h.hitch(this,"_onDayMouseDown")),n(this.dateRowsNode,"mouseup",h.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=
new this.dateClassObj(this.currentFocus);b.setDate(1);b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var c=this.currentFocus.getDate();b.setDate(Math.min(c,a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){if((a=c.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!c.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode))c.add(a,"dijitCalendarHoveredDate"),this._currentNode=a},_onDayMouseOut:function(a){this._currentNode&&
!(a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode)&&(a="dijitCalendarHoveredDate",c.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),c.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){if((a=a.target.parentNode)&&a.dijitDateValue&&!c.contains(a,"dijitCalendarDisabledDate"))c.add(a,"dijitCalendarActiveDate"),this._currentNode=a},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&c.remove(a,"dijitCalendarActiveDate")},
handleKey:function(a){var c=-1,f,d=this.currentFocus;switch(a.keyCode){case b.RIGHT_ARROW:c=1;case b.LEFT_ARROW:f="day";this.isLeftToRight()||(c*=-1);break;case b.DOWN_ARROW:c=1;case b.UP_ARROW:f="week";break;case b.PAGE_DOWN:c=1;case b.PAGE_UP:f=a.ctrlKey||a.altKey?"year":"month";break;case b.END:d=this.dateModule.add(d,"month",1),f="day";case b.HOME:d=new this.dateClassObj(d);d.setDate(1);break;default:return!0}f&&(d=this.dateModule.add(d,f,c));this._setCurrentFocusAttr(d);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});p._MonthDropDownButton=s("dijit.Calendar._MonthDropDownButton",f,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new p._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.dropDown.set("months",
b);this.containerNode.innerHTML=(6==r("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});p._MonthDropDown=s("dijit.Calendar._MonthDropDown",[a,k,v],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";l.forEach(a,function(a,b){d.create("div",{className:"dijitCalendarMonthLabel",month:b,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(g.get(a.target,"month"))},onChange:function(){}});return p})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(l,q,t,s,g,c,d,e,b,h,n,r,u,a,v){var k=q("dijit.CalendarLite",[u,a],{templateString:v,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=new this.dateClassObj(a);
b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=c.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){a&&(a=new this.dateClassObj(a),
a.setHours(1,0,0,0));return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),b=a.getDay(),c=this.dateModule.getDaysInMonth(a),d=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),e=new this.dateClassObj,h=t.getFirstDayOfWeek(this.lang);h>b&&(h-=7);if(!this.summary){var k=this.dateLocaleModule.getNames("months",
"wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",k[a.getMonth()])}this._date2cell={};l.forEach(this.dateCells,function(k,g){var n=g+h,l=new this.dateClassObj(a),r="dijitCalendar",q=0;n<b?(n=d-b+n+1,q=-1,r+="Previous"):n>=b+c?(n=n-b-c+1,q=1,r+="Next"):(n=n-b+1,r+="Current");q&&(l=this.dateModule.add(l,"month",q));l.setDate(n);this.dateModule.compare(l,e,"date")||(r="dijitCalendarCurrentDate "+r);this.isDisabledDate(l,this.lang)?(r="dijitCalendarDisabledDate "+r,k.setAttribute("aria-disabled",
"true")):(r="dijitCalendarEnabledDate "+r,k.removeAttribute("aria-disabled"),k.setAttribute("aria-selected","false"));(q=this.getClassForDate(l,this.lang))&&(r=q+" "+r);k.className=r+"Month dijitCalendarDateTemplate";r=l.valueOf();this._date2cell[r]=k;k.dijitDateValue=r;this._setText(this.dateLabels[g],l.getDateLocalized?l.getDateLocalized(this.lang):l.getDate())},this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);this.monthWidget.set("month",a);var b=
a.getFullYear()-1,c=new this.dateClassObj;l.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?b.getObject(a.datePackage,!1):s;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?b.getObject(a.datePackage+".locale",!1):g},_createMonthWidget:function(){return k._MonthWidget({id:this.id+
"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var a=this.dowTemplateString,b=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),c=t.getFirstDayOfWeek(this.lang);this.dayCellsHtml=r.substitute([a,a,a,a,a,a,a].join(""),{d:""},function(){return b[c++%7]});a=r.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[a,a,a,a,a,a].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);
d.setSelectable(this.domNode,!1);a=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",a,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=b.hitch(this,function(a,c,d){this[a].dojoClick=!0;return h(this[a],"click",b.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,c,d))}))});this.own(a("incrementMonth","month",1),a("decrementMonth","month",-1),
a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,b){var c=this.currentFocus,d=this._getNodeByDate(c);a=this._patchDate(a);this._set("currentFocus",a);if(!this._date2cell||0!=this.dateModule.difference(c,a,"month"))this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]);c=this._getNodeByDate(a);c.setAttribute("tabIndex",this.tabIndex);(this.focused||b)&&c.focus();d&&d!=c&&(n("webkit")?d.setAttribute("tabIndex","-1"):
d.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue;a=a.parentNode);a&&!e.contains(a,"dijitCalendarDisabledDate")&&this.set("value",a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function c(a,b){e.toggle(b,"dijitCalendarSelectedDate",a);b.setAttribute("aria-selected",
a?"true":"false")}l.forEach(this._selectedCells||[],b.partial(c,!1));this._selectedCells=l.filter(l.map(a,this._getNodeByDate,this),function(a){return a});l.forEach(this._selectedCells,b.partial(c,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});k._MonthWidget=q("dijit.CalendarLite._MonthWidget",u,{_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a),c=6==n("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+l.map(b,
function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=c+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});return k})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(l,q,t,s,g,c,d,e){new Date("X");return s("dijit.form._DateTimeTextBox",
[c,d],{templateString:e,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:q.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(b,c){var d=this._isInvalidDate(b),e=this._isInvalidDate(c);if(d||e)return d&&e?0:!d?1:-1;var d=this.format(b,this._unboundedConstraints),e=this.format(c,this._unboundedConstraints),g=this.parse(d,this._unboundedConstraints),a=this.parse(e,this._unboundedConstraints);
return d==e?0:l.compare(g,a,this._selector)},autoWidth:!0,format:function(b,c){return!b?"":this.dateLocaleModule.format(b,c)},parse:function(b,c){return this.dateLocaleModule.parse(b,c)||(this._isEmpty(b)?null:void 0)},serialize:function(b,c){b.toGregorian&&(b=b.toGregorian());return t.toISOString(b,c)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(b){b=b||{};this.dateModule=b.datePackage?g.getObject(b.datePackage,!1):l;this.dateClassObj=
this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=b.datePackage?g.getObject(b.datePackage+".locale",!1):q;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},
_setConstraintsAttr:function(b){b.selector=this._selector;b.fullYear=!0;var c=t.fromISOString;"string"==typeof b.min&&(b.min=c(b.min),this.dateClassObj instanceof Date||(b.min=new this.dateClassObj(b.min)));"string"==typeof b.max&&(b.max=c(b.max),this.dateClassObj instanceof Date||(b.max=new this.dateClassObj(b.max)));this.inherited(arguments);this._unboundedConstraints=g.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(b){return!b||isNaN(b)||"object"!=typeof b||b.toString()==
this._invalidDate},_setValueAttr:function(b,c,d){void 0!==b&&("string"==typeof b&&(b=t.fromISOString(b)),this._isInvalidDate(b)&&(b=null),b instanceof Date&&!(this.dateClassObj instanceof Date)&&(b=new this.dateClassObj(b)));this.inherited(arguments,[b,c,d]);this.value instanceof Date&&(this.filterString="");this.dropDown&&this.dropDown.set("value",b,!1)},_set:function(b,c){if("value"==b){c instanceof Date&&!(this.dateClassObj instanceof Date)&&(c=new this.dateClassObj(c));var d=this._get("value");
if(d instanceof this.dateClassObj&&0==this.compare(c,d))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(b){this._isInvalidDate(b)&&(b=new this.dateClassObj);this._set("dropDownDefaultValue",b)},openDropDown:function(b){this.dropDown&&this.dropDown.destroy();var c=g.isString(this.popupClass)?g.getObject(this.popupClass,!1):this.popupClass,d=this,e=this.get("value");this.dropDown=new c({onChange:function(b){d.set("value",b,!0)},id:this.id+"_popup",dir:d.dir,lang:d.lang,value:e,
textDir:d.textDir,currentFocus:!this._isInvalidDate(e)?e:this.dropDownDefaultValue,constraints:d.constraints,filterString:d.filterString,datePackage:d.datePackage,isDisabledDate:function(b){return!d.rangeCheck(b,d.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(b,c){this._setValueAttr(this.parse(b,this.constraints),c,b)}})})},"jimu/dijit/_FilterSet":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_FilterSet.html dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/aspect dojo/query ./_SingleFilter".split(" "),
function(l,q,t,s,g,c,d,e,b,h,n,r,u){return l([q,t,s],{templateString:g,baseClass:"jimu-filter-set",nls:null,url:null,layerInfo:null,stringFieldType:"",dateFieldType:"",numberFieldTypes:[],partsObj:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;var a=this.nls.matchMsgSet.split("${any_or_all}");this.nls.strMatchMsgPart1=a[0]||"";this.nls.strMatchMsgPart2=a[1]||"";this.inherited(arguments)},postCreate:function(){this.inherited(arguments);
this._initSelf()},toJson:function(){var a=r(".jimu-single-filter",this.allExpsBox),a=b.map(a,d.hitch(this,function(a){return c.byNode(a).toJson()}));return b.every(a,d.hitch(this,function(a){return!!a}))&&0<a.length?{logicalOperator:this.allAnySelect.value,parts:a}:null},showDelteIcon:function(){e.setStyle(this.btnDelete,"display","block")},hideDeleteIcon:function(){e.setStyle(this.btnDelete,"display","none")},_initSelf:function(){this.own(h(this.btnAdd,"click",d.hitch(this,this._addSingleFilter)));
if(this.partsObj){this.allAnySelect.value=this.partsObj.logicalOperator;var a=this.partsObj.parts||[];0===a.length?(this._addSingleFilter(),this._addSingleFilter()):1===a.length?(this._addSingleFilter(a[0]),this._addSingleFilter()):b.forEach(a,d.hitch(this,function(a){this._addSingleFilter(a)}))}else this._addSingleFilter(),this._addSingleFilter()},_addSingleFilter:function(a){a=new u({url:this.url,layerInfo:this.layerInfo,stringFieldType:this.stringFieldType,dateFieldType:this.dateFieldType,numberFieldTypes:this.numberFieldTypes,
part:a,OPERATORS:this.OPERATORS,enableAskForValues:this.enableAskForValues,isHosted:this.isHosted,style:{margin:"15px auto 0 auto",border:0,background:"inherit"}});a.placeAt(this.allExpsBox);a.startup();this.own(n.after(a,"_destroySelf",d.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_checkFilterNumbers:function(){var a=r(".jimu-single-filter",this.allExpsBox),e=2<a.length;b.forEach(a,d.hitch(this,function(a){a=c.byNode(a);e?a.showDelteIcon():a.hideDeleteIcon()}))},_destroySelf:function(){this.destroy()}})})},
"jimu/dijit/SymbolPicker":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dijit/TooltipDialog dijit/popup dijit/registry jimu/dijit/SymbolChooser jimu/symbolUtils".split(" "),function(l,q,t,s,g,c,d,e,b,h,n,r,u,a){return l([q,t,s],{baseClass:"jimu-symbol-picker",declaredClass:"jimu.dijit.SymbolPicker",templateString:"\x3cdiv\x3e\x3c/div\x3e",tooltipDialog:null,_isTooltipDialogOpened:!1,symbol:null,
type:null,postCreate:function(){this.inherited(arguments);this._createTooltipDialog();this._hideTooltipDialog();var a=this.symbolChooser.getSymbol();a&&this._drawSymbol(a)},destroy:function(){this._hideTooltipDialog();this.symbolChooser&&this.symbolChooser.destroy();this.symbolChooser=null;this.inherited(arguments)},_createTooltipDialog:function(){var a=c.create("div");this.tooltipDialog=new h({content:a});this.symbolChooser=new u({symbol:this.symbol,type:this.type});this.symbolChooser.placeAt(a);
this.symbolChooser.startup();this.own(e(this.symbolChooser,"change",g.hitch(this,function(a){this._drawSymbol(a);this.emit("change",a)})));this.own(e(this.domNode,"click",g.hitch(this,function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(e(document.body,"click",g.hitch(this,function(a){var b=a.target||a.srcElement;a=this._getColorPickers();0<a.length&&d.some(a,function(a){return a.isPartOfPopup(b)})||(a=this.tooltipDialog.domNode,
b===a||c.isDescendant(b,a)||this._hideTooltipDialog())})));this.own(e(this.symbolChooser,"resize",g.hitch(this,function(){this._isTooltipDialogOpened&&(this._hideTooltipDialog(),this._showTooltipDialog())})))},_getColorPickers:function(){var a=b(".jimu-color-picker",this.symbolChooser.domNode);return d.map(a,g.hitch(this,function(a){return r.byNode(a)}))},reset:function(){this.symbol=this.type=null;c.empty(this.domNode);this.symbolChooser.reset()},showBySymbol:function(a){this.reset();a&&(this._drawSymbol(a),
this.symbolChooser.showBySymbol(a))},showByType:function(a){this.reset();this.symbolChooser.showByType(a);(a=this.symbolChooser.getSymbol())&&this._drawSymbol(a)},getSymbol:function(){return this.symbolChooser.getSymbol()},_drawSymbol:function(b){c.empty(this.domNode);b&&(b=a.createSymbolNode(b))&&c.place(b,this.domNode)},_showTooltipDialog:function(){this.tooltipDialog&&(n.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode}),this._isTooltipDialogOpened=!0)},_hideTooltipDialog:function(){this.tooltipDialog&&
(n.close(this.tooltipDialog),this._isTooltipDialogOpened=!1)}})})},"widgets/Query/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/QueryableLayerSource.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"map-td" nowrap\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"mapRadio" type\x3d"radio" data-dojo-attach-event\x3d"onclick: _onRadioClicked" checked /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"mapLabel"\x3e${nls.selectFromMap}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"portal-td" nowrap\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalRadio" type\x3d"radio" data-dojo-attach-event\x3d"onclick: _onRadioClicked" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalLabel"\x3e${nls.selectFromPortal}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"url-td" nowrap\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"urlRadio" type\x3d"radio" data-dojo-attach-event\x3d"onclick: _onRadioClicked" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"urlLabel"\x3e${nls.addServiceUrl}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"source-content"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"operationTip" class\x3d"operation-tip"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"mapDijitContainer" class\x3d"dijit-container map-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"portalDijitContainer" class\x3d"dijit-container portal-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"urlDijitContainer" class\x3d"dijit-container url-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/QueryableServiceChooserFromPortal.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"selector-container" data-dojo-attach-point\x3d"selectorContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"footer"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel" data-dojo-attach-point\x3d"btnCancel" data-dojo-attach-event\x3d"onclick:_onBtnCancelClicked"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing next jimu-state-disabled" data-dojo-attach-point\x3d"btnNext" data-dojo-attach-event\x3d"onclick:_onBtnNextClicked"\x3e${nls.next}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-state-disabled" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClicked"\x3e${nls.ok}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing back" data-dojo-attach-point\x3d"btnBack" data-dojo-attach-event\x3d"onclick:_onBtnBackClicked"\x3e${nls.back}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/ItemSelector.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"setting-tab-container"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:50px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:85px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" type\x3d"radio" name\x3d"publicSearchRadio" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalPublicLabel" class\x3d"jimu-float-leading portal-public-label"\x3ePortal\x3c/label\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" type\x3d"radio" name\x3d"publicSearchRadio" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlinePublicLabel" class\x3d"jimu-float-leading online-public-label"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicItemSection" class\x3d"public-item-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip jimu-state-error-text"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_BasicServiceChooserContent.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"content-section"\x3e\r\n\t\t\x3ctable class\x3d"layout"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"80px" align\x3d"right"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"170px"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3eURL:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlInput" data-dojo-type\x3d"jimu/dijit/URLInput" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"jimu-btn jimu-state-disabled validate-btn jimu-float-trailing" data-dojo-attach-point\x3d"btnValidate" data-dojo-attach-event\x3d"onclick:_onBtnValidateClick"\x3e${nls.validate}\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"exampleTr" class\x3d"example-tr"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td" style\x3d"padding-top:5px;"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.example}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"exampleTd" colspan\x3d"2" style\x3d"padding-top:5px;font-style:italic;color:#ccc;"\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\r\n\t\t\t\x3cdiv class\x3d"error-section" data-dojo-attach-point\x3d"errorSection"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"error-message" data-dojo-attach-point\x3d"errorNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operations"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel" data-dojo-attach-event\x3d"onclick:_onBtnCancelClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing jimu-state-disabled ok" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClick"\x3e${nls.ok}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Query/setting/SingleQuerySetting.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"generalTable" class\x3d"general" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"first-td"\x3e${nls.querySource}\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"width:100%;border-collapse:collapse;"\x3e\r\n\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:auto;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d\'required:true,trim:true,disabled:true\' style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:120px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-event\x3d"onclick:_onBtnSetSourceClicked" class\x3d"jimu-btn jimu-float-trailing"\x3e${nls.setSource}\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"first-td"\x3e${nls.queryName}\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"queryNameTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d\'required:true,trim:true\' style\x3d"width:100%;" data-dojo-attach-event\x3d"change:_onQueryNameChanged,blur:_onQueryNameBlurred"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"detailSection" class\x3d"detail"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"definitionTabNode"\x3e\r\n\t\t\t\x3cdiv style\x3d"position:relative;width:100%;height:100%;" data-dojo-attach-point\x3d"filterDiv"\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"resultsTabNode"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"popupContainer" style\x3d"width:90%;"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"symbolSection" class\x3d"symbol-section" style\x3d"margin-top:18px;"\x3e\r\n\t\t\t\t\x3cdiv style\x3d"margin-bottom:11px;"\x3e${nls.setLayerSymbolTip}\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"layerSymbolPicker" data-dojo-type\x3d"jimu/dijit/SymbolPicker"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Query/setting/PopupConfig.html":'\x3cdiv\x3e\r\n\t\x3cdiv style\x3d"margin-top:22px;font-size:12px;"\x3e${nls.resultSettingTip}\x3c/div\x3e\r\n\t\x3ctable class\x3d"title-sorting-table"\x3e\r\n\t\t\x3ccolgroup\x3e\r\n\t\t\t\x3ccol width\x3d"140px"\x3e\x3c/col\x3e\r\n\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3ccol width\x3d"24px"\x3e\x3c/col\x3e\r\n\t\t\x3c/colgroup\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.resultItemTitle}:\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"titleTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n\t\t\t\t\tdata-dojo-props\x3d\'required:true,trim:true\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAddFields" data-dojo-attach-event\x3d"onclick:_onAddClicked"\r\n\t\t\t\t\t  class\x3d"btn-add-fields jimu-icon jimu-icon-add jimu-float-trailing"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.resultItemSorting}:\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd data-dojo-attach-point\x3d"tdSortFields"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"sortFieldsDiv" class\x3d"sort-fields-div jimu-ellipsis"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnSortFields" class\x3d"btn-sort-fields jimu-float-trailing"\r\n\t\t\t\t\tdata-dojo-attach-event\x3d"onclick:_onBtnSortFieldsClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv style\x3d"margin-top:10px;"\x3e${nls.resultItemContent}:\x3c/div\x3e\r\n\t\x3cdiv style\x3d"margin-top:7px;margin-bottom:8px;font-size:12px;"\x3e${nls.fieldsSetTip}\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"fieldsContainer"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Query/setting/SortFields.html":'\x3cdiv\x3e\r\n\t\x3cdiv\x3e${nls.configureFieldsTip}\x3c/div\x3e\r\n\t\x3cdiv class\x3d"add-with-icon" data-dojo-attach-event\x3d"onclick:_onAddNewClicked"\x3e\r\n\t\t\x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n\t\t\x3cspan class\x3d"add-label"\x3e${nls.addNew}\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"tableDiv"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:jimu/dijit/templates/Filter.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"contentSection" class\x3d"content-section"\x3e\r\n\t\t\x3cdiv class\x3d"add-btn-section"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAddExp" data-dojo-attach-event\x3d"click:_onBtnAddExpClick"\r\n\t\t\t class\x3d"add-with-icon jimu-state-disabled add-expression jimu-float-leading"\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"iconAddExp" class\x3d"jimu-icon jimu-icon-add jimu-state-disabled"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addAnotherExpression}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAddSet" data-dojo-attach-event\x3d"click:_onBtnAddSetClick"\r\n\t\t\t class\x3d"add-with-icon jimu-state-disabled add-set jimu-float-leading"\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"iconAddSet" class\x3d"jimu-icon jimu-icon-add jimu-state-disabled"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addSet}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"matchMsg" style\x3d"margin-top:11px;margin-bottom:11px;display:none;"\x3e\r\n\t\t\t\x3cspan\x3e${nls.strMatchMsgPart1}\x3c/span\x3e\r\n\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.all}\x3c/option\x3e\r\n\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.any}\x3c/option\x3e\r\n\t\t\t\x3c/select\x3e\r\n\t\t\t\x3cspan\x3e${nls.strMatchMsgPart2}\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\t\x3cdiv class\x3d"allExpsBox" data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"errorSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"errorTip" class\x3d"error-tip"\x3e\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"noFilterTipSection" class\x3d"no-filter-tip" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_SingleFilter.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"setting-table" cellpadding\x3d"0" cellspacing\x3d"0" cellpadding\x3d"10px" style\x3d"table-layout:fixed;"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"fields-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fieldsSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-attach-event\x3d"change:_onFieldsSelectChange"  data-dojo-props\x3d\'searchAttr:"displayName",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"operators-td" nowrap\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"operatorsSelect" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-event\x3d"change:_onOperatorsSelectChange" style\x3d"width:100%;" class\x3d"dijit-form-Select"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"none"\x3e${nls.none}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"value-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"attributeValueContainer" class\x3d"value-container"\x3e\r\n\t\t\t\t\t\t\x3cdiv\x3e\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"allValueBoxContainer" style\x3d"width:100%;"\x3e\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"stringTextBoxContainer" style\x3d"width:100%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"stringTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"width:100%;" class\x3d"dijit-form-ValidationTextBox" /\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"stringCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"numberTextBoxContainer" style\x3d"display:none;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;table-layout:fixed;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"numberCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"dateTextBoxContainer" style\x3d"display:none;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;table-layout:fixed;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox1" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox2" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fieldsSelect2" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name"\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"uniqueValuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect"  data-dojo-props\x3d\'searchAttr:"label"\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\x3cdiv class\x3d"radio-table-container"\x3e\r\n\t\t\t\t\t\t\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"table-layout:fixed;"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"valueRadio" checked\x3d"true" disabled  title\x3d"${nls.valueTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"valueLabel" title\x3d"${nls.valueTooltip}"\x3e${nls.value}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"fieldRadio" disabled title\x3d"${nls.fieldTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"fieldLabel" title\x3d"${nls.fieldTooltip}"\x3e${nls.field}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"uniqueTd"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"uniqueRadio" disabled title\x3d"${nls.uniqueValueTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"uniqueLabel" title\x3d"${nls.uniqueValueTooltip}"\x3e${nls.unique}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"delete-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-icon jimu-icon-delete" data-dojo-attach-point\x3d"btnDelete"\r\n\t\t\t\t\t data-dojo-attach-event\x3d"click:_destroySelf"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"askvalues"\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxAskValues" label\x3d"${nls.askForValues}" class\x3d"jimu-trailing-margin6"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxCaseSensitive" label\x3d"${nls.caseSensitive}" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"promptSection" class\x3d"prompt"\x3e\r\n\t\t\x3ctable data-dojo-attach-point\x3d"promptTable" cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"prompt-table"\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.prompt}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"promptTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"width:100%;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.hint}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"hintTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"trim:true" style\x3d"width:100%;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Calendar.html":'\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" class\x3d"dijitCalendarContainer" role\x3d"grid" aria-labelledby\x3d"${id}_mddb ${id}_year" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\x3cthead\x3e\r\n\t\t\x3ctr class\x3d"dijitReset dijitCalendarMonthContainer" valign\x3d"top"\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset dijitCalendarArrow\' data-dojo-attach-point\x3d"decrementMonth" scope\x3d"col"\x3e\r\n\t\t\t\t\x3cspan class\x3d"dijitInline dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset\' colspan\x3d"5" scope\x3d"col"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode"\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset dijitCalendarArrow\' scope\x3d"col" data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\t\x3cspan class\x3d"dijitInline dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t${!dayCellsHtml}\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/thead\x3e\r\n\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t${!dateRowsHtml}\r\n\t\x3c/tbody\x3e\r\n\t\x3ctfoot class\x3d"dijitReset dijitCalendarYearContainer"\x3e\r\n\t\t\x3ctr\x3e\r\n\t\t\t\x3ctd class\x3d\'dijitReset\' valign\x3d"top" colspan\x3d"7" role\x3d"presentation"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/tfoot\x3e\r\n\x3c/table\x3e\r\n',
"url:jimu/dijit/templates/_FilterSet.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"header-table" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.strMatchMsgPart1}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.all}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.any}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.strMatchMsgPart2}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:15px;padding-right:10px;"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_destroySelf"\r\n\t\t\t\t\t class\x3d"jimu-icon jimu-icon-delete"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:15px;padding-right:14px;"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAdd" class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Query/setting/Setting.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"query-list"\x3e\r\n\t\t\x3cdiv class\x3d"query-list-head" style\x3d"overflow:hidden;"\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-leading"\x3e${nls.queries}\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-trailing"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"add-with-icon" data-dojo-attach-event\x3d"onclick:_onAddNewClicked"\x3e\r\n\t\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addNew}\x3c/span\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"query-list-content"\x3e\r\n\t\t\t\x3cdiv class\x3d"query-list-table" data-dojo-type\x3d"jimu/dijit/SimpleTable" data-dojo-attach-point\x3d"queryList" data-dojo-attach-event\x3d"row-delete:_onQueryItemRemoved,row-select:_onQueryItemSelected" data-dojo-props\x3d\'autoHeight:false,selectable:true\' fields\x3d[{name:"name",title:"${nls.name}",width:"auto",type:"text",editable:false},{name:"actions",title:"",width:"70px",type:"actions",actions:["up","down","delete"]}] style\x3d"height:100%;"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"single-query-container" data-dojo-attach-point\x3d"singleQueryContainer"\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Query/setting/css/style.css":".jimu-widget-query-setting{margin:0; padding:0; font-size:15px; position: relative; width: 100%; height: 100%;}.jimu-widget-query-setting .query-list{position: absolute; top: 0; left: 0; width: 235px; height: 100%;}.jimu-widget-query-settingRtl .query-list{left: auto; right: 0;}.jimu-widget-query-setting .query-list-content{position: absolute; width: 100%; top: 50px; bottom: 5px;}.jimu-widget-query-setting .single-query-container{position: absolute; left: 265px; right: 0; height: 100%; overflow-y: auto;}.jimu-widget-query-settingRtl .single-query-container{left: 0; right: 265px;}.jimu-widget-single-query-setting{width: 100%;}.jimu-widget-single-query-setting table.general{width: 100%; border-collapse: collapse;}.jimu-widget-single-query-setting table.general\x3etbody\x3etr\x3etd{height: 40px;}.jimu-widget-single-query-setting table.general\x3etbody\x3etr\x3e.first-td{width: 100px;}.jimu-widget-single-query-setting table.general\x3etbody\x3etr\x3e.second-td{width: auto;}.jimu-widget-single-query-setting .detail{width: 100%; margin-top: 15px;}.jimu-widget-single-query-setting .detail .jimu-tab3\x3e.container-node\x3e.view{overflow: auto;}.jimu-widget-single-query-setting .tab-item-div{height: 30px; line-height: 30px;}.jimu-widget-single-query-setting .title-sorting-table{table-layout:fixed; width:100%;}.jimu-widget-single-query-setting .title-sorting-table \x3e tbody \x3e tr \x3e td{padding-top: 3px; padding-bottom: 3px;}.jimu-query-setting-popup-config .btn-add-fields{cursor: pointer;}.jimu-query-setting-popup-config .btn-sort-fields{width: 14px; height: 14px; background: center center no-repeat url(images/edit_disabled.png); cursor: default;}.jimu-query-setting-popup-config .btn-sort-fields.enabled{background: center center no-repeat url(images/edit_enabled.png); cursor: pointer;}.jimu-query-setting-popup-config .sort-fields-div{width: 100%; height: 30px; line-height: 30px; border: 1px solid #d2dae2; background-color: #e3ecf2; color: #7989a0; font-size: 14px;}.jimu-query-setting-popup-config .sort-fields-div span{float: left; display: inline-block; height: 30px; line-height: 30px;}.jimu-query-setting-popup-config .sort-arrow{width: 13px;}.jimu-query-setting-popup-config .sort-arrow.asc{background: center center no-repeat url(images/up_arrow.png);}.jimu-query-setting-popup-config .sort-arrow.desc{background: center center no-repeat url(images/down_arrow.png);}.jimu-query-setting-sort-fields .add-with-icon{margin-top: 4px;}.jimu-query-setting-sort-fields .sort-tip{display: inline-block;}",
"*now":function(l){l(['dojo/i18n!*preload*widgets/Query/setting/nls/Setting*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/dijit/_QueryableLayerSourcePopup jimu/utils jimu/filterUtils ./SingleQuerySetting jimu/dijit/SimpleTable jimu/dijit/TabContainer".split(" "),function(l,q,t,s,g,c,d,e,b,h){return l([c,g],{baseClass:"jimu-widget-query-setting",currentSQS:null,postMixInProperties:function(){this.inherited(arguments);this.config&&this._updateConfig()},_updateConfig:function(){this.config&&(this.config.queries&&
0<this.config.queries.length)&&t.forEach(this.config.queries,q.hitch(this,function(b){this._rebuildFilter(b.url,b.filter)}))},_rebuildFilter:function(c,d){try{if(d){delete d.expr;var g=new b;g.isHosted=e.isHostedService(c);g.getExprByFilterObj(d)}}catch(a){console.log(a)}},postCreate:function(){this.inherited(arguments);this.config&&this.setConfig(this.config)},setConfig:function(b){this.currentSQS&&this.currentSQS.destroy();this.currentSQS=null;this.queryList.clear();(b=(this.config=b)&&this.config.queries)&&
0<=b.length&&t.forEach(b,q.hitch(this,function(b,c){var a=this.queryList.addRow({name:b.name||""}).tr;a.singleConfig=q.clone(b);0===c&&this.queryList.selectRow(a)}))},getConfig:function(){if(this.currentSQS){var b=this.currentSQS.getConfig();if(b)this.currentSQS.tr.singleConfig=q.clone(b);else return!1}for(var b={queries:[]},c=this.queryList.getRows(),d=0;d<c.length;d++)b.queries.push(q.clone(c[d].singleConfig));this.config=q.clone(b);return b},_createSingleQuerySetting:function(b){this.currentSQS=
new h({map:this.map,nls:this.nls,config:b.singleConfig,tr:b,_layerDefinition:b._layerDefinition,appConfig:this.appConfig});this.currentSQS.placeAt(this.singleQueryContainer);this.own(s(this.currentSQS,"name-change",q.hitch(this,function(c){this.queryList.editRow(b,{name:c})})));this.own(s(this.currentSQS,"show-shelter",q.hitch(this,function(){this.shelter.show()})));this.own(s(this.currentSQS,"hide-shelter",q.hitch(this,function(){this.shelter.hide()})));this.currentSQS.setConfig(this.currentSQS.config);
return this.currentSQS},_onAddNewClicked:function(){if(this.currentSQS){var b=this.currentSQS.getConfig();if(b)this.currentSQS.tr.singleConfig=b;else return}var c=new d({titleLabel:this.nls.setDataSource,dijitArgs:{multiple:!1,createMapResponse:this.map.webMapResponse,portalUrl:this.appConfig.portalUrl,style:{height:"100%"}}});this.own(s(c,"ok",q.hitch(this,function(b){var a=c.getSelectedRadioType();c.close();c=null;this.currentSQS&&(this.currentSQS.destroy(),this.currentSQS=null);var d=b.name||"",
e=this.queryList.addRow({name:d});e.success&&(this.queryList.selectRow(e.tr),this.currentSQS&&(e=null,"map"===a&&(a=b.layerInfo&&b.layerInfo.layerObject)&&"function"===typeof a.getDefinitionExpression&&(e=a.getDefinitionExpression()),this.currentSQS.setNewLayerDefinition(b.name,b.url,b.definition,d,e)))})));this.own(s(c,"cancel",q.hitch(this,function(){c.close();c=null})));c.startup()},_getSuitableQueryName:function(b){for(var c=b,d=this.queryList.getData(),d=t.map(d,q.hitch(this,function(a){return a.name})),
a=2;0<=t.indexOf(d,c);)b+=" "+a,a++;return b},_onQueryItemRemoved:function(b){this.currentSQS&&this.currentSQS.tr===b&&(this.currentSQS.destroy(),this.currentSQS=null)},_onQueryItemSelected:function(b){if(this.currentSQS){if(this.currentSQS.tr!==b){var c=this.currentSQS.getConfig();c?(this.currentSQS.tr.singleConfig=c,this.currentSQS.destroy(),this.currentSQS=null,this._createSingleQuerySetting(b)):this.queryList.selectRow(this.currentSQS.tr)}}else this._createSingleQuerySetting(b)}})});