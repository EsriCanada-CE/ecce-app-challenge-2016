// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Bookmark/setting/Edit":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting esri/geometry/Extent jimu/dijit/ImageChooser jimu/dijit/ExtentChooser jimu/utils dojo/text!./Edit.html".split(" "),function(n,b,l,g,d,p,q,h,r,s,a){return n([p,d],{baseClass:"jimu-Bookmark-Edit",ImageChooser:null,templateString:a,extent:{},portalUrl:null,itemId:null,isInWebmap:!1,mapOptions:null,postCreate:function(){this.inherited(arguments);
this.imageChooser=new h({cropImage:!0,defaultSelfSrc:this.folderUrl+"images/thumbnail_default.png",showSelfImg:!0,format:[h.GIF,h.JPEG,h.PNG],goldenWidth:100,goldenHeight:60});this.own(g(this.displayName,"Change",b.hitch(this,"_onNameChange")));l.addClass(this.imageChooser.domNode,"img-chooser");l.place(this.imageChooser.domNode,this.imageChooserBase,"replace")},setConfig:function(a){var c={portalUrl:this.portalUrl,itemId:this.itemId};a.displayName&&this.displayName.set("value",a.displayName);if(a.thumbnail){var f=
s.processUrlInWidgetConfig(a.thumbnail,this.folderUrl);this.imageChooser.setDefaultSelfSrc(f)}a.extent&&(c.initExtent=new q(a.extent));this.mapOptions&&this.mapOptions.lods&&(c.lods=this.mapOptions.lods);a.isInWebmap&&(this.isInWebmap=!0);this.extentChooser=new r(c,this.extentChooserNode);this.own(g(this.extentChooser,"extentChange",b.hitch(this,this._onExtentChange)))},getConfig:function(){return{displayName:this.displayName.get("value"),name:this.displayName.get("value"),extent:this.extentChooser.getExtent(),
thumbnail:this.imageChooser.imageData,isInWebmap:this.isInWebmap}},_onNameChange:function(){this._checkRequiredField()},_onExtentChange:function(a){this.currentExtent=a},_checkRequiredField:function(){this.displayName.get("value")?this.popup&&this.popup.enableButton(0):this.popup&&this.popup.disableButton(0)}})})},"jimu/dijit/ImageChooser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/text!./templates/ImageChooser.html dojo/sniff dojo/request esri/lang ../utils ./_CropImage jimu/dijit/Popup jimu/dijit/Message jimu/dijit/LoadingShelter".split(" "),
function(n,b,l,g,d,p,q,h,r,s,a,m,c,f,e){var k=0;n=n([b,l],{templateString:q,declaredClass:"jimu.dijit.ImageChooser",cropImage:!0,displayImg:null,defaultSelfSrc:null,showSelfImg:!1,label:null,showTip:!0,goldenWidth:400,goldenHeight:400,maxSize:1024,format:null,imageData:null,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.imageChooser;this.nls.common=window.jimuNls.common;this.nls.readError=this.nls.readError||"Failed to read the file."},postCreate:function(){this._initial();
!a.file.supportHTML5()&&(!h("safari")&&a.file.isEnabledFlash())&&a.file.loadFileAPI().then(g.hitch(this,function(){d.setStyle(this.mask,"zIndex",1)}))},setImageSize:function(a){this.goldenWidth=a.width;this.goldenHeight=a.height},disableChooseImage:function(){d.setStyle(this.fileForm,"display","none");this.label&&"string"===typeof this.label&&d.addClass(this.displayText,"disable-label");d.removeAttr(this.domNode,"title")},enableChooseImage:function(){d.setStyle(this.fileForm,"display","block");this.label&&
"string"===typeof this.label&&d.removeClass(this.displayText,"disable-label");this._addTip()},setDefaultSelfSrc:function(a){this.defaultSelfSrc=a;this.imageData=this.selfImg.src=a},getImageData:function(){return this.imageData},_initial:function(){this._processProperties();this._porcessMaskClick();this._setupFileInput();this._addTip()},_processProperties:function(){this.label&&"string"===typeof this.label&&(this.displayText.innerHTML=this.label,d.setStyle(this.hintText,"display","block"));this.showSelfImg&&
d.setStyle(this.hintImage,"display","block");this.defaultSelfSrc&&(this.imageData=this.selfImg.src=this.defaultSelfSrc);if(this.format){var e="image/*";"string"===typeof this.format&&/^image\/./.test(this.format)?e=this.format:"[object Array]"===Object.prototype.toString.call(this.format)&&0<this.format.length&&(e=this.format.join(","));d.setAttr(this.fileInput,"accept",e)}!a.file.supportHTML5()&&(!h("safari")&&a.file.isEnabledFlash())&&d.setStyle(this.fileInput,{width:"100%",height:"100%",position:"absolute",
left:0,top:0,opacity:0,zIndex:9})},_porcessMaskClick:function(){d.setAttr(this.fileInput,"id","imageChooser_"+k);d.setAttr(this.mask,"for","imageChooser_"+k);k++;this.maskHandle=p(this.mask,"click",g.hitch(this,function(e){e.stopPropagation();if(h("safari")&&7>h("safari"))new f({message:this.nls.unsupportReaderAPI}),e.preventDefault();else{if(!a.file.supportHTML5()){if(!a.file.isEnabledFlash()){var c=d.create("a",{href:"http://helpx.adobe.com/flash-player.html",innerHTML:this.nls.enableFlash,target:"_blank"});
new f({message:c});e.preventDefault();return}if(!a.file.supportFileAPI()){new f({message:this.nls.unsupportReaderAPI});e.preventDefault();return}}d.setStyle(this.fileInput,"display","none");setTimeout(g.hitch(this,function(){d.setStyle(this.fileInput,"display","block")}),200)}}))},_addTip:function(){if(this.showTip){var a=s.substitute({width:this.goldenWidth||40,height:this.goldenHeight||40},this.nls.toolTip);d.setAttr(this.domNode,"title",a)}else d.setAttr(this.domNode,"title","")},_setupFileInput:function(){if(9>=
h("ie"))this.own(p(this.fileInput,"change",g.hitch(this,this._onFileInputChange)));else p.once(this.fileInput,"change",g.hitch(this,this._onFileInputChange))},_onFileInputChange:function(e){var c=e.target.files&&e.target.files[0]||e.files&&e.files[0];if(this.format&&-1===this.format.indexOf(c.type))new f({message:this.nls.invalidType}),(!h("ie")||9<h("ie"))&&this._recreateFileForm();else{var b=9>h("ie")?23552:1024*this.maxSize;a.file.readFile(e,"image/*",b,g.hitch(this,function(a,e,k){a?(e=this.nls[a.errCode],
"exceed"===a.errCode&&(e=e.replace("1024",b/1024)),new f({message:e})):window.isXT&&this.cropImage&&"image/gif"!==c.type?this._cropImageByUser(k):this._readFileData(k);(!h("ie")||9<h("ie"))&&this._recreateFileForm()}))}},_recreateFileForm:function(){var a=g.clone(this.mask),e=g.clone(this.fileInput);d.destroy(this.mask);d.destroy(this.fileInput);var c=g.clone(this.fileForm);d.place(a,c);d.place(e,c);d.place(c,this.fileForm,"replace");this.maskHandle.remove();this.mask=a;this.fileInput=e;d.destroy(this.fileForm);
this.fileForm=c;this._porcessMaskClick();this._setupFileInput()},_readFileData:function(a){this.onImageChange(a);this.displayImg&&d.setAttr(this.displayImg,"src",a);this.showSelfImg&&(this.selfImg?d.setAttr(this.selfImg,"src",a):this.selfImg.src=a)},_cropImageByUser:function(a){var b=new m({imageSrc:a,nls:g.clone(this.nls),realWidth:this.goldenWidth,realHeight:this.goldenHeight}),k=new e({hidden:!0}),h=new c({titleLabel:"Crop Image",content:b,width:500,height:480,buttons:[{label:this.nls.common.ok,
onClick:g.hitch(this,function(){var e=b.getImageSize(),c=b.getCropSize();k.show();r("/webappbuilder/rest/cropimage",{data:{imageData:a,imageDisplaySize:e.w+","+e.h,cropRectangle:c.w+","+c.h+","+c.t+","+c.l},method:"POST",handleAs:"json",headers:{"X-Requested-With":null}}).then(g.hitch(this,function(a){a.success?(this._readFileData(a.imageData),h.close()):(new f({message:this.nls.unknowError}),k.hide())}),g.hitch(this,function(a){console.error(a);new f({message:this.nls.unknowError});k.hide()}))})}]});
k.placeAt(h.domNode);b.startup();d.addClass(h.domNode,"image-chooser-crop-popup")},onImageChange:function(a){this.imageData=a}});n.GIF="image/gif";n.JPEG="image/jpeg";n.PNG="image/png";return n})},"jimu/dijit/_CropImage":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_CropImage.html jimu/dijit/Message esri/lang dojo/NodeList-dom".split(" "),function(n,b,l,g,d,p,q,h,r,s){return n([p,q],{templateString:h,
inDrag:!1,inSlider:!1,realWidth:30,realHeight:30,ratio:null,imageSrc:null,_currentX:null,_currentY:null,_currentTop:0,_currentLeft:0,postCreate:function(){this._dragingHandlers=[];this.setImageSrc(this.imageSrc);this.own(g(this.ownerDocument,"mousemove",l.hitch(this,"_onMouseMove")));this.own(g(this.ownerDocument,"mouseup",l.hitch(this,"_onMouseUp")));this.loadingImg.src=require.toUrl("jimu")+"/images/loading.gif";this.own(g(this.baseImage,"load",l.hitch(this,function(){this._init();b.setStyle(this.loadingImg,
"display","none")})))},setImageSrc:function(a){b.setAttr(this.viewerImage,"src",a);b.setAttr(this.baseImage,"src",a)},getImageSize:function(){return{w:this._currentImageWidth,h:this._currentImageHeight}},getCropSize:function(){return{l:-this._currentLeft,t:-this._currentTop,w:this.idealWidth,h:this.idealHeight}},_init:function(){var a=this._getComputedStyle(this.cropSection),m=b.getContentBox(this.cropSection),c=this._getComputedStyle(this.baseImage),f=parseFloat(c.width)||this.baseImage.offsetWidth,
c=parseFloat(c.height)||this.baseImage.offsetHeight,e=f/c;this._maxImageWidth=f;this._maxImageHeight=c;if(c<this.realHeight&&f<this.realWidth)a=s.substitute({width:this.realWidth,height:this.realHeight},this.nls.cropWaining),setTimeout(l.hitch(this,function(){this.popup.close()}),50),new r({message:a});else{this.idealWidth=this.realWidth;this.idealHeight=this.realHeight;var k=this.ratio=this.ratio?this.ratio:this.realWidth/this.realHeight;1<=this.ratio?m.h*this.ratio<=m.w?(this.idealHeight=m.h,this.idealWidth=
m.h*this.ratio):(this.idealHeight=this._findProperlyValue(0,m.h,m.w-5,function(a){return a*k}),this.idealWidth=this.idealHeight*this.ratio):m.w/this.ratio<=m.h?(this.idealWidth=m.w,this.idealHeight=m.w/this.ratio):(this.idealWidth=this._findProperlyValue(0,m.w,m.h-5,function(a){return a/k}),this.idealHeight=this.idealWidth/this.ratio);b.setStyle(this.viewerBox,{width:this.idealWidth+"px",height:this.idealHeight+"px"});a=Math.abs((parseFloat(a.height)-this.idealHeight)/2);b.setStyle(this.cropSection,
{paddingTop:a+"px",paddingBottom:a+"px"});1<=e?this.idealHeight*e>=this.idealWidth?(b.setStyle(this.viewerImage,"height",this.idealHeight+"px"),b.setStyle(this.baseImage,"height",this.idealHeight+"px")):(a=this._findProperlyValue(0,this.idealWidth,this.idealWidth,function(a){return a*e}),b.setStyle(this.viewerImage,"height",a+"px"),b.setStyle(this.baseImage,"height",a+"px")):this.idealWidth/e>=this.idealHeight?(b.setStyle(this.viewerImage,"width",this.idealWidth+"px"),b.setStyle(this.baseImage,"width",
this.idealWidth+"px")):(a=this._findProperlyValue(0,this.idealHeight,this.idealHeight,function(a){return a/e}),b.setStyle(this.viewerImage,"width",a+"px"),b.setStyle(this.baseImage,"width",a+"px"));d(".hide-status",this.domNode).removeClass("hide-status");c=this._getComputedStyle(this.baseImage);f=parseFloat(c.width)||this.baseImage.offsetWidth;c=parseFloat(c.height)||this.baseImage.offsetHeight;this._minImageWidth=f;this._minImageHeight=c;this._currentImageWidth=f;this._currentImageHeight=c;this._currentTop=
-(c-this.idealHeight)/2;this._currentLeft=-(f-this.idealWidth)/2;b.setStyle(this.baseImage,{top:this._currentTop+"px",left:this._currentLeft+"px"});b.setStyle(this.viewerImage,{top:this._currentTop+"px",left:this._currentLeft+"px"});this._zoomRatio=this._maxImageWidth/this._minImageWidth;1>=this._zoomRatio&&b.addClass(this.zoomInBtn,"disable-zoom");b.addClass(this.zoomOutBtn,"disable-zoom");this._latestPercentage=window.isRTL?100:0}},_findProperlyValue:function(a,b,c,f,e){e=isFinite(e)?parseFloat(e):
1;c=0>c-e||0>c+e?e:c;var k=(a+b)/2,d=f(k);if(d<=c+e&&d>=c-e)return k;if(d>c)return this._findProperlyValue(a,k,c,f);if(d<c)return this._findProperlyValue(k,b,c,f)},_getComputedStyle:function(a){a=b.getMarginBox(a);return{width:a.w,height:a.h,left:a.l,top:a.t}},_onViewerMouseDown:function(a){var b=this._getComputedStyle(this.baseImage),c=this._getComputedStyle(this.viewerContent);this._maxOffsetLeft=parseFloat(c.width)-parseFloat(b.width);this._maxOffsetTop=parseFloat(c.height)-parseFloat(b.height);
this._maxOffsetLeft=0<this._maxOffsetLeft?0:this._maxOffsetLeft;this._maxOffsetTop=0<this._maxOffsetTop?0:this._maxOffsetTop;this.inDrag=!0;this._currentX=a.clientX;this._currentY=a.clientY;this._stopSelect()},_stopSelect:function(){this._dragingHandlers=this._dragingHandlers.concat([g(this.ownerDocument,"dragstart",function(a){a.stopPropagation();a.preventDefault()}),g(this.ownerDocumentBody,"selectstart",function(a){a.stopPropagation();a.preventDefault()})])},_removeStopSelect:function(){for(var a=
this._dragingHandlers.pop();a;)a.remove(),a=this._dragingHandlers.pop()},_onViewerMouseUp:function(a){this.inDrag&&(this.inDrag=!1,this._resetImagePosition(a.clientX,a.clientY),this._removeStopSelect(),a.stopPropagation())},_onSliderMouseDown:function(a){if(!(1>=this._zoomRatio)){this.inSlider=!0;this._currentX=a.clientX;this._currentY=a.clientY;var d=b.position(this.sliderNode);this._startSliderLeft=d.x;this._sliderWidth=d.w;this._stopSelect();a.stopPropagation()}},_onSliderMouseUp:function(a){if(!(1>=
this._zoomRatio)&&this.inSlider){this.inSlider=!1;this._resetSliderButtonPosition(a.clientX);var b=this._getComputedStyle(this.baseImage);this._currentLeft=parseFloat(b.left);this._currentTop=parseFloat(b.top);this._latestPercentage=100*((a.clientX-this._startSliderLeft)/this._sliderWidth);this._latestPercentage=this._normalizePercentage(this._latestPercentage);this._removeStopSelect();a.stopPropagation()}},_onMouseMove:function(a){this.inDrag&&this._resetImagePosition(a.clientX,a.clientY);this.inSlider&&
!(1>=this._zoomRatio)&&this._resetSliderButtonPosition(a.clientX,a.clientY)},_onMouseUp:function(a){this.inDrag&&this._onViewerMouseUp(a);this.inSlider&&this._onSliderMouseUp(a)},_onZoomOutClick:function(){1>=this._zoomRatio||this._zoomImage("out")},_onZoomInClick:function(){1>=this._zoomRatio||this._zoomImage("in")},_zoomImage:function(a){var b=0;this._latestPercentage=this._normalizePercentage(this._latestPercentage);"in"===a?b=window.isRTL?this._latestPercentage-20:this._latestPercentage+20:"out"===
a&&(b=window.isRTL?this._latestPercentage+20:this._latestPercentage-20);a=this._normalizePercentage(b);this._moveSliderButton(a,this._latestPercentage);this._latestPercentage=a;a=this._getComputedStyle(this.baseImage);this._currentLeft=parseFloat(a.left);this._currentTop=parseFloat(a.top)},_resetImagePosition:function(a,d){var c=a-this._currentX,f=d-this._currentY;0<=this._currentTop+f?(b.setStyle(this.baseImage,"top",0),b.setStyle(this.viewerImage,"top",0),this._currentY=d,this._currentTop=0):this._currentTop+
f<=this._maxOffsetTop?(b.setStyle(this.baseImage,"top",this._maxOffsetTop+"px"),b.setStyle(this.viewerImage,"top",this._maxOffsetTop+"px"),this._currentY=d,this._currentTop=this._maxOffsetTop):(b.setStyle(this.baseImage,"top",this._currentTop+f+"px"),b.setStyle(this.viewerImage,"top",this._currentTop+f+"px"),this._currentY=d,this._currentTop+=f);0<=this._currentLeft+c?(b.setStyle(this.baseImage,"left",0),b.setStyle(this.viewerImage,"left",0),this._currentX=a,this._currentLeft=0):this._currentLeft+
c<=this._maxOffsetLeft?(b.setStyle(this.baseImage,"left",this._maxOffsetLeft+"px"),b.setStyle(this.viewerImage,"left",this._maxOffsetLeft+"px"),this._currentX=a,this._currentLeft=this._maxOffsetLeft):(b.setStyle(this.baseImage,"left",this._currentLeft+c+"px"),b.setStyle(this.viewerImage,"left",this._currentLeft+c+"px"),this._currentX=a,this._currentLeft+=c)},_normalizePercentage:function(a){a=0>a?0:a;return 100<a?100:a},_resetSliderButtonPosition:function(a){a=100*((a-this._startSliderLeft)/this._sliderWidth);
a=this._normalizePercentage(a);this._moveSliderButton(a,this._latestPercentage)},_moveSliderButton:function(a,d){0>=a?b.addClass(this.zoomOutBtn,"disable-zoom"):b.removeClass(this.zoomOutBtn,"disable-zoom");100<=a?b.addClass(this.zoomInBtn,"disable-zoom"):b.removeClass(this.zoomInBtn,"disable-zoom");b.setStyle(this.sliderButton,"left",a+"%");window.isRTL&&(a=100-a,d=100-d);var c=this._minImageWidth*(this._zoomRatio-1)*a/100,f=this._minImageHeight*(this._zoomRatio-1)*a/100,e=this._getComputedStyle(this.baseImage);
this._currentLeft=parseFloat(e.left);this._currentTop=parseFloat(e.top);var e=(Math.abs(this._currentLeft)+this.idealWidth/2)*((this._minImageWidth+c)/this._currentImageWidth-1),k=(Math.abs(this._currentTop)+this.idealHeight/2)*((this._minImageWidth+c)/this._currentImageWidth-1);b.setStyle(this.baseImage,{width:this._minImageWidth+c+"px",height:this._minImageHeight+f+"px"});b.setStyle(this.viewerImage,{width:this._minImageWidth+c+"px",height:this._minImageHeight+f+"px"});this._currentImageWidth=this._minImageWidth+
c;this._currentImageHeight=this._minImageHeight+f;if(0<=a-d)b.setStyle(this.baseImage,{top:this._currentTop-k+"px",left:this._currentLeft-e+"px"}),b.setStyle(this.viewerImage,{top:this._currentTop-k+"px",left:this._currentLeft-e+"px"});else{var h=0,g=0,h=0<=this._currentTop-k?0:this._currentTop-k+this._minImageHeight+f<=this.idealHeight?this.idealHeight-this._minImageHeight-f:this._currentTop-k,g=0<=this._currentLeft-e?0:this._currentLeft-e+this._minImageWidth+c<=this.idealWidth?this.idealWidth-this._minImageWidth-
c:this._currentLeft-e;b.setStyle(this.baseImage,{top:h+"px",left:g+"px"});b.setStyle(this.viewerImage,{top:h+"px",left:g+"px"})}this._latestPercentage=a}})})},"jimu/dijit/ExtentChooser":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/Deferred dijit/_WidgetBase dojo/Evented esri/geometry/Extent jimu/portalUrlUtils jimu/dijit/LoadingShelter jimu/utils".split(" "),function(n,b,l,g,d,p,q,h,r,s,a){return n([p,q],{baseClass:"jimu-extent-chooser",declaredClass:"jimu.dijit.ExtentChooser",
portalUrl:null,itemId:null,initExtent:null,bingMapsKey:"",geometryServiceURL:null,shelter:null,postCreate:function(){this.inherited(arguments);!this.geometryServiceURL&&esriConfig.defaults.geometryService&&(this.geometryServiceURL=esriConfig.defaults.geometryService.url);this.geometryServiceURL||(this.geometryServiceURL=a.getServices().geometryService);this.shelter=new s({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this.shelter.show();var d=l.create("div",{style:{width:"100%",
height:"100%"}},this.domNode);if(this.portalUrl&&this.itemId){this.portalUrl=r.getStandardPortalUrl(this.portalUrl);var c={geometryServiceURL:this.geometryServiceURL,bingMapsKey:this.bingMapsKey};this.initExtent&&("esri.geometry.Extent"!==this.initExtent.declaredClass&&(this.initExtent=new h(this.initExtent)),c.mapOptions={extent:this.initExtent});this.lods&&("object"===typeof c.mapOptions?c.mapOptions.lods=this.lods:c.mapOptions={lods:this.lods});a.createWebMap(this.portalUrl,this.itemId,d,c).then(b.hitch(this,
function(a){this.map=a.map;this.map.webMapResponse=a;this.own(g(this.map,"extent-change",b.hitch(this,function(a){this.onExtentChange(a.extent)})));if(this.initExtent)this.onExtentChange(this.initExtent);else this.onExtentChange(this.map.extent);this.shelter.hide();this.emit("map-load",this.map)}),b.hitch(this,function(a){console.error(a)}))}},getExtent:function(){return this.map&&this.map.extent},setExtent:function(a){if(this.map)return this.map.setExtent(a);var c=new d;setTimeout(b.hitch(this,function(){c.reject("map is null.")}),
0);return c},restoreToDefaultWebMapExtent:function(){a.restoreToDefaultWebMapExtent(this.map,this.map.webMapResponse,this.geometryServiceURL)},onExtentChange:function(a){this.emit("extent-change",a)}})})},"widgets/Bookmark/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/ImageChooser.html":'\x3cdiv class\x3d"jimu-image-chooser js-fileapi-wrapper"\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintText"\x3e\r\n\t\t\x3cspan class\x3d"display-text" data-dojo-attach-point\x3d"displayText"\x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintImage"\x3e\r\n\t\t\x3cimg class\x3d"display-image" data-dojo-attach-point\x3d"selfImg"\x3e\r\n  \x3c/div\x3e\r\n  \x3cform data-dojo-attach-point\x3d"fileForm"\x3e\r\n    \x3clabel data-dojo-attach-point\x3d"mask"\x3e\x3c/label\x3e\r\n    \x3cinput type\x3d"file" data-dojo-attach-point\x3d"fileInput"\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_CropImage.html":'\x3cdiv class\x3d"jimu-crop-image"\x3e\r\n\t\x3cdiv class\x3d"crop-section" data-dojo-attach-point\x3d"cropSection"\x3e\r\n\t\t\x3cdiv class\x3d"viewer-box hide-status" data-dojo-attach-point\x3d"viewerBox"\x3e\r\n\t\t\t\x3cdiv class\x3d"viewer-content" data-dojo-attach-point\x3d"viewerContent"\x3e\r\n\t\t\t\t\x3cimg class\x3d"viewer-image hide-status" data-dojo-attach-point\x3d"viewerImage" src\x3d""\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cimg class\x3d"base-image hide-status" data-dojo-attach-point\x3d"baseImage" data-dojo-attach-event\x3d"mousedown:_onViewerMouseDown,mouseup:_onViewerMouseUp"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cimg class\x3d"loading-image" data-dojo-attach-point\x3d"loadingImg" src\x3d""\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"controller hide-status" data-dojo-attach-point\x3d"zoomController"\x3e\r\n\t\t\x3cdiv class\x3d"zoom-out" data-dojo-attach-point\x3d"zoomOutBtn" data-dojo-attach-event\x3d"click:_onZoomOutClick"\x3e-\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"slider" data-dojo-attach-point\x3d"sliderNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"button" data-dojo-attach-point\x3d"sliderButton" data-dojo-attach-event\x3d"mousedown:_onSliderMouseDown,mouseup:_onSliderMouseUp"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"horizontal"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"zoom-in" data-dojo-attach-point\x3d"zoomInBtn" data-dojo-attach-event\x3d"click:_onZoomInClick"\x3e+\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Bookmark/setting/Edit.html":'\x3cdiv style\x3d"width: 100%"\x3e\r\n  \x3ctable class\x3d"setting-table input-table" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd title\x3d"${nls.title}" class\x3d"first"\x3e*${nls.title}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"displayName"\r\n            required\x3d"true" placeHolder\x3d${nls.title} data-dojo-props\x3d\'style:{width:"100%"}\'/\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd title\x3d"${nls.thumbnail}" class\x3d"first"\x3e${nls.thumbnail}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;(${nls.thumbnailHint})\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e                                                                  \r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e \r\n    \x3cdiv class\x3d"extent-chooser" style\x3d"height: 400px" data-dojo-attach-point\x3d"extentChooserNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Setting.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"marks-table-div" data-dojo-attach-point\x3d"bookmarksDiv"\x3e\r\n     \x3cdiv class\x3d\'bookmark-add jimu-float-leading jimu-leading-margin2\' data-dojo-attach-event\x3d"onclick: onAddBookmarkClick"\x3e\r\n      \x3cdiv class\x3d"add_mark_image"\x3e\x3c/div\x3e\u200b\r\n      \x3cdiv title\x3d"${nls.add}" class\x3d"add_mark_text"\x3e${nls.add}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/Bookmark/setting/css/style.css":".jimu-img-node{font-size: 12px; position: relative; float: left; border-radius: 4px; color: #686868; overflow: hidden;}.jimu-img-node .node-box{position: absolute; top: 0; bottom: 32px; left: 0; width: 100%; border-radius: 4px; overflow: hidden;}.jimu-img-node img{width: 100%; height: 100%; cursor: pointer;}.jimu-img-node .node-label{position: absolute; width: 100%; left: 0; bottom: 0; height: 30px; text-align: center; overflow: hidden; text-overflow: ellipsis;}.jimu-img-node:hover{color: #51b1fe;}.jimu-img-node.jimu-state-selected .node-label{background-color: #d9dde0;}.jimu-widget-bookmark-setting {height: 100%;}.jimu-widget-bookmark-setting .bookmark-list{height: 100%; width: 100%; overflow: auto;}.jimu-widget-bookmark-setting .marks-table-div{width: 100%; height: 100%; overflow-x:hidden; overflow-y:auto;}.jimu-widget-bookmark-setting .bookmark-add{position:relative; width:100px; height:60px; padding:3px; text-align:center; color:#999999; font-size:10px; border:1px dotted gray; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; background-size:cover; margin-top: 5px; margin-left: 20px\\9;}.jimu-widget-bookmark-setting .bookmark-add .add_mark_image{display: block; position: absolute; left: 43px; top: 5px; width:14px; height:14px; background-position:center center; background-image:url(images/add_mark.png);}.jimu-widget-bookmark-setting .bookmark-add .add_mark_text{display: block; position: absolute; top: 25px; width: 100%; font-size: 12px; white-space: normal; height: 35px; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-bookmark-setting .bookmark-add:hover{cursor: pointer;}.jimu-widget-bookmark-setting .mark-item-div{position:relative; width:100px; height: 92px; font-size: 10px; margin-top: 5px;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg{position:relative; width:100%; height:60px; line-height:28px; text-align:center; color:#999999; font-size:13px;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-thumbnail{width:100%; height:100%; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-detail-icon{display: block;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg.selected .mark-item-thumbnail{-webkit-box-sizing:content-box; -moz-box-sizing:content-box; -ms-box-sizing:content-box; -o-box-sizing:content-box; box-sizing:content-box;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon{display: none; position:absolute; right:2px; bottom:2px; width:20px; height:20px; background-color:rgba(0, 0, 0, 0.3); background-repeat:no-repeat; background-position:center center; background-image:url(images/edit_mark.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon:hover{background-color:rgba(0, 0, 0, 0.6);}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg:hover .mark-item-detail-icon{display: block;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon{display: none; position:absolute; right:5px; top:5px; width:10px; height:10px; background-repeat:no-repeat; background-position:center center; background-image:url(images/delete_mark.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg:hover .mark-item-delete-icon{display: block;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-title{display:inline-block; width:100%; text-align:center; color:#333333; font-size:12px; margin-top: 2px; margin-bottom: 25px; overflow: hidden; text-overflow: ellipsis; height: 30px;}.jimu-Bookmark-Edit{height: 100%; overflow-y: auto;}.jimu-Bookmark-Edit .setting-table {margin: 5px 20px; border-spacing: 10px; border-collapse: separate;}.jimu-Bookmark-Edit .setting-table .img-chooser{width: 100px; height: 60px;}.jimu-Bookmark-Edit .input-table \x3e tbody \x3e tr \x3e .first{width:auto; text-align: left; padding-right:15px; white-space: nowrap; max-width: 108px; overflow: hidden; text-overflow: ellipsis;}.jimu-Bookmark-Edit .input-table \x3e tbody \x3e tr \x3e .second{width:660px;}.jimu-rtl .jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon{right:auto; left: 5px;}.jimu-rtl .jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon{right:auto; left: 2px;}.jimu-rtl .jimu-widget-bookmark-setting .mark-item-div:nth-child(8n+1){margin-left: auto; margin-right: 0px;}.jimu-rtl .jimu-widget-bookmark-setting .bookmark-add{margin-left: auto; margin-right: 20px\\9;}",
"*now":function(n){n(['dojo/i18n!*preload*widgets/Bookmark/setting/nls/Setting*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/keys dojo/query jimu/BaseWidgetSetting jimu/dijit/Popup jimu/dijit/Message jimu/utils ./Edit libs/storejs/store".split(" "),function(n,b,l,g,d,p,q,h,r,s,a,m,c,f){return n([r,b],{baseClass:"jimu-widget-bookmark-setting",bookmarks:[],edit:null,popup:null,popupState:"",editIndex:null,startup:function(){this.inherited(arguments);this.setConfig(this.config)},setConfig:function(a){this.config=
a;this.bookmarks=this.config.bookmarks2D;0===this.bookmarks.length&&(this.map.itemInfo&&this.map.itemInfo.itemData&&this.map.itemInfo.itemData.bookmarks)&&g.forEach(this.map.itemInfo.itemData.bookmarks,function(a){a.isInWebmap=!0;this.bookmarks.push(a)},this);this.currentBookmark=null;this.displayBookmarks()},getConfig:function(a){this.config.bookmarks2D=this.bookmarks;if(a){a=this._getKeysKey();for(var b in f.getAll())b.startWith(a)&&f.remove(b)}return this.config},displayBookmarks:function(){this._processDuplicateName(this.bookmarks);
this._clearBookmarksDiv();this._createmarkItems()},_clearBookmarksDiv:function(){for(var a=h(".mark-item-div",this.domNode),b=0;b<a.length;b++)d.destroy(a[b])},destroy:function(){this.inherited(arguments)},_getKeysKey:function(){return this.appConfig.map["3D"]?this.name+".3D":this.name+".2D"},onAddBookmarkClick:function(){this.popupState="ADD";this._openEdit(this.nls.addBookmark,{name:"",thumbnail:"",extent:this.map.extent.toJson()})},getBookmarkByName:function(a){for(var b=this.bookmarks.length,
c=0;c<b;c++)if(this.bookmarks[c].displayName===a)return this.editIndex=c,this.bookmarks[c]},_onEditClick:function(a){this.getBookmarkByName(a);a=this.bookmarks[this.editIndex];this.popupState="EDIT";this._openEdit(this.nls.edit,a)},_openEdit:function(a,b){this.edit=new c({nls:this.nls,folderUrl:this.folderUrl,portalUrl:this.appConfig.map.portalUrl,itemId:this.appConfig.map.itemId,mapOptions:this.appConfig.map.mapOptions});this.edit.setConfig(b||{});this.popup=new s({titleLabel:a,autoHeight:!0,content:this.edit,
container:"main-page",width:640,buttons:[{label:this.nls.ok,key:q.ENTER,disable:!0,onClick:l.hitch(this,"_onEditOk")},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],key:q.ESCAPE}],onClose:l.hitch(this,"_onEditClose")});d.addClass(this.popup.domNode,"widget-setting-popup");this.edit.startup()},_onEditOk:function(){var b=this.edit.getConfig(),c=null;!b.name||!b.extent?new a({message:this.nls.warning}):("ADD"===this.popupState?(this.bookmarks.push(b),this.displayBookmarks(),c=!0):"EDIT"===this.popupState&&
(this.bookmarks.splice(this.editIndex,1,b),this.displayBookmarks(),c=!0),c?(this.popup.close(),this.popupState="",this.editIndex=null,c=!1):(b=g.mark(c.repeatFields,l.hitch(this,function(a){return a&&a.name})),new a({message:this.nls[c.errorCode]+b.toString()})))},_onEditClose:function(){this.popup=this.edit=null},_createmarkItems:function(){for(var a=0;a<this.bookmarks.length;a++){var b=this._createmarkItem(this.bookmarks[a]);d.place(b,this.bookmarksDiv)}},_createmarkItem:function(a){var b=d.toDom("\x3cdiv class\x3d'mark-item-div jimu-float-leading jimu-leading-margin2'\x3e\x3cdiv class\x3d'mark-item-bg'\x3e\x3cimg class\x3d'mark-item-thumbnail'\x3e\x3cdiv class\x3d'mark-item-delete-icon'\x3e\x3c/div\x3e\x3cdiv class\x3d'mark-item-detail-icon'\x3e\x3c/div\x3e\x3c/div\x3e\x3cspan class\x3d'mark-item-title'\x3e\x3c/span\x3e\x3c/div\x3e"),
c=h(".mark-item-thumbnail",b)[0],f=h(".mark-item-title",b)[0],g=h(".mark-item-delete-icon",b)[0];this.own(p(g,"click",l.hitch(this,this._onmarkItemDeleteClick,a.displayName)));g=h(".mark-item-detail-icon",b)[0];this.own(p(g,"click",l.hitch(this,this._onmarkItemEditClick,a.displayName)));b.item=a;g=a.thumbnail?m.processUrlInWidgetConfig(a.thumbnail,this.folderUrl):this.folderUrl+"images/thumbnail_default.png";d.setAttr(c,"src",g);f.innerHTML=m.sanitizeHTML(a.displayName);d.setAttr(f,"title",a.displayName);
return b},_clearBasemarksDiv:function(){for(var a=h(".mark-item-div",this.domNode),b=0;b<a.length;b++)d.destroy(a[b])},_onmarkItemEditClick:function(a){this._onEditClick(a)},_onmarkItemDeleteClick:function(a){this.getBookmarkByName(a);null!==this.editIndex&&this.bookmarks.splice(this.editIndex,1);this.displayBookmarks()},_processDuplicateName:function(a){var b=[],c={};g.forEach(a,function(a){var d=a.name;d in c?c[d]++:c[d]=0;if(0<c[d]){var e=d+"("+c[d]+")";e in c?(c[e]++,c[d]++):c[e]=0;a.displayName=
0<c[e]?d+"("+c[d]+")":e}else a.displayName=d;b.push(a)},this);a=b}})});