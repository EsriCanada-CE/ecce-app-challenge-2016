// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/Chart/Preview.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"results-section" data-dojo-attach-point\x3d"resultsSection"\x3e\r\n\t\t\x3cdiv class\x3d"results-header" data-dojo-attach-point\x3d"resultsHeader" style\x3d"margin-bottom:15px;"\x3e\r\n\t\t\t\x3cdiv class\x3d"chart-title jimu-float-leading" data-dojo-attach-point\x3d"chartTitle"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"paging-section jimu-float-leading"\x3e\r\n\t\t\t\t\x3cul data-dojo-attach-point\x3d"pagingUl" data-dojo-attach-event\x3d"onclick:_onPagingUlClicked"\x3e\x3c/ul\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"zoomin jimu-float-trailing" data-dojo-attach-point\x3d"zoominIcon"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"settings jimu-float-trailing" data-dojo-attach-point\x3d"settingsIcon"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"chart-section"\x3e\r\n\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"width:100%;table-layout:fixed;"\x3e\r\n\t\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\t\x3ccol width\x3d"15px;"\x3e\x3c/col\x3e\r\n\t\t\t\t\t\x3ccol width\x3d"auto;"\x3e\x3c/col\x3e\r\n\t\t\t\t\t\x3ccol width\x3d"15px;"\x3e\x3c/col\x3e\r\n\t\t    \t\x3c/colgroup\x3e\r\n\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item left-arrow arrow" data-dojo-attach-point\x3d"leftArrow" data-dojo-attach-event\x3d"onclick:_onLeftArrowClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item chart-container" data-dojo-attach-point\x3d"chartContainer" dir\x3d"ltr" style\x3d"direction:ltr;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item right-arrow arrow" data-dojo-attach-point\x3d"rightArrow" data-dojo-attach-event\x3d"onclick:_onRightArrowClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"chart-description" data-dojo-attach-point\x3d"descriptionNode"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"noresults-section" data-dojo-attach-point\x3d"noresultsSection"\x3e\r\n\t\t${nls.noResults}\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/_base/Color dojo/on dojo/sniff dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/TooltipDialog dijit/popup dojo/Evented dojo/text!./Preview.html dojox/charting/Chart dojox/charting/axis2d/Default dojox/charting/axis2d/Invisible dojox/charting/plot2d/Columns dojox/charting/plot2d/Bars dojox/charting/plot2d/Lines dojox/charting/plot2d/Pie dojox/charting/plot2d/ClusteredColumns dojox/charting/plot2d/ClusteredBars dojox/charting/action2d/Tooltip dojox/charting/action2d/Highlight dojox/charting/action2d/MoveSlice dojox/charting/action2d/Magnify dojox/charting/SimpleTheme esri/symbols/jsonUtils esri/graphic esri/graphicsUtils esri/lang jimu/utils jimu/portalUrlUtils ./common/Parameters jimu/dijit/LoadingIndicator dojox/charting/action2d/MouseIndicator".split(" "),
function(P,g,p,r,D,C,F,Q,R,S,T,U,J,V,W,w,u,v,K,L,G,H,X,Y,x,y,A,I,M,E,Z,$,N,t,O,aa){return P([R,S,T,V],{baseClass:"jimu-widget-chart-preview",templateString:W,charts:[],paramsDijits:[],tooltipDialogs:[],currentChartIndex:-1,layerDefinition:null,config:null,featureSet:null,map:null,resultLayer:null,tempGraphics:null,maxHorLabelSpace:100,maxVerLabelSpace:100,folderUrl:"",maxPreviewFeaturesCount:20,pieScale:1.1,showZoomIcon:!1,isBigPreview:!1,floatNumberFieldDecimalPlace:null,popupFieldInfosObj:null,
postCreate:function(){this.inherited(arguments);this.map?this.own(F(document.body,"click",g.hitch(this,this._onDocumentBodyClick))):r.destroy(this.settingsIcon);this.showZoomIcon?this.own(F(this.zoominIcon,"click",g.hitch(this,function(){this.emit("zoomin")}))):r.destroy(this.zoominIcon);this.isBigPreview&&(this.chartContainer.style.maxHeight="auto",r.addClass(this.domNode,"big-preview"))},onClose:function(){this._hideAllTooltipDialogs()},destroy:function(){this.clear();this.inherited(arguments)},
resize:function(){0<=this.currentChartIndex&&this._recreateChart(this.currentChartIndex)},_calculateChartBox:function(){var a=r.getContentBox(this.domNode),b=r.getMarginBox(this.resultsHeader),c=r.getMarginBox(this.descriptionNode),a=a.h-b.h-c.h,b=60;a<b&&(b=a);r.setStyle(this.leftArrow,"height",b+"px");r.setStyle(this.rightArrow,"height",b+"px");r.setStyle(this.chartContainer,"height",a+"px");return r.getContentBox(this.chartContainer)},createCharts:function(a){try{this.loading.hide();this.clear();
if(!this.map){var b=this.maxPreviewFeaturesCount;a.featureSet.features.length>b&&(a.featureSet.features=a.featureSet.features.slice(0,b))}r.setStyle(this.resultsSection,"display","block");r.setStyle(this.noresultsSection,"display","none");D(".chart-section-item",this.domNode).forEach(g.hitch(this,function(a){r.setStyle(a,"height",0)}));this.config=a.config;this.featureSet=a.featureSet;this.layerDefinition=a.layerDefinition;this.resultLayer=a.resultLayer;this._updatePopupFieldInfos();this._calculateDecimalPlaceForFloatField();
this.chartTitle.innerHTML=t.stripHTML(this.config.name||"");this.chartTitle.title=this.chartTitle.innerHTML;this.descriptionNode.innerHTML=t.stripHTML(this.config.description||"");r.setStyle(this.resultsSection,"display","block");for(var c=0,e,b=[],d=this._getTypes(a.config),q=this._calculateChartBox(),l=q.w+"px",n=q.h+"px",c=0;c<d.length;c++){e=r.create("div",{"class":"chart-div",style:{width:l,height:n}},this.chartContainer);b.push(e);var h=r.toDom("\x3cli class\x3d'paging-li'\x3e\x3ca class\x3d'paging-a'\x3e\x3c/a\x3e\x3c/li\x3e");
r.place(h,this.pagingUl)}var f=a.config;e=null;"feature"===f.mode?e=this._createFeatureModeCharts(a,b):"category"===f.mode?e=this._createCategoryModeCharts(a,b):"count"===f.mode?e=this._createCountModeCharts(a,b):"field"===f.mode&&(e=this._createFieldModeCharts(a,b));this.charts=e.charts;this.paramsDijits=e.paramsDijits;this.tooltipDialogs=p.map(this.paramsDijits,g.hitch(this,function(a){var b=r.create("div");a.placeAt(b);return new U({content:b})}));this.map&&p.forEach(this.paramsDijits,g.hitch(this,
function(a,b){this.own(F(a,"change",g.hitch(this,function(){a.showShelter();this._recreateChart(b);a.hideShelter()})))}));this._showChart(0);0===a.featureSet.features.length&&(r.setStyle(this.resultsSection,"display","none"),r.setStyle(this.noresultsSection,"display","block"))}catch(m){console.error(m)}},_updatePopupFieldInfos:function(){this.popupFieldInfosObj={};var a=null,b=t.removeSuffixSlashes(this.config.url),b=O.removeProtocol(b);if(this.map&&this.map.itemInfo&&this.map.itemInfo.itemData){var c=
this.map.itemInfo.itemData.operationalLayers,e=b.split("/"),d=parseInt(e[e.length-1],10);c&&0<c.length&&p.some(c,g.hitch(this,function(c){var e=c.url;if(e&&(e=t.removeSuffixSlashes(e),e=O.removeProtocol(e),0<=b.indexOf(e)))if(b===e){if(c.popupInfo&&c.popupInfo.fieldInfos)return a=c.popupInfo.fieldInfos,!0}else if(b.length>e.length&&c.layers&&0<=d&&(c=c[d])&&c.popupInfo&&c.popupInfo.fieldInfos)return a=c.popupInfo.fieldInfos,!0;return!1}))}a&&0<a.length&&p.forEach(a,g.hitch(this,function(a){this.popupFieldInfosObj[a.fieldName]=
a}))},_calculateDecimalPlaceForFloatField:function(){this.floatNumberFieldDecimalPlace={};var a=[];this.config.labelField&&a.push(this.config.labelField);this.config.categoryField&&a.push(this.config.categoryField);this.config.valueFields&&(a=a.concat(this.config.valueFields));var b=p.filter(a,g.hitch(this,function(a){return this._isFloatNumberField(a)})),c={};p.forEach(b,g.hitch(this,function(a){c[a]=[]}));(a=this.featureSet&&this.featureSet.features)&&0<a.length&&p.forEach(a,g.hitch(this,function(a){var d=
a.attributes;d&&p.forEach(b,g.hitch(this,function(a){var b=d[a];"number"===typeof b&&c[a].push(b)}))}));p.forEach(b,g.hitch(this,function(a){this.floatNumberFieldDecimalPlace[a]=0;var b=c[a];if(0<b.length)try{var q=this._getBestDecimalPlace(b);this.floatNumberFieldDecimalPlace[a]=q}catch(l){this.floatNumberFieldDecimalPlace[a]=0,console.error(l)}if(this.popupFieldInfosObj&&(b=this.popupFieldInfosObj[a])&&b.format&&0<=b.format.places)this.floatNumberFieldDecimalPlace[a]=b.format.places}))},_onDocumentBodyClick:function(a){if(0<=
this.currentChartIndex&&this.tooltipDialogs){var b=this.tooltipDialogs[this.currentChartIndex];if(b){var c=!!b.isOpendNow;this._hideAllTooltipDialogs();var e=a.target||a.srcElement;if(!(e===this.leftArrow||e===this.rightArrow)&&!r.hasClass(e,"paging-a")&&!r.hasClass(e,"paging-li"))e===this.settingsIcon?c?this._hideTooltipDialog(b):this._showTooltipDialog(b):(a=e===b.domNode,e=r.isDescendant(e,b.domNode),a||e?c?this._showTooltipDialog(b):this._hideTooltipDialog(b):this._hideTooltipDialog(b))}else this._hideAllTooltipDialogs()}else this._hideAllTooltipDialogs()},
clear:function(){this.resultLayer=this.layerDefinition=this.featureSet=this.config=null;this.chartTitle.innerHTML="";this.chartTitle.title="";this.descriptionNode.innerHTML="";this.currentChartIndex=-1;this.popupFieldInfosObj=this.floatNumberFieldDecimalPlace=null;D(".chart-div",this.chartContainer).style({display:"none"});D("li",this.pagingUl).removeClass("selected");this._hideAllTooltipDialogs();this.charts||(this.charts=[]);this.paramsDijits||(this.paramsDijits=[]);this.tooltipDialogs||(this.tooltipDialogs=
[]);for(var a=0;a<this.charts.length;a++)this.charts[a]&&this.charts[a].destroy(),this.charts[a]=null,this.paramsDijits[a]&&this.paramsDijits[a].destroy(),this.paramsDijits[a]=null,this.tooltipDialogs[a]&&this.tooltipDialogs[a].destroy(),this.tooltipDialogs[a]=null;this.charts=[];this.paramsDijits=[];this.tooltipDialogs=[];r.empty(this.pagingUl);r.empty(this.chartContainer);r.setStyle(this.resultsSection,"display","none");r.setStyle(this.noresultsSection,"display","none")},_recreateChart:function(a){if(0>
a||a!==this.currentChartIndex||!this.charts||!this.charts[a])return null;this.loading.show();var b=D(".chart-div",this.chartContainer)[a];r.setStyle(b,"display","block");var c=this._calculateChartBox();r.setStyle(b,"width",c.w+"px");r.setStyle(b,"height",c.h+"px");b=this.charts[a].createSelf;this.charts[a].createSelf=null;this.charts[a].destroy();this.charts[a]=null;this.charts[a]=b();this.loading.hide();return this.charts[a]},_showChart:function(a){this.currentChartIndex=-1;var b=D(".chart-div",
this.chartContainer);b.style({display:"none"});var c=D("li",this.pagingUl);c.removeClass("selected");if(!(0>a)){if(b=b[a])this.currentChartIndex=a,r.setStyle(b,"display","block");(c=c[a])&&r.addClass(c,"selected");if(!this.isBigPreview&&(c=null,this.charts&&0<this.charts.length&&(c=this.charts[a]))){var e=this._calculateChartBox(),d=r.getContentBox(b);if(e.w!==d.w||e.h!==d.h){this.loading.show();if(Q("svg")){r.setStyle(b,"width",e.w+"px");r.setStyle(b,"height",e.h+"px");if((a=c.getPlot("default"))&&
"dojox.charting.plot2d.Pie"===a.declaredClass&&a.opt)b=Math.floor(Math.min(e.w,e.h)/2/this.pieScale),a.opt.radius=b-3;c.resize(e.w,e.h)}else this._recreateChart(a);this.loading.hide()}}}},_hideAllTooltipDialogs:function(){this.tooltipDialogs&&0<this.tooltipDialogs.length&&p.forEach(this.tooltipDialogs,g.hitch(this,function(a){this._hideTooltipDialog(a)}))},_hideTooltipDialog:function(a){a&&(J.close(a),a.isOpendNow=!1)},_showTooltipDialog:function(a){a&&(J.open({popup:a,around:this.settingsIcon}),
a.isOpendNow=!0)},_onPagingUlClicked:function(a){a.stopPropagation();this._hideAllTooltipDialogs();a=a.target||a.srcElement;if("a"===a.tagName.toLowerCase()){var b=D("a",this.pagingUl);a=p.indexOf(b,a);0<=a&&this._showChart(a)}},_onLeftArrowClicked:function(a){a.stopPropagation();this._hideAllTooltipDialogs();a=(this.currentChartIndex-1+this.charts.length)%this.charts.length;0<=a&&this._showChart(a)},_onRightArrowClicked:function(a){a.stopPropagation();this._hideAllTooltipDialogs();a=(this.currentChartIndex+
1+this.charts.length)%this.charts.length;0<=a&&this._showChart(a)},_getHighLightMarkerSymbol:function(){var a=E.fromJson(this.config.symbol),a=Math.max(a.size||0,a.width||0,a.height,18),a=a+1,b=E.fromJson({color:[255,255,255,0],size:18,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSSquare",outline:{color:[0,0,128,255],width:0.75,type:"esriSLS",style:"esriSLSSolid"}});b.setSize(a);b.outline.setColor(new C(this.config.highLightColor));return b},_getHighLightLineSymbol:function(){var a=E.fromJson({color:[0,
255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"});a.setColor(new C(this.config.highLightColor));return a},_getHighLightFillSymbol:function(){var a=E.fromJson(this.config.symbol),b=E.fromJson({color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"});b.setColor(new C(this.config.highLightColor));a.setOutline(b);return a},_zoomToGraphics:function(a){if(this.resultLayer&&this.resultLayer.visible&&a&&0<a.length){var b=null;try{var c=p.filter(a,function(a){return!!a.geometry});0<
c.length&&(b=$.graphicsExtent(c))}catch(e){console.error(e)}if(b)this.map.setExtent(b.expand(1.4));else if(a=(a=a[0])&&a.geometry)b=g.hitch(this,function(a){var b=this.map.getNumLevels(),c=this.map.getLevel(),b=Math.max(c,Math.floor(2*b/3));this.map.setLevel(b).then(g.hitch(this,function(){this.map.centerAt(a)}))}),"point"===a.type?b(a):"multipoint"===a.type&&1===a.points.length&&b(a.getPoint(0))}},_removeTempGraphics:function(){if(this.resultLayer&&this.tempGraphics&&0<this.tempGraphics.length)for(;0<
this.tempGraphics.length;)this.resultLayer.remove(this.tempGraphics[0]),this.tempGraphics.splice(0,1);this.tempGraphics=null},_mouseOverChartItem:function(a){this._removeTempGraphics();if(this.resultLayer&&this.resultLayer.visible){var b=t.getTypeByGeometryType(this.layerDefinition.geometryType),c=null;if("point"===b)c=this._getHighLightMarkerSymbol(),this.tempGraphics=[],p.forEach(a,g.hitch(this,function(a){a=new Z(a.geometry,c);this.tempGraphics.push(a);this.resultLayer.add(a)}));else if("polyline"===
b||"polygon"===b)c="polyline"===b?this._getHighLightLineSymbol():this._getHighLightFillSymbol(),p.forEach(a,g.hitch(this,function(a){a.setSymbol(c)})),this.featureSet.features.length!==a.length&&"polygon"===b&&(p.forEach(a,g.hitch(this,function(a){this.resultLayer.remove(a)})),p.forEach(a,g.hitch(this,function(a){this.resultLayer.add(a)})))}},_mouseOutChartItem:function(){this._removeTempGraphics();this.resultLayer&&p.forEach(this.resultLayer.graphics,g.hitch(this,function(a){a.setSymbol(null)}))},
_isNumber:function(a){return"[object number]"===Object.prototype.toString.call(a).toLowerCase()},_tryLocaleNumber:function(a,b){var c=a;if(N.isDefined(a)&&isFinite(a))try{var e;if(b&&this._isFloatNumberField(b)){var d=this.popupFieldInfosObj[b];e=d&&g.exists("format.places",d)?t.localizeNumberByFieldInfo(a,d):t.localizeNumber(a)}else e=t.localizeNumber(a);"string"===typeof e&&(c=e)}catch(q){console.error(q)}return c+""},_getBestDisplayValue:function(a,b){var c=this._tryLocaleNumber(b,a);if(this.layerDefinition.typeIdField===
a){var e=this.layerDefinition.types;if(e&&0<e.length&&(e=p.filter(e,g.hitch(this,function(a){return a.id===b})),0<e.length))return c=e[0].name}if((e=this._getFieldInfo(a))&&e.domain)(e=e.domain.codedValues)&&0<e.length&&p.some(e,function(a){return a.code===b?(c=a.name,!0):!1});return c},_getFieldAliasArray:function(a){return p.map(a,g.hitch(this,function(a){return this._getFieldAlias(a)}))},_getFieldAlias:function(a){var b=a;(a=this._getFieldInfo(a))&&(b=a.alias||b);return b},_getFieldInfo:function(a){if(this.layerDefinition)for(var b=
this.layerDefinition.fields,c=0;c<b.length;c++)if(b[c].name===a)return b[c];return null},_isNumberField:function(a){var b=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];return p.some(this.layerDefinition.fields,g.hitch(this,function(c){return c.name===a&&0<=b.indexOf(c.type)}))},_isFloatNumberField:function(a){var b=["esriFieldTypeSingle","esriFieldTypeDouble"];return p.some(this.layerDefinition.fields,g.hitch(this,function(c){return c.name===a&&0<=
b.indexOf(c.type)}))},_isDateField:function(a){return(a=this._getFieldInfo(a))?"esriFieldTypeDate"===a.type:!1},_getBestDecimalPlace:function(a){var b=0,c={};p.forEach(a,function(a){a=a.toString().split(".");var b=null;1===a.length?b=0:2===a.length&&(b=a[1].length);null!==b&&(c[b]=void 0===c[b]?1:c[b]+1)});a=null;for(var e in c){e=parseInt(e,10);var d=c[e];a?d>a.value&&(a={key:e,value:d}):a={key:e,value:d}}a&&(b=parseInt(a.key,10));return b},_getFloatNumberFieldDecimalPlace:function(a){var b=0;this.floatNumberFieldDecimalPlace&&
(a=this.floatNumberFieldDecimalPlace[a],"number"===typeof a&&(b=a));return b},_getBestValueForFloatNumberField:function(a,b){var c=this._getFloatNumberFieldDecimalPlace(b),c=a.toFixed(c);return parseFloat(c)},_getColors:function(a,b){var c=[],e=g.clone(a);if(2===e.colors.length)c=this._createGradientColors(e.colors[0],e.colors[e.colors.length-1],b);else{for(var d=Math.ceil(b/e.colors.length),q=0;q<d;q++)c=c.concat(e.colors);c=c.slice(0,b)}return c},_createPieTheme:function(a,b){var c=g.clone(a).colors,
e=[];if(2===c.length)e=this._createGradientColors(c[0],c[c.length-1],b);else if(b<=c.length)e=c;else{for(var d=p.map(c,function(a){return new C(a)}),q=0.5,l=1.5,n=0.1,c=Math.ceil(b/c.length),n=n*Math.floor(c/2),q=Math.max(1-n,q),l=Math.min(1+n,l),n=(l-q)/c,h=q,q=0;q<c;q++)p.forEach(d,g.hitch(this,function(a){var b=Math.min(Math.floor(a.r*h),255),c=Math.min(Math.floor(a.g*h),255);a=Math.min(Math.floor(a.b*h),255);var d=new C;d.r=b;d.g=c;d.b=a;b=d.toHex();e.push(b)})),h+=n;e=e.slice(0,b)}d={series:{stroke:{width:1.5,
color:"#fff"}},seriesThemes:p.map(e,g.hitch(this,function(a){return{fill:a}}))};return new M(d)},_createGradientColors:function(a,b,c){var e=[];a=new C(a);var d=new C(b);b=(d.r-a.r)/c;for(var g=(d.g-a.g)/c,d=(d.b-a.b)/c,l=new C,n=0,h=0,f=0,m=0;m<c;m++)n=parseInt(a.r+b*m,10),h=parseInt(a.g+g*m,10),f=parseInt(a.b+d*m,10),l.setColor([n,h,f]),e.push(l.toHex());return e},_getTypes:function(a){var b=[];a.column&&b.push("column");a.pie&&b.push("pie");a.bar&&b.push("bar");a.line&&b.push("line");return b},
_calculateHorizontalRotation:function(a,b){var c=r.getContentBox(a),e=0,d=0;p.forEach(b,g.hitch(this,function(a){d=Math.max(d,a.text.length)}));Math.floor((c.w-100)/b.length)<11.9*d&&(e=-45);return e},_createParamsDijit:function(a,b){return new aa({isInWidget:this.map?!0:!1,imagesUrl:this.folderUrl+"common/images",type:a,nls:this.nls,config:b})},_createColumnParamsDijit:function(a){return this._createParamsDijit("column",a.column)},_createBarParamsDijit:function(a){return this._createParamsDijit("bar",
a.bar)},_createLineParamsDijit:function(a){return this._createParamsDijit("line",a.line)},_createPieParamsDijit:function(a){return this._createParamsDijit("pie",a.pie)},_getRecreateChartFunction:function(a,b,c,e,d){return g.hitch(this,a,b,c,e,d)},_createFeatureModeCharts:function(a,b){var c=[],e=[],d=a.config,q=d.labelField,l=d.valueFields,n=this._getTypes(d),h="des"!==d.sortOrder,f=[],f=p.map(a.featureSet.features,g.hitch(this,function(a){var b=a.attributes;a={category:b[q],valueFields:[],dataFeatures:[a]};
a.valueFields=p.map(l,g.hitch(this,function(a){return b[a]}));return a}));h?f.sort(function(a,b){return a.category<b.category?-1:a.category>b.category?1:0}):f.sort(function(a,b){return a.category<b.category?1:a.category>b.category?-1:0});this._isDateField(q)&&0<f.length&&p.map(f,g.hitch(this,function(a){var b=a.category;"number"===typeof b&&0<b&&(a.category=t.localizeDate(new Date(b)))}));p.forEach(n,g.hitch(this,function(m,k){try{var s=b[k],l=null,B=null;"column"===m?(B=this._createColumnParamsDijit(d),
l=this._createFeatureModeColumnChart(a,s,f,B)):"bar"===m?(B=this._createBarParamsDijit(d),l=this._createFeatureModeBarChart(a,s,f,B)):"line"===m?(B=this._createLineParamsDijit(d),l=this._createFeatureModeLineChart(a,s,f,B)):"pie"===m&&(B=this._createPieParamsDijit(d),l=this._createFeatureModePieChart(a,s,f,B));e.push(B);c.push(l)}catch(h){console.error(h)}}));return{charts:c,paramsDijits:e}},_createFeatureModeColumnChart:function(a,b,c,e){return this._createCategoryModeColumnChart(a,b,c,e)},_createFeatureModeBarChart:function(a,
b,c,e){return this._createCategoryModeBarChart(a,b,c,e)},_createFeatureModeLineChart:function(a,b,c,e){return this._createCategoryModeLineChart(a,b,c,e)},_createFeatureModePieChart:function(a,b,c,e){return this._createCategoryModePieChart(a,b,c,e)},_createCategoryModeCharts:function(a,b){var c=[],e=[],d=a.config,q=d.categoryField,l=d.valueFields,n=this._getTypes(d),h="des"!==d.sortOrder,f=[],m=a.config.operation,k={};p.forEach(a.featureSet.features,g.hitch(this,function(a){var b=a.attributes[q],c=
null;k.hasOwnProperty(b)?(c=k[b],c.dataFeatures.push(a)):(c={dataFeatures:[a]},k[b]=c)}));var s=null,z;for(z in k)s=k[z],this._isNumberField(q)&&N.isDefined(z)&&(z=parseFloat(z)),s.valueFields=p.map(l,g.hitch(this,function(a){var b=p.map(s.dataFeatures,g.hitch(this,function(b){return b.attributes[a]})),c=0;"max"===m?c=-Infinity:"min"===m&&(c=Infinity);var d=0;p.forEach(b,g.hitch(this,function(a){this._isNumber(a)&&(d++,"average"===m||"sum"===m?c+=a:"max"===m?c=Math.max(c,a):"min"===m&&(c=Math.min(c,
a)))}));0<d?"average"===m&&(c/=d):c=0;return c})),f.push({category:z,valueFields:s.valueFields,dataFeatures:s.dataFeatures});h?f.sort(function(a,b){return a.category<b.category?-1:a.category>b.category?1:0}):f.sort(function(a,b){return a.category<b.category?1:a.category>b.category?-1:0});this._isDateField(q)&&0<f.length&&p.map(f,g.hitch(this,function(a){var b=a.category;b&&0<parseInt(b,10)&&(a.category=t.localizeDate(new Date))}));f=p.filter(f,g.hitch(this,function(a){var b=!1;a=a.category;"number"===
typeof a&&(b=isNaN(a));return!b}));("sum"===m||"average"===m)&&p.forEach(f,g.hitch(this,function(a){p.forEach(l,g.hitch(this,function(b,c){if(this._isFloatNumberField(b)){var d=a.valueFields[c],d=this._getBestValueForFloatNumberField(d,b);a.valueFields[c]=d}}))}));p.forEach(n,g.hitch(this,function(m,k){try{var l=b[k],s=null,h=null;"column"===m?(h=this._createColumnParamsDijit(d),s=this._createCategoryModeColumnChart(a,l,f,h)):"bar"===m?(h=this._createBarParamsDijit(d),s=this._createCategoryModeBarChart(a,
l,f,h)):"line"===m?(h=this._createLineParamsDijit(d),s=this._createCategoryModeLineChart(a,l,f,h)):"pie"===m&&(h=this._createPieParamsDijit(d),s=this._createCategoryModePieChart(a,l,f,h));e.push(h);c.push(s)}catch(g){console.error(g)}}));return{charts:c,paramsDijits:e}},_bindCategoryModeChartEvent:function(a,b){this.map&&a.connectToPlot("default",g.hitch(this,function(a){var e="onmouseout"===a.type,d="onclick"===a.type;if("onmouseover"===a.type||e||d)e=b[a.index].dataFeatures,"onmouseover"===a.type?
this._mouseOverChartItem(e):"onmouseout"===a.type?this._mouseOutChartItem(e):"onclick"===a.type&&this._zoomToGraphics(e)}))},_createCategoryModeColumnChart:function(a,b,c,e){for(var d=a.config,q=d.valueFields,l=this._getFieldAliasArray(q),n=d.labelField||d.categoryField,d=e.getConfig(),h=[],f=[],m=0;m<q.length;m++)f.push([]);p.forEach(c,g.hitch(this,function(a,b){var c=this._getBestDisplayValue(n,a.category);h.push({value:b+1,text:c});for(var d=0;d<a.valueFields.length;d++){var e=a.valueFields[d],
m=l[d],k=this.nls.category,g=this._getBestDisplayValue(q[d],e);f[d].push({y:e,tooltip:"\x3cdiv style\x3d'color:green;margin:5px 10px;'\x3e\x3cspan style\x3d'white-space:nowrap'\x3e"+k+" : "+c+"\x3c/span\x3e\x3cbr/\x3e\x3cbr/\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+m+" : "+g+"\x3c/span\x3e\x3c/div\x3e"})}}));if(this.isBigPreview&&0<h.length){var k=16.5*h.length+100;b.clientWidth<k&&(b.style.width=k+"px")}k=new w(b);k.setTheme(this._createTransparentTheme());k.addPlot("default",{type:X,enableCache:!0,
markers:!0,gap:10,minBarSize:2,maxBarSize:60});m=this._calculateHorizontalRotation(b,h);k.addAxis("x",{type:!1===d.horizontalAxis?v:u,natural:!0,labels:h,rotation:m,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});k.addAxis("y",{type:!1===d.verticalAxis?v:u,vertical:!0,natural:!0,includeZero:!0});d=this._getColors(d,f.length);for(m=0;m<f.length;m++)k.addSeries(q[m],f[m],{stroke:{color:d[m%d.length]},fill:d[m%d.length]});new A(k,"default");new y(k,"default");new x(k,"default");
k.render();this._bindCategoryModeChartEvent(k,c);k.createSelf=this._getRecreateChartFunction(this._createCategoryModeColumnChart,a,b,c,e);return k},_createCategoryModeBarChart:function(a,b,c,e){for(var d=a.config,q=d.valueFields,l=this._getFieldAliasArray(q),n=d.labelField||d.categoryField,d=e.getConfig(),h=[],f=[],m=0;m<q.length;m++)f.push([]);p.forEach(c,g.hitch(this,function(a,b){var c=this._getBestDisplayValue(n,a.category);h.push({value:b+1,text:c});for(var d=0;d<a.valueFields.length;d++){var e=
a.valueFields[d],m=l[d],k=this.nls.category,g=this._getBestDisplayValue(q[d],e);f[d].push({y:e,tooltip:"\x3cdiv style\x3d'color:green;margin:5px 10px;'\x3e\x3cspan style\x3d'white-space:nowrap'\x3e"+k+" : "+c+"\x3c/span\x3e\x3cbr/\x3e\x3cbr/\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+m+" : "+g+"\x3c/span\x3e\x3c/div\x3e"})}}));this.isBigPreview&&0<h.length&&(m=16.5*h.length,b.clientHeight<m&&(b.style.height=m+"px"));var k=new w(b);k.setTheme(this._createTransparentTheme());k.addPlot("default",
{type:Y,enableCache:!0,markers:!0,gap:10,minBarSize:2,maxBarSize:60});k.addAxis("x",{type:!1===d.verticalAxis?v:u,vertical:!0,natural:!0,labels:h,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});k.addAxis("y",{type:!1===d.horizontalAxis?v:u,natural:!0,includeZero:!0});d=this._getColors(d,f.length);for(m=0;m<f.length;m++)k.addSeries(q[m],f[m],{stroke:{color:d[m%d.length]},fill:d[m%d.length]});new A(k,"default");new y(k,"default");new x(k,"default");k.render();this._bindCategoryModeChartEvent(k,
c);k.createSelf=this._getRecreateChartFunction(this._createCategoryModeBarChart,a,b,c,e);return k},_createCategoryModeLineChart:function(a,b,c,e){for(var d=a.config,q=d.valueFields,l=this._getFieldAliasArray(q),n=d.labelField||d.categoryField,d=e.getConfig(),h=[],f=[],m=0;m<q.length;m++)f.push([]);p.forEach(c,g.hitch(this,function(a,b){var d=this._getBestDisplayValue(n,a.category);h.push({value:b+1,text:d});for(var c=0;c<a.valueFields.length;c++){var e=parseFloat(a.valueFields[c]),m=l[c],k=this.nls.category,
g=this._getBestDisplayValue(q[c],e),e=isNaN(e)?0:e;f[c].push({y:e,tooltip:"\x3cdiv style\x3d'color:green;margin:5px 10px;'\x3e\x3cspan style\x3d'white-space:nowrap'\x3e"+k+" : "+d+"\x3c/span\x3e\x3cbr/\x3e\x3cbr/\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+m+" : "+g+"\x3c/span\x3e\x3c/div\x3e"})}}));if(this.isBigPreview&&0<h.length){var k=16.5*h.length+100;b.clientWidth<k&&(b.style.width=k+"px")}k=new w(b);k.setTheme(this._createTransparentTheme());k.addPlot("default",{type:G,markers:!0,tension:"X"});
m=this._calculateHorizontalRotation(b,h);k.addAxis("x",{type:!1===d.horizontalAxis?v:u,natural:!0,includeZero:!0,labels:h,rotation:m,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});k.addAxis("y",{type:!1===d.verticalAxis?v:u,vertical:!0,natural:!0});d=this._getColors(d,f.length);for(m=0;m<f.length;m++)k.addSeries(q[m],f[m],{stroke:{color:d[m%d.length]},fill:d[m%d.length]});new I(k,"default");new y(k,"default");new x(k,"default");k.render();this._bindCategoryModeChartEvent(k,
c);k.createSelf=this._getRecreateChartFunction(this._createCategoryModeLineChart,a,b,c,e);return k},_createCategoryModePieChart:function(a,b,c,e){var d=a.config,q=d.valueFields,l=this._getFieldAliasArray(q),n=d.labelField||d.categoryField,d=e.getConfig(),h=r.getContentBox(b),f=Math.floor(Math.min(h.w,h.h)/2/this.pieScale)-3,m=[],k=[],s=[];p.forEach(q,g.hitch(this,function(a,b){k.push([]);var d=0;p.forEach(c,g.hitch(this,function(a){d+=Math.abs(a.valueFields[b])}));s.push(d)}));p.forEach(c,g.hitch(this,
function(a,b){var d=this._getBestDisplayValue(n,a.category);m.push({value:b+1,text:d});for(var c=0;c<a.valueFields.length;c++){var e=a.valueFields[c],f=q[c],h=l[c],g=this._tryLocaleNumber((100*(e/s[c])).toFixed(1))+"%",p=this.nls.category,f=this._getBestDisplayValue(f,e);k[c].push({y:Math.abs(e),text:d,tooltip:"\x3cdiv style\x3d'color:green;margin:5px 10px;'\x3e\x3cspan style\x3d'white-space:nowrap'\x3e"+p+" : "+d+"\x3c/span\x3e\x3cbr/\x3e\x3cbr/\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+h+
" : "+f+"\x3c/span\x3e\x3cbr/\x3e\x3cbr/\x3e\x3cspan style\x3d'white-space:nowrap'\x3e"+g+"\x3c/span\x3e\x3c/div\x3e"})}}));var h=new w(b),z=this._createPieTheme(d,c.length);z.plotarea.fill="transparent";z.chart.fill="transparent";h.setTheme(z);h.addPlot("default",{type:H,radius:f,labels:!!d.label});for(d=0;d<k.length;d++)h.addSeries(q[d],k[d]);new A(h,"default");new y(h,"default");new x(h,"default");h.render();this._bindCategoryModeChartEvent(h,c);h.createSelf=this._getRecreateChartFunction(this._createCategoryModePieChart,
a,b,c,e);return h},_createCountModeCharts:function(a,b){var c=[],e=[],d=a.config,q=this._getTypes(d),l=d.categoryField,n="des"!==d.sortOrder,h={};p.forEach(a.featureSet.features,g.hitch(this,function(a){var b=a.attributes[l],c=null;h.hasOwnProperty(b)?(c=h[b],c.count++,c.dataFeatures.push(a)):(c={count:1,dataFeatures:[a]},h[b]=c)}));var f=[],m=null,k;for(k in h)m=h[k],this._isNumberField(l)&&(k=parseFloat(k)),f.push({fieldValue:k,count:m.count,dataFeatures:m.dataFeatures});n?f.sort(function(a,b){return a.fieldValue<
b.fieldValue?-1:a.fieldValue>b.fieldValue?1:0}):f.sort(function(a,b){return a.fieldValue<b.fieldValue?1:a.fieldValue>b.fieldValue?-1:0});this._isDateField(l)&&0<f.length&&p.forEach(f,g.hitch(this,function(a){if(a.fieldValue){var b=parseInt(a.fieldValue,10);0<b&&(a.fieldValue=t.localizeDate(new Date(b)))}}));p.forEach(q,g.hitch(this,function(m,k){try{var l=b[k],h=null,g=null;"column"===m?(g=this._createColumnParamsDijit(d),h=this._createCountModeColumnChart(a,l,f,g)):"bar"===m?(g=this._createBarParamsDijit(d),
h=this._createCountModeBarChart(a,l,f,g)):"line"===m?(g=this._createLineParamsDijit(d),h=this._createCountModeLineChart(a,l,f,g)):"pie"===m&&(g=this._createPieParamsDijit(d),h=this._createCountModePieChart(a,l,f,g));e.push(g);c.push(h)}catch(n){console.error(n)}}));return{charts:c,paramsDijits:e}},_bindCountModeChartEvent:function(a,b){this.map&&a.connectToPlot("default",g.hitch(this,function(a){var e="onmouseout"===a.type,d="onclick"===a.type;if("onmouseover"===a.type||e||d)e=b[a.index].dataFeatures,
"onmouseover"===a.type?this._mouseOverChartItem(e):"onmouseout"===a.type?this._mouseOutChartItem(e):"onclick"===a.type&&this._zoomToGraphics(e)}))},_createCountModeColumnChart:function(a,b,c,e){var d=a.config.categoryField,q=this._getFieldAlias(d),l=e.getConfig(),n=[],h=[];p.forEach(c,g.hitch(this,function(a,b){var c=a.count,e=a.fieldValue,f=t.localizeNumber(c),e=this._getBestDisplayValue(d,e);n.push({value:b+1,text:e});h.push({y:c,tooltip:"\x3cdiv style\x3d'color:green;margin:5px 10px;'\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+
q+" : "+e+"\x3c/span\x3e\x3cbr/\x3e\x3cbr/\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+this.nls.count+" : "+f+"\x3c/span\x3e\x3c/div\x3e"})}));if(this.isBigPreview&&0<n.length){var f=16.5*n.length+100;b.clientWidth<f&&(b.style.width=f+"px")}f=new w(b);f.setTheme(this._createTransparentTheme());f.addPlot("default",{type:K,enableCache:!0,markers:!0,gap:10,minBarSize:2,maxBarSize:60});var m=this._calculateHorizontalRotation(b,n);f.addAxis("x",{type:!1===l.horizontalAxis?v:u,natural:!0,labels:n,rotation:m,
fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});f.addAxis("y",{type:!1===l.verticalAxis?v:u,vertical:!0,includeZero:!0,natural:!0});l=this._getColors(l,1);f.addSeries("default",h,{stroke:{color:l[0]},fill:l[0]});new A(f,"default");new y(f,"default");new x(f,"default");f.render();this._bindCountModeChartEvent(f,c);f.createSelf=this._getRecreateChartFunction(this._createCountModeColumnChart,a,b,c,e);return f},_createCountModeBarChart:function(a,b,c,e){var d=a.config.categoryField,
q=this._getFieldAlias(d),l=e.getConfig(),n=[],h=[];p.forEach(c,g.hitch(this,function(a,b){var c=a.count,e=a.fieldValue,f=t.localizeNumber(c),e=this._getBestDisplayValue(d,e);n.push({value:b+1,text:e});h.push({y:c,tooltip:"\x3cdiv style\x3d'color:green;margin:5px 10px;'\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+q+" : "+e+"\x3c/span\x3e\x3cbr/\x3e\x3cbr/\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+this.nls.count+" : "+f+"\x3c/span\x3e\x3c/div\x3e"})}));if(this.isBigPreview&&0<n.length){var f=
16.5*n.length;b.clientHeight<f&&(b.style.height=f+"px")}f=new w(b);f.setTheme(this._createTransparentTheme());f.addPlot("default",{type:L,enableCache:!0,markers:!0,gap:10,minBarSize:2,maxBarSize:60});f.addAxis("x",{type:!1===l.verticalAxis?v:u,vertical:!0,natural:!0,labels:n,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});f.addAxis("y",{type:!1===l.horizontalAxis?v:u,includeZero:!0,natural:!0});l=this._getColors(l,1);f.addSeries("default",h,{stroke:{color:l[0]},fill:l[0]});
new A(f,"default");new y(f,"default");new x(f,"default");f.render();this._bindCountModeChartEvent(f,c);f.createSelf=this._getRecreateChartFunction(this._createCountModeBarChart,a,b,c,e);return f},_createCountModeLineChart:function(a,b,c,e){var d=a.config.categoryField,q=this._getFieldAlias(d),l=e.getConfig(),n=[],h=[];p.forEach(c,g.hitch(this,function(a,b){var c=a.count,e=a.fieldValue,f=t.localizeNumber(c),e=this._getBestDisplayValue(d,e);n.push({value:b+1,text:e});h.push({y:c,text:"",tooltip:"\x3cdiv style\x3d'color:green;margin:5px 10px;'\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+
q+" : "+e+"\x3c/span\x3e\x3cbr/\x3e\x3cbr/\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+this.nls.count+" : "+f+"\x3c/span\x3e\x3c/div\x3e"})}));if(this.isBigPreview&&0<n.length){var f=16.5*n.length+100;b.clientWidth<f&&(b.style.width=f+"px")}f=new w(b);f.setTheme(this._createTransparentTheme());f.addPlot("default",{type:G,markers:!0,tension:"X"});var m=this._calculateHorizontalRotation(b,n);f.addAxis("x",{type:!1===l.horizontalAxis?v:u,natural:!0,includeZero:!0,labels:n,rotation:m,fontColor:this.fontColor,
majorLabels:!0,minorLabels:!0,majorTickStep:1});f.addAxis("y",{type:!1===l.verticalAxis?v:u,vertical:!0,natural:!0});l=this._getColors(l,1);f.addSeries("default",h,{stroke:{color:l[0]},fill:l[0]});new I(f,"default");new y(f,"default");new x(f,"default");f.render();this._bindCountModeChartEvent(f,c);f.createSelf=this._getRecreateChartFunction(this._createCountModeLineChart,a,b,c,e);return f},_createCountModePieChart:function(a,b,c,e){var d=a.config.categoryField,q=this._getFieldAlias(d),l=e.getConfig(),
n=r.getContentBox(b),n=Math.floor(Math.min(n.w,n.h)/2/this.pieScale)-3,h=[],f=[],m=0;p.forEach(c,g.hitch(this,function(a){m+=a.count}));p.forEach(c,g.hitch(this,function(a,b){var c=a.count,e=this._getBestDisplayValue(d,a.fieldValue),k=this._tryLocaleNumber((100*(c/m)).toFixed(1))+"%",l=t.localizeNumber(c),g=this.nls.count;h.push({value:b+1,text:e});f.push({text:e,y:c,tooltip:"\x3cdiv style\x3d'color:green;margin:5px 10px;'\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+q+" : "+e+"\x3c/span\x3e\x3cbr/\x3e\x3cbr/\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+
g+" : "+l+"\x3c/span\x3e\x3cbr/\x3e\x3cbr/\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+k+"\x3c/span\x3e\x3c/div\x3e"})}));var k=new w(b),s=this._createPieTheme(l,c.length);s.plotarea.fill="transparent";s.chart.fill="transparent";k.setTheme(s);k.addPlot("default",{type:H,radius:n,labels:!!l.label});k.addSeries("default",f);new A(k,"default");new y(k,"default");new x(k,"default");k.render();this._bindCountModeChartEvent(k,c);k.createSelf=this._getRecreateChartFunction(this._createCountModePieChart,
a,b,c,e);return k},_createFieldModeCharts:function(a,b){var c=[],e=[],d=a.config,q=this._getTypes(d),l=d.valueFields,n=d.operation,h=p.map(a.featureSet.features,g.hitch(this,function(a){return a.attributes})),f={};p.forEach(l,g.hitch(this,function(a){f[a]=0;"max"===n?f[a]=-Infinity:"min"===n&&(f[a]=Infinity);var b=0;p.forEach(h,g.hitch(this,function(c){c=c[a];this._isNumber(c)&&(b++,f.hasOwnProperty(a)?"average"===n||"sum"===n?f[a]+=c:"max"===n?f[a]=Math.max(f[a],c):"min"===n&&(f[a]=Math.min(f[a],
c)):f[a]=c)}));0<b?"average"===n&&(f[a]/=b):f[a]=0}));("sum"===n||"average"===n)&&p.forEach(l,g.hitch(this,function(a){f.hasOwnProperty(a)&&this._isFloatNumberField(a)&&(f[a]=this._getBestValueForFloatNumberField(f[a],a))}));p.forEach(q,g.hitch(this,function(m,k){try{var l=b[k],g=null,h=null;"column"===m?(h=this._createColumnParamsDijit(d),g=this._createFieldModeColumnChart(a,l,f,h)):"bar"===m?(h=this._createBarParamsDijit(d),g=this._createFieldModeBarChart(a,l,f,h)):"line"===m?(h=this._createLineParamsDijit(d),
g=this._createFieldModeLineChart(a,l,f,h)):"pie"===m&&(h=this._createPieParamsDijit(d),g=this._createFieldModePieChart(a,l,f,h));e.push(h);c.push(g)}catch(n){console.error(n)}}));return{charts:c,paramsDijits:e}},_bindFieldModeChartEvent:function(a){this.map&&a.connectToPlot("default",g.hitch(this,function(a){var c="onmouseout"===a.type,e="onclick"===a.type;if("onmouseover"===a.type||c||e)c=this.featureSet&&this.featureSet.features,"onmouseover"===a.type?this._mouseOverChartItem(c):"onmouseout"===
a.type?this._mouseOutChartItem(c):"onclick"===a.type&&this._zoomToGraphics(c)}))},_createFieldModeColumnChart:function(a,b,c,e){var d=a.config.valueFields,q=this._getFieldAliasArray(d),l=e.getConfig(),n=[],h=[];p.forEach(d,g.hitch(this,function(a,b){var d=q[b],e=c[a],f=t.localizeNumber(e);n.push({value:b+1,text:d});h.push({y:e,tooltip:"\x3cdiv style\x3d'color:green;margin:5px 10px;'\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+d+" : "+f+"\x3c/span\x3e\x3c/div\x3e"})}));d=new w(b);d.setTheme(this._createTransparentTheme());
d.addPlot("default",{type:K,enableCache:!0,markers:!0,gap:10,minBarSize:2,maxBarSize:60});var f=this._calculateHorizontalRotation(b,n);d.addAxis("x",{type:!1===l.horizontalAxis?v:u,natural:!0,labels:n,rotation:f,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});d.addAxis("y",{type:!1===l.verticalAxis?v:u,vertical:!0,includeZero:!0,natural:!0});l=this._getColors(l,1);d.addSeries("default",h,{stroke:{color:l[0]},fill:l[0]});new A(d,"default");new y(d,"default");new x(d,"default");
d.render();this._bindFieldModeChartEvent(d);d.createSelf=this._getRecreateChartFunction(this._createFieldModeColumnChart,a,b,c,e);return d},_createFieldModeBarChart:function(a,b,c,e){var d=a.config.valueFields,q=this._getFieldAliasArray(d),l=e.getConfig(),n=[],h=[];p.forEach(d,g.hitch(this,function(a,b){var d=q[b],e=c[a],g=t.localizeNumber(e);n.push({value:b+1,text:d});h.push({y:e,tooltip:"\x3cdiv style\x3d'color:green;margin:5px 10px;'\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+d+" : "+g+"\x3c/span\x3e\x3c/div\x3e"})}));
d=new w(b);d.setTheme(this._createTransparentTheme());d.addPlot("default",{type:L,enableCache:!0,markers:!0,gap:10,minBarSize:2,maxBarSize:60});d.addAxis("x",{type:!1===l.verticalAxis?v:u,vertical:!0,natural:!0,labels:n,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});d.addAxis("y",{type:!1===l.horizontalAxis?v:u,includeZero:!0,natural:!0});l=this._getColors(l,1);d.addSeries("default",h,{stroke:{color:l[0]},fill:l[0]});new A(d,"default");new y(d,"default");new x(d,"default");
d.render();this._bindFieldModeChartEvent(d);d.createSelf=this._getRecreateChartFunction(this._createFieldModeBarChart,a,b,c,e);return d},_createFieldModeLineChart:function(a,b,c,e){var d=a.config.valueFields,q=this._getFieldAliasArray(d),l=e.getConfig(),n=[],h=[];p.forEach(d,g.hitch(this,function(a,b){var d=q[b],e=c[a],f=t.localizeNumber(e);n.push({value:b+1,text:d});h.push({y:e,tooltip:"\x3cdiv style\x3d'color:green;margin:5px 10px;'\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+d+" : "+f+"\x3c/span\x3e\x3c/div\x3e"})}));
d=new w(b);d.setTheme(this._createTransparentTheme());d.addPlot("default",{type:G,markers:!0,tension:"X"});var f=this._calculateHorizontalRotation(b,n);d.addAxis("x",{type:!1===l.horizontalAxis?v:u,natural:!0,includeZero:!0,labels:n,rotation:f,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});d.addAxis("y",{type:!1===l.verticalAxis?v:u,vertical:!0,natural:!0});l=this._getColors(l,1);d.addSeries("default",h,{stroke:{color:l[0]},fill:l[0]});new I(d,"default");new y(d,"default");
new x(d,"default");d.render();this._bindFieldModeChartEvent(d);d.createSelf=this._getRecreateChartFunction(this._createFieldModeLineChart,a,b,c,e);return d},_createFieldModePieChart:function(a,b,c,e){var d=a.config.valueFields,q=this._getFieldAliasArray(d),l=e.getConfig(),n=r.getContentBox(b),n=Math.floor(Math.min(n.w,n.h)/2/this.pieScale)-3,h=[],f=[],m=0,k;for(k in c)m+=Math.abs(c[k]);p.forEach(d,g.hitch(this,function(a,b){var d=q[b],e=c[a],g=this._tryLocaleNumber((100*(e/m)).toFixed(1))+"%",k=t.localizeNumber(e);
h.push({value:b+1,text:d});f.push({text:d,y:Math.abs(e),tooltip:"\x3cdiv style\x3d'color:green;margin:5px 10px;'\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+d+" : "+k+"\x3c/span\x3e\x3cbr/\x3e\x3cbr/\x3e\x3cspan style\x3d'white-space:nowrap;'\x3e"+g+"\x3c/span\x3e\x3c/div\x3e"})}));k=new w(b);d=this._createPieTheme(l,d.length);d.plotarea.fill="transparent";d.chart.fill="transparent";k.setTheme(d);k.addPlot("default",{type:H,radius:n,labels:!!l.label});k.addSeries("default",f);new A(k,"default");
new y(k,"default");new x(k,"default");k.render();this._bindFieldModeChartEvent(k);k.createSelf=this._getRecreateChartFunction(this._createFieldModePieChart,a,b,c,e);return k},_createTransparentTheme:function(){return new M({plotarea:{fill:"transparent"},chart:{fill:"transparent"}})}})});