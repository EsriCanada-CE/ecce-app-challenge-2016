// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/InfoSummary/setting/MySymbolPicker":function(){define("dojo/_base/declare dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/dom-style dojo/dom-construct dojo/on dojox/gfx esri/symbols/jsonUtils esri/request jimu/dijit/SymbolPicker jimu/BaseWidget jimu/utils esri/symbols/PictureMarkerSymbol dojo/text!./MySymbolPicker.html dojo/Evented jimu/dijit/SimpleTable".split(" "),function(m,t,u,p,q,r,v,w,s,B,z,x,A,y,b,e){return m([x,t,e],{templateString:b,baseClass:"jimu-widget-InfoSummary-setting",
nls:null,row:null,layerInfo:null,clusteringEnabled:null,symbolInfo:null,symbolType:"",map:null,supportsDynamic:!0,constructor:function(a){this.nls=a.nls;this.row=a.callerRow;this.layerInfo=a.layerInfo;this.renderer=a.layerInfo.renderer;this.geometryType=a.layerInfo.geometryType;this.symbolInfo=a.symbolInfo;this.map=a.map;this.ac=a.ac;this.layerId=a.value;this.supportsDynamic=a.layerInfo.supportsDynamic},postCreate:function(){this.inherited(arguments);var a=A.getTypeByGeometryType(this.geometryType);
this._loadLayerSymbol();this.supportsDynamic&&this._initSymbolPicker(a);this._initClusterSymbolPicker(a);this._addEventHandlers(a);this._initUI()},_initUI:function(){if("undefined"!==typeof this.symbolInfo){this.symbolType=this.symbolInfo.symbolType;this.clusterType=this.symbolInfo.clusterType;this.iconType=this.symbolInfo.iconType;this.clusteringEnabled=this.symbolInfo.clusteringEnabled;this.userDefinedSymbol=this.symbolInfo.userDefinedSymbol;switch(this.symbolInfo.symbolType){case "LayerSymbol":this.rdoLayerSym.set("checked",
!0);this._rdoEsriSymChanged(!1);this._rdoCustomSymChanged(!1);break;case "EsriSymbol":this.userDefinedSymbol=!0;this.rdoEsriSym.set("checked",!0);this._rdoLayerSymChanged(!1);this._rdoCustomSymChanged(!1);this.symbolPicker.showBySymbol(s.fromJson(this.symbolInfo.symbol));break;case "CustomSymbol":this.userDefinedSymbol=!0,this.rdoCustomSym.set("checked",!0),this._rdoEsriSymChanged(!1),this._rdoLayerSymChanged(!1),this._createImageDataDiv(this.symbolInfo.symbol,!0,this.customSymbolPlaceholder)}switch(this.symbolInfo.clusterType){case "ThemeCluster":this.userDefinedSymbol=
!0;this.rdoThemeCluster.set("checked",!0);this.clusterType="ThemeCluster";break;case "CustomCluster":this.userDefinedSymbol=!0,this.rdoCustomCluster.set("checked",!0),this.clusterType="CustomCluster"}switch(this.symbolInfo.iconType){case "LayerIcon":this.rdoLayerIcon.set("checked",!0);break;case "CustomIcon":this.userDefinedSymbol=!0,this.rdoCustomIcon.set("checked",!0),this.symbolInfo.icon&&this.resetIcon(this.symbolInfo.icon)}"undefined"!==typeof this.symbolInfo.clusterType&&("CustomCluster"===
this.symbolInfo.clusterType?(this.rdoCustomCluster.set("checked",!0),this.symbolInfo.clusterSymbol&&this.clusterPicker.showBySymbol(s.fromJson(this.symbolInfo.clusterSymbol))):this.rdoThemeCluster.set("checked",!0),this.userDefinedSymbol=!0);this.chkClusterSym.set("checked",this.symbolInfo.clusteringEnabled);this._chkClusterChanged(this.symbolInfo.clusteringEnabled)}else this.rdoLayerSym.set("checked",!0),this._rdoEsriSymChanged(!1),this._rdoCustomSymChanged(!1),this.chkClusterSym.set("checked",!1),
this.rdoCustomCluster.set("checked",!0),this.rdoLayerIcon.set("checked",!0),this._rdoCustomIconChanged(!1),this.symbolType="LayerSymbol",this.iconType="LayerIcon",this.userDefinedSymbol=this.clusteringEnabled=!1;if("esriGeometryPoint"!==this.geometryType||!this.supportsDynamic)q.set(this.parent_div_uploadCustomSymbol,"display","none"),this.supportsDynamic||q.set(this.div_rdoEsriSym,"display","none")},resetIcon:function(a){this.customIconPlaceholder.innerHTML="\x3cdiv\x3e\x3c/div\x3e";a=r.create("div",
{"class":"customPlaceholder",innerHTML:[a],title:this.nls.editCustomIcon});this.customIconPlaceholder.innerHTML=a.innerHTML},loadFunc:function(a){q.set(this.symbolPreview,"background-image","url("+a.href+")");q.set(this.symbolPreview,"background-repeat","no-repeat")},errorFunc:function(a){console.log("Error: ",a.message)},_addEventHandlers:function(a){"point"===a&&this.own(v(this.uploadCustomSymbol,"click",u.hitch(this,function(){this._editIcon("Symbol")})));this.own(v(this.uploadCustomIcon,"click",
u.hitch(this,function(){this._editIcon("Icon")})));this.own(v(this.btnOk,"click",u.hitch(this,function(){this._setSymbol();this.emit("ok",this.symbolInfo)})));this.own(v(this.btnCancel,"click",u.hitch(this,function(){this.emit("cancel")})))},_setSymbol:function(){var a;switch(this.symbolType){case "LayerSymbol":a=this.symbol;break;case "EsriSymbol":this.userDefinedSymbol=!0;a=this.symbolPicker.getSymbol();break;case "CustomSymbol":this.userDefinedSymbol=!0,0<this.customSymbolPlaceholder.children.length&&
(a="undefined"!==typeof this.customSymbolPlaceholder.children[0].src?new y(this.customSymbolPlaceholder.children[0].src,30,30):s.fromJson(this.symbolInfo.symbol))}var f;"LayerIcon"===this.iconType?f=a:0<this.customIconPlaceholder.children.length&&(f="undefined"!==typeof this.customIconPlaceholder.innerHTML?this.customIconPlaceholder.innerHTML:s.fromJson(this.symbolInfo.icon));this.clusteringEnabled&&"esriGeometryPoint"===this.geometryType?(this.clusterSymbol="ThemeCluster"===this.clusterType?"custom":
this.clusterPicker.getSymbol().toJson(),this.userDefinedSymbol=!0):(this.clusterSymbol=void 0,this.clusteringEnabled=!1);a&&"undefined"!==typeof a.toJson&&(a=a.toJson());this.symbolInfo={symbolType:this.symbolType,symbol:a,clusterSymbol:this.clusterSymbol,clusteringEnabled:this.clusteringEnabled,icon:f,clusterType:this.clusterType,iconType:this.iconType,renderer:this.renderer,s:0<this.customIconPlaceholder.children.length?this.customIconPlaceholder.children[0].src:0<this.layerSym.children.length?
this.layerSym.children[0].innerHTML:this.customIconPlaceholder.outerHTML,userDefinedSymbol:this.userDefinedSymbol?this.userDefinedSymbol:!1,layerId:this.layerId}},_rdoLayerSymChanged:function(a){a&&(this.symbolType="LayerSymbol");p.setStyle(this.layerSym,"display",a?"block":"none")},_rdoEsriSymChanged:function(a){a&&(this.symbolType="EsriSymbol");p.setStyle(this.symbolPicker.domNode,"display",a?"block":"none")},_rdoCustomSymChanged:function(a){a&&(this.symbolType="CustomSymbol");p.setStyle(this.uploadCustomSymbol,
"display",a?"block":"none");p.setStyle(this.customSymbolPlaceholder,"display",a?"block":"none")},_chkClusterChanged:function(a){this.clusteringEnabled=a;p.setStyle(this.grpClusterOptions,"display",a?"block":"none");p.setStyle(this.grpThemeClusterOptions,"display",a?"block":"none");a&&"undefined"===typeof this.clusterType&&(this.clusterType="CustomCluster",this.rdoCustomCluster.set("checked",!0))},_rdoThemeClusterChanged:function(a){a&&(this.clusterType="ThemeCluster")},_rdoCustomClusterChanged:function(a){a&&
(this.clusterType="CustomCluster")},_rdoLayerIconChanged:function(a){a&&(this.iconType="LayerIcon");p.setStyle(this.uploadCustomIcon,"display",!a?"block":"none");p.setStyle(this.customIconPlaceholder,"display",!a?"block":"none")},_rdoCustomIconChanged:function(a){a&&(this.iconType="CustomIcon");p.setStyle(this.uploadCustomIcon,"display",a?"block":"none");p.setStyle(this.customIconPlaceholder,"display",a?"block":"none")},_initSymbolPicker:function(a){var f="";"point"===a?f="marker":"polyline"===a?
f="line":"polygon"===a&&(f="fill");this.symbolPicker.showByType(f)},_initClusterSymbolPicker:function(a){"point"===a&&this.clusterPicker.showByType("fill");q.set(this.parent_div_clusterOptions,"display","point"===a?"block":"none")},_loadLayerSymbol:function(){if("undefined"!==typeof this.renderer){var a=this.renderer;"undefined"!==typeof a.symbol?this._createImageDataDiv(a.symbol,!0,this.layerSym):"undefined"!==typeof a.infos?this.layerSym.innerHTML=this._createCombinedImageDataDiv(a.infos,!1).innerHTML:
"undefined"!==typeof a.uniqueValueInfos?this.layerSym.innerHTML=this._createCombinedImageDataDiv(a.uniqueValueInfos,!0).innerHTML:"undefined"!==typeof a.classBreakInfos&&(this.layerSym.innerHTML=this._createCombinedImageDataDiv(a.classBreakInfos,!0).innerHTML)}},_createImageDataDiv:function(a,f,e){e=r.create("div",{"class":"imageDataGFX"},e);(f=f?s.fromJson(a):a)||(f=a);this.symbol=f;var l=a=26;f.height&&f.width&&f.height>f.width&&(l=f.width/f.height,a=26,l*=26);var h=w.createSurface(e,l,a);f=s.getShapeDescriptors(this.setSym(f,
l,a));h.createShape(f.defaultShape).setFill(f.fill).setStroke(f.stroke).applyTransform({dx:l/2,dy:a/2});return e},_createCombinedImageDataDiv:function(a){for(var f=r.create("div",{"class":"imageDataGFXMulti"},this.customSymbolPlaceholder),e=0;e<a.length;e++){var l=a[e].symbol,h=s.fromJson(l);h||(h=l);"undefined"===typeof this.symbol&&(this.symbol=h);var b=l=26;h.height&&h.width&&h.height>h.width&&(b=h.width/h.height,l=26,b*=26);var m=r.create("div",{"class":"imageDataGFX imageDataGFX2"},f),p=w.createSurface(m,
b,l),h=s.getShapeDescriptors(this.setSym(h,b,l));p.createShape(h.defaultShape).setFill(h.fill).setStroke(h.stroke).applyTransform({dx:b/2,dy:l/2});f.insertBefore(m,f.firstChild);f.appendChild(m)}return f},setSym:function(a,f,e){"undefined"!==typeof a.setWidth?("esriGeometryPoint"===this.geometryType&&a.setWidth(f),"undefined"!==typeof a.setHeight&&a.setHeight(e)):("undefined"!==typeof a.size&&20<a.size&&a.setSize(20),"undefined"!==typeof a.width&&(a.width=f),"undefined"!==typeof a.height&&(a.height=
e));return a},_editIcon:function(a){var e=new FileReader;e.onload=u.hitch(this,function(){var b,l;"Symbol"===a?(b=this.customSymbolPlaceholder,l=this.nls.editCustomSymbol):(b=this.customIconPlaceholder,l=this.nls.editCustomIcon);b.innerHTML="\x3cdiv\x3e\x3c/div\x3e";l=r.create("div",{"class":"customPlaceholder",innerHTML:['\x3cimg class\x3d"customPlaceholder" src\x3d"',e.result,'"/\x3e'].join(""),title:l});b.innerHTML=l.innerHTML});this.fileInput.onchange=u.hitch(this,function(){e.readAsDataURL(this.fileInput.files[0])});
this.fileInput.click()},destroy:function(){this.symbolInfo=null}})})},"jimu/dijit/SymbolPicker":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dijit/TooltipDialog dijit/popup dijit/registry jimu/dijit/SymbolChooser jimu/symbolUtils".split(" "),function(m,t,u,p,q,r,v,w,s,B,z,x,A,y){return m([t,u,p],{baseClass:"jimu-symbol-picker",declaredClass:"jimu.dijit.SymbolPicker",templateString:"\x3cdiv\x3e\x3c/div\x3e",
tooltipDialog:null,_isTooltipDialogOpened:!1,symbol:null,type:null,postCreate:function(){this.inherited(arguments);this._createTooltipDialog();this._hideTooltipDialog();var b=this.symbolChooser.getSymbol();b&&this._drawSymbol(b)},destroy:function(){this._hideTooltipDialog();this.symbolChooser&&this.symbolChooser.destroy();this.symbolChooser=null;this.inherited(arguments)},_createTooltipDialog:function(){var b=r.create("div");this.tooltipDialog=new B({content:b});this.symbolChooser=new A({symbol:this.symbol,
type:this.type});this.symbolChooser.placeAt(b);this.symbolChooser.startup();this.own(w(this.symbolChooser,"change",q.hitch(this,function(e){this._drawSymbol(e);this.emit("change",e)})));this.own(w(this.domNode,"click",q.hitch(this,function(e){e.stopPropagation();e.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(w(document.body,"click",q.hitch(this,function(e){var a=e.target||e.srcElement;e=this._getColorPickers();0<e.length&&v.some(e,function(e){return e.isPartOfPopup(a)})||
(e=this.tooltipDialog.domNode,a===e||r.isDescendant(a,e)||this._hideTooltipDialog())})));this.own(w(this.symbolChooser,"resize",q.hitch(this,function(){this._isTooltipDialogOpened&&(this._hideTooltipDialog(),this._showTooltipDialog())})))},_getColorPickers:function(){var b=s(".jimu-color-picker",this.symbolChooser.domNode);return v.map(b,q.hitch(this,function(e){return x.byNode(e)}))},reset:function(){this.symbol=this.type=null;r.empty(this.domNode);this.symbolChooser.reset()},showBySymbol:function(b){this.reset();
b&&(this._drawSymbol(b),this.symbolChooser.showBySymbol(b))},showByType:function(b){this.reset();this.symbolChooser.showByType(b);(b=this.symbolChooser.getSymbol())&&this._drawSymbol(b)},getSymbol:function(){return this.symbolChooser.getSymbol()},_drawSymbol:function(b){r.empty(this.domNode);b&&(b=y.createSymbolNode(b))&&r.place(b,this.domNode)},_showTooltipDialog:function(){this.tooltipDialog&&(z.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode}),this._isTooltipDialogOpened=
!0)},_hideTooltipDialog:function(){this.tooltipDialog&&(z.close(this.tooltipDialog),this._isTooltipDialogOpened=!1)}})})},"widgets/InfoSummary/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/InfoSummary/setting/MySymbolPicker.html":'\x3cdiv class\x3d"symbolPickerContainer"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"div_symbolOptionsContainer" class\x3d"symbolOptionsContainer"\x3e\r\n    \x3cdiv class\x3d"label symbolOptionText"\x3e\r\n      ${nls.symbolOptionsText}\r\n    \x3c/div\x3e\r\n    \x3chr /\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"div_symbolOptions" class\x3d"symbolOptions"\x3e\r\n      \x3c!--Symbol Options--\x3e\r\n      \x3cdiv class\x3d"jimu-r-row padTop10"\r\n           data-dojo-attach-point\x3d"grpSymbolOptions"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"div_rdoLayerSym" class\x3d"height30"\x3e\r\n          \x3cinput name\x3d"a" data-dojo-type\x3d"dijit/form/RadioButton"\r\n                 data-dojo-attach-point\x3d"rdoLayerSym"\r\n                 data-dojo-attach-event\x3d"onChange:_rdoLayerSymChanged"\r\n                 title\x3d"${nls.rdoLayer}" /\x3e\r\n          \x3cspan class\x3d"label"\x3e${nls.rdoLayer}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-r-row symPick" data-dojo-attach-point\x3d"layerSym"\x3e \x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpSymbolOptions"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"div_rdoEsriSym" class\x3d"height30"\x3e\r\n          \x3cinput name\x3d"a" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"rdoEsriSym" data-dojo-attach-event\x3d"onChange:_rdoEsriSymChanged" title\x3d"${nls.rdoEsri}" /\x3e\r\n          \x3cspan class\x3d"label"\x3e${nls.rdoEsri}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"symbolPicker" data-dojo-type\x3d"jimu/dijit/SymbolPicker" class\x3d"jimu-r-row symPick"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"parent_div_uploadCustomSymbol"\x3e\r\n        \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpSymbolOptions"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"div_rdoCustomSym" class\x3d"rdoCustomSym"\x3e\r\n            \x3cinput name\x3d"a" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"rdoCustomSym" data-dojo-attach-event\x3d"onChange:_rdoCustomSymChanged" title\x3d"${nls.rdoCustom}" /\x3e\r\n            \x3cspan class\x3d"label"\x3e${nls.rdoCustom}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"jimu-r-row padTop10"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"uploadCustomSymbol" class\x3d"uploadCustom"\x3e\x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"customSymbolPlaceholder" class\x3d"customPlaceholder"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3c!--Clustering Options--\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"parent_div_clusterOptions" class\x3d"clusterOptions"\x3e\r\n        \x3chr /\x3e\r\n        \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpClusterOptions"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"div_chkCluster"\x3e\r\n            \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"chkClusterSym" title\x3d"${nls.chkCluster}" data-dojo-attach-event\x3d"onChange:_chkClusterChanged" /\x3e\r\n            \x3cspan class\x3d"label"\x3e${nls.chkCluster}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"jimu-r-row grpClusterOptions" data-dojo-attach-point\x3d"grpClusterOptions"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"div_clusterOptions" class\x3d"height30"\x3e\r\n            \x3cinput name\x3d"bb" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"rdoCustomCluster" data-dojo-attach-event\x3d"onChange:_rdoCustomClusterChanged" title\x3d"${nls.defineClusterSymbol}" /\x3e\r\n            \x3cspan class\x3d"label"\x3e${nls.defineClusterSymbol}\x3c/span\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"clusterPicker" data-dojo-type\x3d"jimu/dijit/SymbolPicker" class\x3d"symPickers"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"jimu-r-row grpClusterOptions" data-dojo-attach-point\x3d"grpThemeClusterOptions"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"div_themeClusterOptions" class\x3d"height30"\x3e\r\n            \x3cinput name\x3d"bb" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"rdoThemeCluster" data-dojo-attach-event\x3d"onChange:_rdoThemeClusterChanged" title\x3d"${nls.defineThemeClusterSymbol}" /\x3e\r\n            \x3cspan class\x3d"label"\x3e${nls.defineThemeClusterSymbol}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"label iconOptionsText"\x3e\r\n      ${nls.iconOptionsText}\r\n    \x3c/div\x3e\r\n    \x3chr /\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"div_iconOptions" class\x3d"iconOptions"\x3e\r\n      \x3c!--Main Panel and cluster center Icon Options--\x3e\r\n      \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpIconOptions"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"div_rdoLayerIcon" class\x3d"height30"\x3e\r\n          \x3cinput name\x3d"b" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"rdoLayerIcon" data-dojo-attach-event\x3d"onChange:_rdoLayerIconChanged" title\x3d"${nls.rdoLayerIcon}" /\x3e\r\n          \x3cspan class\x3d"label"\x3e${nls.rdoLayerIcon}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpCustomIconOptions"\x3e\r\n        \x3cdiv class\x3d"rdoCustomSym" data-dojo-attach-point\x3d"div_rdoCustomIcon"\x3e\r\n          \x3cinput name\x3d"b" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"rdoCustomIcon" data-dojo-attach-event\x3d"onChange:_rdoCustomIconChanged" title\x3d"${nls.rdoCustomIcon}" /\x3e\r\n          \x3cspan class\x3d"label"\x3e${nls.rdoCustomIcon}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-r-row padTop10"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"uploadCustomIcon" class\x3d"uploadCustom"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"customIconPlaceholder" class\x3d"customPlaceholder"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!--Footer--\x3e\r\n    \x3cdiv class\x3d"footer padTop20"\x3e\r\n      \x3cdiv class\x3d"jimu-btn ok" data-dojo-attach-point\x3d"btnOk"\x3e${nls.popupOk}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-btn cancel" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.popupCancel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cinput type\x3d"file"\r\n           accept\x3d"image/png, image/jpeg, image/bmp, image/gif"\r\n           data-dojo-attach-point\x3d"fileInput"\r\n           class\x3d"fileInput"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/InfoSummary/setting/Setting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"jimu-r-row"\x3e\r\n    \x3cdiv class\x3d"btn-add-section enable" data-dojo-attach-point\x3d"btnAddLayer"\x3e\r\n      \x3cspan class\x3d"btn-add-icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"btn-add-label"\x3e${nls.addLayer}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"layerTable" /\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"label optionsText"\x3e\r\n    ${nls.optionsText}\r\n  \x3c/div\x3e\r\n  \x3chr /\x3e\r\n  \x3cdiv class\x3d"padTop20"\x3e\r\n    \x3cinput data-dojo-attach-point\x3d"panelIconOptions" data-dojo-type\x3d"dijit/form/CheckBox" /\x3e\r\n    \x3cspan class\x3d"label"\x3e ${nls.panelIconOption}\x3c/span\x3e\r\n  \x3c/div\x3e\r\n    \x3cdiv class\x3d"padTop30"\x3e\r\n      \x3cdiv class\x3d"mainPanelPreviewContainer mainPanelPreviewContainerOff" data-dojo-attach-point\x3d"mainPanelPreviewContainer"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"mainPanelPreviewButton" class\x3d"mainPanelPreviewButton"\x3e\r\n          \x3cdiv data-dojo-attach-event\x3d"onclick:uploadImage" class\x3d"jimu-btn"\x3e\r\n            ${nls.uploadImage}\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"mainPanelPreview" class\x3d"bg rounded mainPanelPreview"\x3e\r\n          \x3cdiv id\x3d"panelMain" class\x3d"panelContent bg"\x3e\r\n            \x3cdiv class\x3d"page"\x3e\r\n              \x3cdiv class\x3d"pageContent rounded"\x3e\r\n                \x3cdiv class\x3d"pageHeader roundedTop"\x3e\r\n                  \x3cdiv class\x3d"pageCounter"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"panelMainIcon" \x3e\x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n         \r\n        \x3cdiv class\x3d"mainPanelTextContainer"\x3e\r\n          \x3cdiv class\x3d"instruction2"\x3e\r\n            \x3cspan\x3e${nls.mainPanelText}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cinput type\x3d"text" name\x3d"mainPanelText"\r\n                 placeholder\x3d"${nls.mainPanelTextPlaceholder}"\r\n                 data-dojo-type\x3d"dijit/form/TextBox"\r\n                 data-dojo-props\x3d"trim:true"\r\n                 data-dojo-attach-point\x3d"mainPanelText"\r\n                 class\x3d"mainPanelText"\x3e\r\n        \x3c/div\x3e\r\n\r\n      \x3c/div\x3e\r\n\r\n      \x3cinput type\x3d"file"\r\n             accept\x3d"image/png, image/jpeg, image/bmp, image/gif"\r\n             data-dojo-attach-point\x3d"fileInput"\r\n             class\x3d"fileInput"\x3e\r\n\r\n      \x3cdiv class\x3d"refreshOptions refreshOff" data-dojo-attach-point\x3d"refreshOptions"\x3e\r\n        \x3cdiv class\x3d"refreshIntervalTitle" title\x3d"${nls.refreshIntervalTitle}"\x3e\r\n          \x3cspan style\x3d"padding-right: 20px;"\x3e${nls.refreshIntervalInstruction}\x3c/span\x3e\r\n          \x3cinput type\x3d"text" name\x3d"refreshInterval"\r\n                 placeholder\x3d"${nls.refreshInterval}"\r\n                 data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n                 data-dojo-props\x3d"regExp:\'[\\\\d]+\', _hasBeenBlurred:true, trim:true"\r\n                 data-dojo-attach-point\x3d"refreshInterval"\r\n                 data-dojo-attach-event\x3d"onChange:_updateOK"\r\n                 class\x3d"refreshInterval" required\x3d"true"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n',
"url:widgets/InfoSummary/setting/css/style.css":".jimu-widget-InfoSummary-setting {width:100%; height:100%;}.jimu-widget-InfoSummary-setting .btn-add-section {display: inline-block; overflow: hidden; height: 24px; margin-left: 1px; margin-bottom: 3px; cursor: pointer; font-size: 13px; color: #538ec8; margin-top: 8px;}.jimu-widget-InfoSummary-setting .btn-add-section .btn-add-icon {height: 100%; width: 14px; background-repeat: no-repeat; background-position: center center; background-image: url(images/add.png); display: inline-block; vertical-align: top;}.jimu-widget-InfoSummary-setting .btn-add-section .btn-add-icon:hover {background-image: url(images/add_hover.png);}.jimu-widget-InfoSummary-setting .btn-add-section .btn-add-label {height: 100%; line-height: 24px; margin-left: 7px; text-decoration: underline; display: inline-block; vertical-align: top;}.jimu-widget-InfoSummary-setting .instruction2{float: left; padding-top: 3px;}.jimu-widget-InfoSummary-setting .instruction2 span{color: #596679;}.jimu-widget-InfoSummary-setting .panelContent {position: relative; width: 360px; height: 240px;}.jimu-widget-InfoSummary-setting .page {position: relative; width: 360px; height: 240px; display: block; background-color: rgba(0,0,0,0.15);}.jimu-widget-InfoSummary-setting .pageHeader {position: relative; text-align: center; display: block;}.jimu-widget-InfoSummary-setting .pageCounter {position: absolute; top: 20px; width: auto; height: auto; bottom: 20px; left: 20px; right: 20px;}.jimu-widget-InfoSummary-setting .bg {display: block; background-color: rgb(255,255,255); -moz-opacity: 0.9; -khtml-opacity: 0.9; opacity: 0.9; filter: alpha(opacity\x3d90);}.jimu-widget-InfoSummary-setting .rounded {-moz-border-radius: 5px 5px 5px 5px; -webkit-border-radius: 5px 5px 5px 5px; border-radius: 5px 5px 5px 5px;}.jimu-widget-InfoSummary-setting .roundedTop {-moz-border-radius: 5px 5px 0 0; -webkit-border-radius: 5px 5px 0 0; border-radius: 5px 5px 0 0;}.jimu-widget-InfoSummary-setting .pageContent {position:relative; top:0px;}.jimu-widget-InfoSummary-setting .panelMain {display: block;}.jimu-widget-InfoSummary-setting .footer {text-align: right; width: 100%;}.jimu-widget-InfoSummary-setting .mainPanelPreview {float:left;}.jimu-widget-InfoSummary-setting .mainPanelPreviewButton {float:left; padding-right: 20px;}.jimu-widget-InfoSummary-setting .mainPanelPreviewContainer {width: 540px; float:left;}.jimu-widget-InfoSummary-setting .mainPanelPreviewContainerOn {display:block;}.jimu-widget-InfoSummary-setting .mainPanelPreviewContainerOff {display:none;}.jimu-widget-InfoSummary-setting .refreshOff {display:none;}.jimu-widget-InfoSummary-setting .refreshOn {display:block;}.jimu-widget-InfoSummary-setting .uploadCustom {display: block; width: 25px; height: 25px; float: left; cursor: pointer; background-image: url(../css/images/edit_default.png); background-repeat: no-repeat; padding-bottom:10px; margin-left: 10px;}.jimu-widget-InfoSummary-setting .uploadCustom:hover {display: block; width: 25px; height: 25px; float: left; cursor: pointer; background-image: url(../css/images/edit_hover.png); background-repeat: no-repeat; padding-bottom:10px; margin-left: 10px;}.jimu-widget-InfoSummary-setting .customPlaceholder {display: block; width: 25px; height: 25px; float: left; cursor: pointer;}.jimu-widget-InfoSummary-setting .imageDataGFX {width:30px; height:30px;}.jimu-widget-InfoSummary-setting .imageDataGFX2 {display: block; float:left;}.jimu-widget-InfoSummary-setting .imageDataGFXMulti {width:100%;}.jimu-widget-InfoSummary-setting .symPickers{float:right; overflow:visible;}.jimu-widget-InfoSummary-setting .symPick {padding-left: 10px;}.jimu-widget-InfoSummary-setting .symbolPreview {float: left; width: 280px; height: 340px; margin-left: 20px; margin-top:10px; border: 5px dashed gray;}.jimu-widget-InfoSummary-setting .iconPreview {float: left; width: 280px; height: 90px; margin-left: 20px; margin-top: 10px; margin-bottom: 10px; border: 5px dashed gray;}.jimu-widget-InfoSummary-setting .symbolOptionsContainer {overflow: hidden;}.jimu-widget-InfoSummary-setting .symbolPickerContainer {height: 100%; width: 100%; overflow: auto; padding-bottom: 8px;}.jimu-widget-InfoSummary-setting .symbolOptionText {font-weight: bold;}.jimu-widget-InfoSummary-setting .symbolOptions{float: left; width: 240px;}.jimu-widget-InfoSummary-setting .rdoCustomSym{vertical-align: middle;}.jimu-widget-InfoSummary-setting .clusterOptions{min-width: 250px;}.jimu-widget-InfoSummary-setting .grpClusterOptions{padding-top: 16px;}.jimu-widget-InfoSummary-setting .iconOptionsText{padding-top: 25px; font-weight: bold; width: 200px; display: -webkit-inline-box;}.jimu-widget-InfoSummary-setting .iconOptions{float: left; min-width: 250px;}.jimu-widget-InfoSummary-setting .fileInput{opacity: 0; width: 0px; height: 0px;}.jimu-widget-InfoSummary-setting .height30{height: 30px;}.jimu-widget-InfoSummary-setting .padTop10{padding-top: 10px;}.jimu-widget-InfoSummary-setting .padTop20{padding-top: 20px;}.jimu-widget-InfoSummary-setting .padTop30{padding-top: 30px;}.jimu-widget-InfoSummary-setting .optionsText{padding-top: 25px; font-weight: bold;}.jimu-widget-InfoSummary-setting .mainPanelText{width: 360px; float: right;}.jimu-widget-InfoSummary-setting .refreshOptions{float:right;}.jimu-widget-InfoSummary-setting .refreshIntervalTitle{float:left; padding-left:5px; padding-top: 5px; padding-bottom: 13px;}.jimu-widget-InfoSummary-setting .refreshInterval{width:240px; padding-left: 10px;}.jimu-widget-InfoSummary-setting .dijitSelectLabel {text-align:left; text-overflow: ellipsis; overflow: hidden; max-width:260px; width:260px;}.jimu-widget-InfoSummary-setting .innerMainPanelIcon {max-width: 320px; max-height: 200px; vertical-align: middle;}.jimu-widget-InfoSummary-setting .mainPanelTextContainer {margin-top: 10px; float: left; min-width: 500px; max-width: 540px;}.jimu-widget-InfoSummary-setting .claro .dijitTextBox .dijitInputInner{font-size: 4px;}",
"*now":function(m){m(['dojo/i18n!*preload*widgets/InfoSummary/setting/nls/Setting*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/query dojo/dom-construct dojo/_base/declare dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/LayerInfos/LayerInfos dijit/form/Select dijit/form/ValidationTextBox dijit/form/CheckBox jimu/dijit/Popup jimu/dijit/SimpleTable jimu/utils esri/request esri/symbols/jsonUtils dijit/popup dojo/_base/lang dojo/DeferredList dojo/on dojox/gfx dojo/dom-style dojo/_base/html dojo/_base/array ./MySymbolPicker jimu/dijit/Message".split(" "),function(m,t,u,p,q,r,v,w,s,B,z,x,A,y,b,e,a,f,E,l,h,
C,D,F){return u([q,p],{baseClass:"jimu-widget-InfoSummary-setting",_layerInfos:null,mpi:null,layer_options:[],refreshLayers:[],displayPanelIcon:!1,postCreate:function(){this.inherited(arguments);this.setupLayerTable();this.setupRefreshInterval();this._getAllLayers();this.own(f(this.btnAddLayer,"click",e.hitch(this,this._addLayerRow)));this.own(f(this.panelIconOptions,"change",e.hitch(this,function(){var g;this.panelIconOptions.checked?(this.displayPanelIcon=!0,g=m(".mainPanelPreviewContainerOff",
this.mainPanelPreviewContainer.domNode)[0],h.removeClass(g,"mainPanelPreviewContainerOff"),h.addClass(g,"mainPanelPreviewContainerOn")):(this.displayPanelIcon=!1,g=m(".mainPanelPreviewContainerOn",this.mainPanelPreviewContainer.domNode)[0],h.removeClass(g,"mainPanelPreviewContainerOn"),h.addClass(g,"mainPanelPreviewContainerOff"))})))},startup:function(){this.inherited(arguments);this.refreshLayers=[]},setupRefreshInterval:function(){this.refreshInterval.invalidMessage=this.nls.invalidInterval;this.refreshInterval.missingMessage=
this.nls.missingRefreshValue},setupLayerTable:function(){this.displayLayerTable=new z({fields:[{name:"layer",title:this.nls.layerName,"class":"label",type:"empty",width:"100px"},{name:"label",title:this.nls.layerLabel,"class":"label",type:"empty",width:"80px"},{name:"upload",title:this.nls.iconColumnText,"class":"actions",type:"actions",actions:["edit"],width:"20px"},{name:"image",title:"",width:"20px",type:"empty",hidden:!1,"class":"imageTest"},{name:"refresh",title:this.nls.layerRefresh,type:"empty",
width:"40px"},{name:"actions",title:this.nls.actions,"class":"actions actions2",type:"actions",actions:["up","down","delete"],width:"45px"}],selectable:!1,autoHeight:!0});this.displayLayerTable.placeAt(this.layerTable);this.displayLayerTable.startup();this.own(f(this.displayLayerTable,"actions-edit",e.hitch(this,this._pickSymbol)))},_getAllLayers:function(){this.map.itemId&&r.getInstance(this.map,this.map.itemInfo).then(e.hitch(this,function(g){this.opLayers=g;this._setLayers();this.setConfig(this.config)}))},
_getInfoTemplate:function(g){var a;if(g&&g.parentLayerInfo&&g.parentLayerInfo.controlPopupInfo){var k=g.parentLayerInfo.controlPopupInfo.infoTemplates;if(k){var c=g.url;!c&&g.layerObject&&(c=g.layerObject.url);if(c&&(g=c.split("/").pop()))k.indexOf?-1<k.indexOf(g)&&(a=k[g].infoTemplate):k.hasOwnProperty(g)&&(a=k[g].infoTemplate)}}return a},_setLayers:function(){for(var g=[],a=0;a<this.opLayers._layerInfos.length;a++){var k=!0,c=this.opLayers._layerInfos[a],n;c.originOperLayer&&(n=c.originOperLayer);
0<c.newSubLayers.length?this.checkNestedGroups(c.newSubLayers)?new F({message:this.nls.layer_type_not_supported+c.title}):this._recurseOpLayers(c.newSubLayers,g):c.featureCollection?1<c.layers.length&&this._recurseOpLayers(c.layers,g):n?n.featureCollection?1<n.featureCollection.layers.length?this._recurseOpLayers(n.featureCollection.layers,g):g.unshift({label:c.title,value:c.title,url:void 0,imageData:c.imageData,id:c.id,geometryType:n.featureCollection.layers[0].layerObject.geometryType,type:c.type,
renderer:n.featureCollection.layers[0].layerObject.renderer,itemId:n.itemId,infoTemplate:n?this._getInfoTemplate(n):void 0,lyrType:"Feature Collection",panelImageData:c.panelImageData}):("undefined"===typeof c.layerObject.geometryType&&this.setGeometryType(c.layerObject),c&&c.resourceInfo&&(k=c.resourceInfo.supportsDynamicLayers),g.unshift({label:c.title,value:c.title,url:c.layerObject.url,imageData:c.imageData,id:c.id,type:c.type,renderer:c.layerObject.renderer,geometryType:c.layerObject.geometryType,
infoTemplate:n?this._getInfoTemplate(n):void 0,lyrType:"Map Service Layer",panelImageData:c.panelImageData,supportsDynamic:k})):("undefined"===typeof c.layerObject.geometryType&&this.setGeometryType(c.layerObject),c&&c.resourceInfo&&(k=c.resourceInfo.supportsDynamicLayers),g.unshift({label:c.title,value:c.title,url:c.layerObject.url,imageData:c.imageData,id:c.id,type:c.type,renderer:c.layerObject.renderer,geometryType:c.layerObject.geometryType,lyrType:"",infoTemplate:n?this._getInfoTemplate(n):void 0,
panelImageData:c.panelImageData,supportsDynamic:k}))}this.layer_options=e.clone(g)},checkNestedGroups:function(g){for(var a=0;a<g.length;a++)if(g[a].newSubLayers&&0<g[a].newSubLayers.length)return!0;return!1},setConfig:function(a){this.config=a;this.config.mainPanelText&&this.mainPanelText.set("value",this.config.mainPanelText);this.config.mainPanelIcon&&(this.panelMainIcon.innerHTML=this.config.mainPanelIcon);this.config.refreshInterval&&this.refreshInterval.set("value",this.config.refreshInterval);
this.config.loadStaticData&&this.chkStatic.set("value",this.config.loadStaticData);this.config.displayPanelIcon&&this.panelIconOptions.set("checked",this.config.displayPanelIcon);this.displayLayerTable.clear();this.isInitalLoad=!0;for(a=this.layerLoadCount=0;a<this.config.layerInfos.length;a++)this._populateLayerRow(this.config.layerInfos[a]),this.layerLoadCount+=1},_addLayerRow:function(){this.isInitalLoad=!1;var a=this.displayLayerTable.addRow({});a.success&&a.tr&&(a=a.tr,this._addLayersOption(a),
this._addLabelOption(a),this._addRefreshOption(a),this._addDefaultSymbol(a))},_populateLayerRow:function(a){var d=this.displayLayerTable.addRow({});d.success&&d.tr&&(d=d.tr,this._addLayersOption(d),this._addLabelOption(d),this._addRefreshOption(d),d.selectLayers.set("value",a.layer),d.labelText.set("value",a.label),d.refreshBox.set("checked",a.refresh),d.imageData=a.panelImageData,t.create("div",{"class":"imageDataGFX",innerHTML:[a.imageData],title:this.nls.iconColumnText},d.cells[3]),d=this._getLayerOptionByValue(a.layer),
d.filter=a.filter,d.imageData=a.imageData,d.symbolData=a.symbolData)},_addLayersOption:function(a){var d=e.clone(this.layer_options),k=m(".simple-table-cell",a)[0];k&&(h.setStyle(k,"verticalAlign","middle"),d=new v({style:{width:"100%",height:"28px"},options:d}),d.placeAt(k),d.startup(),a.selectLayers=d,this.own(f(d,"change",e.hitch(this,function(){this._updateRefresh(a);this.isInitalLoad||this._addDefaultSymbol(a);this.layerLoadCount-=1;1===this.layerLoadCount&&(this.isInitalLoad=!1)}))))},_addLabelOption:function(a){var d=
m(".simple-table-cell",a)[1];h.setStyle(d,"verticalAlign","middle");var k=new w({style:{width:"100%",height:"28px"}});k.placeAt(d);k.startup();a.labelText=k},_addRefreshOption:function(a){var d=m(".simple-table-cell",a)[4];h.setStyle(d,"verticalAlign","middle");this.currentTR=a;var k=new s({onChange:e.hitch(this,function(a){var g=this.currentTR.selectLayers.value;if(a){this.refreshLayers.push(g);if(a=m(".refreshOff",this.refreshOptions.domNode)[0])h.removeClass(a,"refreshOff"),h.addClass(a,"refreshOn");
this.refreshInterval.isValid()||this._disableOk()}else if(a=this.refreshLayers.indexOf(g),-1<a&&(this.refreshLayers.splice(a,1),0===this.refreshLayers.length)){if(a=m(".refreshOn",this.refreshOptions.domNode)[0])h.removeClass(a,"refreshOn"),h.addClass(a,"refreshOff");this._enableOk()}})});this._updateRefresh(a,k);k.placeAt(d);k.startup();a.refreshBox=k},_updateRefresh:function(a,d){var k=this._getLayerOptionByValue(a.selectLayers.value);d||(d=a.refreshBox);"Feature Collection"===k.lyrType?(d.set("disabled",
!1),d.set("title",this.nls.enableRefresh)):(d.set("disabled",!0),d.set("title",this.nls.disableRefresh))},_updateOK:function(){this.refreshInterval.isValid()?this._enableOk():this._disableOk()},_disableOk:function(){var a=m(".button-container")[0],d=a.children[3];l.set(a.children[2],"display","none");l.set(d,"display","inline-block")},_enableOk:function(){var a=m(".button-container")[0],d=a.children[3];l.set(a.children[2],"display","inline-block");l.set(d,"display","none")},_addDefaultSymbol:function(a){var d=
m(".simple-table-cell",a)[0];this.curRow=a;if(d){var d=this._getLayerOptionByValue(d.children[0].textContent),k=a.selectLayers.value,c=!1;"undefined"!==typeof this.curRow.symbolData&&(c=this.curRow.symbolData,c=c.userDefinedSymbol&&c.layerId===k);!c||"undefined"===typeof d.symbolData?(a=new D({nls:this.nls,callerRow:a,layerInfo:d,value:k,symbolInfo:c?this.curRow.symbolData:d.symbolData,map:this.map,ac:this.appConfig}),a._setSymbol(),this.curRow.cells[3].innerHTML="\x3cdiv\x3e\x3c/div\x3e",this.curRow.symbolData=
a.symbolInfo,this._createImageDataDiv(this.curRow.symbolData.icon,28,28,!0),this.curRow.imageData=this._createImageDataDiv(this.curRow.symbolData.icon,45,45,!1).innerHTML,this.curRow=null,a.destroy()):(this.curRow.cells[3].innerHTML="\x3cdiv\x3e\x3c/div\x3e",this.curRow.symbolData=d.symbolData,this._createImageDataDiv(this.curRow.symbolData.icon,28,28,!0),this.curRow.imageData=this._createImageDataDiv(this.curRow.symbolData.icon,45,45,!1).innerHTML)}},_getLayerOptionByValue:function(a){for(var d=
0;d<this.layer_options.length;d++){var k=this.layer_options[d];if(k.value===a)return k}},_recurseOpLayers:function(a,d){C.forEach(a,e.hitch(this,function(a){var c;if(0<a.newSubLayers.length)this._recurseOpLayers(a.newSubLayers,d);else if(a.featureCollection)1<a.layers.length&&this._recurseOpLayers(a.layers,d);else{"undefined"!==typeof a.layerObject&&"undefined"===typeof a.layerObject.geometryType&&this.setGeometryType(a.layerObject);var g;a.hasOwnProperty("parentLayerInfo")&&a.parentLayerInfo.hasOwnProperty("originOperLayer")&&
(g=a.parentLayerInfo.originOperLayer,c=this._getInfoTemplate(g));a.originOperLayer&&(c=this._getInfoTemplate(a.originOperLayer));var e,f;a.layerObject&&a.layerObject.url&&(e=a.layerObject.url,f=parseInt(e.substr(e.lastIndexOf("/")+1),10));var b=!0;g&&g.resourceInfo&&(b=g.resourceInfo.supportsDynamicLayers);d.push({label:a.title,value:a.title,url:e,imageData:a.imageData,id:a.id,parentLayerID:g?g.id:void 0,type:a.type,itemId:g?g.itemId:void 0,renderer:a.layerObject.renderer,geometryType:a.layerObject.geometryType,
subLayerId:f,infoTemplate:c,lyrType:g?g.type:void 0,supportsDynamic:b})}}))},_pickSymbol:function(a){var d=a.selectLayers.value,k=this._getLayerOptionByValue(d);this.curRow=a;var c=new D({nls:this.nls,callerRow:a,layerInfo:k,value:d,symbolInfo:"undefined"!==typeof this.curRow.symbolData?this.curRow.symbolData:k.symbolData,map:this.map,ac:this.appConfig}),n=new B({width:330,autoHeight:!0,content:c,titleLabel:this.nls.sympolPopupTitle});this.own(f(c,"ok",e.hitch(this,function(a){this.curRow.cells[3].innerHTML=
"\x3cdiv\x3e\x3c/div\x3e";this.curRow.symbolData=a;this._createImageDataDiv(a.icon,28,28,!0);this.curRow.imageData=this._createImageDataDiv(a.icon,45,45,!1).innerHTML;this.curRow=null;c.destroy();c=null;n.close()})));this.own(f(c,"cancel",e.hitch(this,function(){this.curRow=null;c.destroy();c=null;n.close()})))},_createImageDataDiv:function(a,d,e,c){var f;if("string"===typeof a)f=c?t.create("div",{"class":"imageDataGFX",innerHTML:a},this.curRow.cells[3]):t.create("div",{"class":"imageDataGFX",innerHTML:a});
else{var b=y.fromJson(a);b||(b=a);if(b){a=d;var h=e;if(b.height&&b.width)if(b.height>b.width)f=b.width/b.height,h=d*f;else if(b.width===b.height||b.width>b.height)h=d-10,f=b.width/b.height,a=0<f?e-10*f:e-10;"undefined"!==typeof b.setWidth?"undefined"!==typeof b.setHeight?(b.setWidth(h),b.setHeight(a)):b.setWidth(2):"undefined"!==typeof b.size&&20<b.size&&b.setSize(20);f=c?t.create("div",{"class":"imageDataGFX"},this.curRow.cells[3]):t.create("div",{"class":"imageDataGFX"});d=E.createSurface(f,h,a);
b=y.getShapeDescriptors(b);d.createShape(b.defaultShape).setFill(b.fill).setStroke(b.stroke).applyTransform({dx:h/2,dy:a/2})}else"undefined"!==typeof a.url&&(f=t.create("div",{"class":"imageDataGFX"},this.curRow.cells[3]),l.set(f,"background-image","url("+a.url+")"),l.set(f,"background-repeat","no-repeat"))}return f},setGeometryType:function(b){var d=[];"undefined"!==typeof b.url&&b.url.indexOf("MapServer")&&d.push(A({url:b.url+"?f\x3djson"}));0<d.length&&(new a(d)).then(e.hitch(this,function(a){if(a&&
0<a.length){a=a[0][1];for(var c,b=0;b<this.layer_options.length;b++)if(this.layer_options[b].value===a.name){c=b;break}this.layer_options[c].geometryType=a.geometryType;if("undefined"!==typeof a.drawingInfo){this.layer_options[c].renderer=a.drawingInfo.renderer;this.layer_options[c].drawingInfo=a.drawingInfo;this.layer_options[c].fields=a.fields;for(var d,b=0;b<a.fields.length&&!(d=a.fields[b],"esriFieldTypeOID"===d.type);b++);this.layer_options[c].oidFieldName=d}}}))},uploadImage:function(){var a=
new FileReader;a.onload=e.hitch(this,function(){this.panelMainIcon.innerHTML="\x3cdiv\x3e\x3c/div\x3e";this.mpi=a.result;t.create("div",{innerHTML:['\x3cimg class\x3d"innerMainPanelIcon" src\x3d"',a.result,'" title\x3d"',this.nls.mainPanelIcon,'"/\x3e'].join("")},this.panelMainIcon)});this.fileInput.onchange=e.hitch(this,function(){a.readAsDataURL(this.fileInput.files[0])});this.fileInput.click()},getConfig:function(){b.close();var a=this.displayLayerTable.getRows(),d=[],f;C.forEach(a,e.hitch(this,
function(a){var b=a.selectLayers.value,e=x.sanitizeHTML(a.labelText.value),g=a.refreshBox,h=this._getLayerOptionByValue(b);f={layer:b,label:""!==e?e:b,refresh:g.checked,url:h.url,type:h.type,id:h.id,symbolData:a.symbolData?a.symbolData:h.symbolData,geometryType:h.geometryType,itemId:h.itemId,parentLayerID:h.parentLayerID,renderer:h.renderer,drawingInfo:h.drawingInfo,fields:h.fields,oidFieldName:h.oidFieldName,subLayerId:h.subLayerId,infoTemplate:h.infoTemplate};a.imageData&&(f.panelImageData=a.imageData);
a=m(".imageDataGFX",a)[0];f.imageData="undefined"!==typeof a?a.innerHTML:"\x3cdiv\x3e\x3c/div\x3e";d.push(f)}));this.config.layerInfos=d;this.config.mainPanelText=x.sanitizeHTML(this.mainPanelText.value);this.config.mainPanelIcon=this.panelMainIcon.innerHTML;this.config.refreshInterval=x.sanitizeHTML(this.refreshInterval.value);this.config.refreshEnabled=0<this.refreshLayers.length?!0:!1;this.config.displayPanelIcon=this.displayPanelIcon;return this.config},destroy:function(){b.close();this.inherited(arguments)}})});